{"version":3,"sources":["webpack:///./src/js/prototypes/Canvas.js","webpack:///./src/js/prototypes/items/Rectangle.js","webpack:///./src/js/prototypes/ModeStore.js","webpack:///./src/js/prototypes/ToolsStore.js","webpack:///./src/js/util/observeAnimatableTree.js","webpack:///./src/js/prototypes/GalleryStore.js","webpack:///./src/js/store.js","webpack:///./src/js/util/storage.js","webpack:///./src/js/index.jsx","webpack:///./src/js/containers/App.jsx","webpack:///./src/js/components/Playbar.jsx","webpack:///./src/js/containers/Viewer.jsx","webpack:///./src/js/util/download.js","webpack:///./src/js/prototypes/Project.js","webpack:///./src/js/prototypes/items/Circle.js","webpack:///./src/js/containers/Gallery.jsx","webpack:///./src/js/components/GridItem.jsx","webpack:///./src/js/prototypes/Handle.js","webpack:///./src/js/util/string.js","webpack:///./src/js/prototypes/items/index.js","webpack:///./src/js/prototypes/Animation.js","webpack:///./src/js/components/Grid.jsx","webpack:///./src/css/index.js","webpack:///./src/js/containers/ToolController.jsx","webpack:///./src/js/components/IntegerInput.jsx","webpack:///./src/js/components/Modal.jsx","webpack:///./src/js/containers/PropertyEditor.jsx","webpack:///./src/js/containers/ProjectSettings.jsx","webpack:///./src/js/containers/ClearProject.jsx","webpack:///./src/js/containers/BuildMode.jsx","webpack:///./src/js/util/bezierCurve.js","webpack:///./src/js/prototypes/Keyframe.js","webpack:///./src/js/components/Canvas.jsx","webpack:///./src/js/containers/ExportMode.jsx","webpack:///./src/css/bare.min.css","webpack:///./src/js/prototypes/AnimatableItem.js","webpack:///./src/js/containers/ModeController.jsx","webpack:///./src/js/prototypes/HandleEditor.js","webpack:///./src/js/containers/HandleEditor.jsx","webpack:///./src/js/containers/KeyframeEditor.jsx","webpack:///./src/js/containers/AnimateMode.jsx","webpack:///./src/js/containers/PlayController.jsx","webpack:///./src/js/components/withWindowSize.jsx","webpack:///./src/js/containers/ViewMode.jsx","webpack:///./node_modules/file-loader/dist/cjs.js"],"names":["Canvas","rootStore","attatchAndSetup","id","element","document","getElementById","paper","setup","view","autoUpdate","background","Path","Rectangle","topLeft","bottomRight","width","height","fillColor","color","draw","animation","firstFrame","addListenersAndSelect","animatable","item","on","handleItemMouseDown","select","event","stopPropagation","currentTarget","handleViewMouseDown","deselect","forEachAnimatable","callback","Object","values","animatables","forEach","build","create","frame","frameToDraw","now","update","selectOn","selectOff","off","this","initialize","prevWidth","prevHeight","undefined","_color","tool","selected","setSize","entries","reduce","output","key","toJSON","setSizeAction","action","setTimeout","value","observable","remove","clone","nextTool","entering","toolId","prevTool","exiting","mode","settings","clear","name","AnimatableItem","radius","itemProps","position","x","y","absX","absolute","absY","absWidth","absHeight","point","size","Math","max","_width","recreate","_height","_radius","WIDTH","HEIGHT","RADIUS","Mode","current","m","Tools","selectedKeyframe","keyframe","observeAnimatableTree","observableObj","constructor","OBSERVABLES","map","keys","keyframes","keyFrType","Gallery","firebase","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","clipsRef","ref","RootStore","reset","project","canvas","tools","PaperScope","Project","Animation","ModeStore","ToolsStore","gallery","GalleryStore","pathArray","window","location","pathname","split","storageEnabled","localStorage","setItem","e","length","projectObj","getItem","load","autorun","projectAsJSON","save","delay","reaction","store","appNode","ReactDOM","render","App","observer","Component","props","minHeight","gridTemplateRows","hot","module","Playbar","fullWidth","totalFrames","inPoint","outPoint","ABSOLUTE_FIRST","playbarWidth","per","marker","head","parseInt","tail","activeHead","activeTail","style","display","playbarStyle","backgroundColor","marginTop","margin","Viewer","canvasHasSize","onSetup","Fragment","hasSize","frames","lastFrame","FIRST","downloadJSON","data","basename","download","filename","type","file","Blob","navigator","msSaveOrOpenBlob","elm","createElement","url","URL","createObjectURL","href","body","appendChild","click","removeChild","revokeObjectURL","setIn","setOut","inputJSON","fileName","input","JSON","parse","setName","replace","inputItems","loadFromFile","targetFile","target","files","reader","FileReader","onload","result","readAsText","stringify","object","publish","push","set","inputBuilt","Circle","center","state","clips","clip","json","buildAnimatables","play","itemKey","itemObj","itemClass","properties","items","add","inputKeyframes","accum","keyframeProp","keyframeList","Keyframe","fromJSON","container","round","clientWidth","setState","newClip","simpleHash","val","playable","obj","prevState","firstClip","slice","prevProps","prevClipsLen","targetIndex","padding","zIndex","marginBottom","paddingTop","GridItem","children","Handle","influence","distance","_influence","_distance","MAX","newX","newY","titleCase","str","splitStr","toLowerCase","i","charAt","toUpperCase","substring","join","hash","charCodeAt","nextFrame","later","prevFrame","earlier","fps","playing","sync","requestId","f","goToFrame","animateAtRate","pause","cancelAnimationFrame","func","interval","then","Date","loop","requestAnimationFrame","delta","Grid","cssContext","require","ToolController","choose","preventDefault","setTool","addCircle","existing","circle","addRectangle","rect","onClick","primary","transform","IntegerInput","localValue","onChange","onBlur","setValue","possibleInt","Number","isInteger","handleKeyDown","shiftKey","incrementBy","decrementBy","changeBy","operation","amount","next","a","b","marginRight","textAlign","onKeyDown","Modal","open","handleClose","clickawayEl","useRef","onClickaway","contains","content","PropertyEditor","propertySetter","property","existingKeyframe","find","addKey","scale","rotation","classControls","left","top","overflow","border","ProjectSettings","setLength","setColor","closeModal","step","flexDirection","ClearProject","justifyContent","BuildMode","ready","inputItemsExist","autorunDisposer","Boolean","prevInputItemsExist","gridTemplateColumns","gridArea","alignSelf","makeRoot","real","imag","evaluate","A","B","C","D","q0","B1","C2","Q","dQ","getCubicRoots","X","b1","c2","evalInfo","q","dq","t","r","abs","s","sign","sqrt","x0","den","EPSILON","roots","quadInfo","qdrtc","X1","Y1","X2","Y2","Y","concat","bezierCurve","x2","x3","y2","y3","Error","xA","xB","xC","filter","toFixed","is","yA","yB","yC","cubic","c","d","handleIn","handleOut","sort","createCurve","k1","k2","interpolate","curve","timeRatio","valueRatio","testForAvailability","ExportMode","loadThenBuild","saveThenDownload","justifyItems","htmlFor","exports","dimension","fraction","valueForFrame","includes","indexOf","where","before","after","hue","floor","random","saturation","brightness","class","prop","rotate","ignorePairings","valueToKey","k","paired","valueToPair","kP","keyframesPaired","updateKeyframes","keyframesY","setCanvas","sharedProps","onCreate","setUntrackedValues","xKeyframes","yKeyframes","xValue","yValue","activeLayer","_x","_y","_scale","scaleBy","_rotation","rotateBy","_fillColor","SCALE","ROTATION","FILL_COLOR","ModeController","navigate","textContent","borderBottom","alignItems","HandleEditor","trueWidth","keyframeBefore","keyframeAfter","onMove","attatchTo","handleBefore","absoluteHandlePosition","handleAfter","topRight","bottomLeft","spacing","STEP","gridline","SymbolDefinition","Line","from","to","strokeColor","strokeWidth","offset","place","Point","setVisualCurveHandles","stringStyle","handleBeforeString","handleAfterString","handleMovable","Color","handleStationary","onMouseEnter","cursor","onMouseLeave","onMouseDrag","travelled","subtract","xChange","yChange","xSign","ySign","newPosition","lastSegment","onMouseUp","firstSegment","handlePosition","handleEditor","handleEditorHasSize","buildHandleEditorCanvas","HandleEditorInstance","init","React","keyframeKey","destroy","KeyframeEditor","previouslyClickedKeyframe","keyframeEditorHasSize","buildKeyframeEditorCanvas","handleKeyframeClick","onSelect","shadowColor","alpha","handleKeyUp","removeKey","rebuild","timelineMath","verticalSpacing","timelineStart","timelineEnd","timelineStep","placementIndex","playheadLine","buildPlayhead","newKeyframeItems","list","propName","placing","PointText","fontSize","timelineHover","timeline","newKeyframeRect","visible","newKeyframePlus","newKeyframeHoverEffect","newKeyframeHide","newKeyClick","onMouseMove","hitTest","stroke","segments","keyframeIndex","keyframeRect","shadowBlur","bringToFront","addEventListener","removeEventListener","playheadTriangle","RegularPolygon","sides","timelineWidth","AnimateMode","heWidth","keSize","selectedItemKey","changeHandlePosition","handleType","handleSuffix","kItem","kProp","kIndexStr","kIndex","auxilaryHandle","targetHandle","container2","clientHeight","smallestLength","min","container3","selectKeyframe","keyframesOfType","PlayController","goToNext","goToPrev","goToFirst","goToLast","borderTop","gridColumnStart","getWidth","innerWidth","documentElement","ViewMode","webpackContext","req","webpackContextResolve","__webpack_require__","o","code","webpackContextKeys","resolve"],"mappings":"0tEAEMA,G,0CASJ,gBAAYC,GAAW,Y,4GAAA,kXA6CvBC,gBAAkB,SAACC,GACjB,IAAMC,EAAUC,SAASC,eAAeH,GACxC,EAAKI,MAAMC,MAAMJ,GACjB,EAAKG,MAAME,KAAKC,YAAa,EAC7B,EAAKC,WAAa,IAAI,EAAKJ,MAAMK,KAAKC,UAAU,CAC9CC,QAAS,CAAC,EAAG,GACbC,YAAa,CAAC,EAAKR,MAAME,KAAKL,QAAQY,MAAO,EAAKT,MAAME,KAAKL,QAAQa,QACrEC,UAAW,EAAKC,QAElB,EAAKC,KAAK,EAAKnB,UAAUoB,UAAUC,aAtDd,0PAyHvBC,sBAAwB,SAACC,GACvBA,EAAWC,KAAKC,GAAG,YAAa,EAAKC,qBACrC,EAAKC,OAAOJ,EAAWC,OA3HF,KA8HvBE,oBAAsB,SAACE,GACrBA,EAAMC,kBACN,EAAKF,OAAOC,EAAME,gBAhIG,KAmIvBC,oBAAsB,SAACH,GACrBA,EAAMC,kBACN,EAAKG,YArIgB,KAwIvBC,kBAAoB,SAAAC,GAAQ,OAC1BC,OAAOC,OAAO,EAAKC,aAAaC,QAAQJ,IAzInB,KA4IvBK,MAAQ,WACN,EAAKN,kBAAkB,SAACV,GAAiBA,EAAWiB,OAAO,KAC3D,EAAKrB,QA9IgB,KAiJvBA,KAAO,SAACsB,GACN,IAAMC,EAAcD,GAAS,EAAKzC,UAAUoB,UAAUuB,IACtD,EAAKV,kBAAkB,SAACV,GAAiBA,EAAWJ,KAAKuB,KACrD,EAAKpC,MAAME,MAAM,EAAKF,MAAME,KAAKoC,UApJhB,KAuJvBC,SAAW,WACT,EAAKZ,kBAAkB,SAACV,GACtBA,EAAWC,KAAKC,GAAG,YAAa,EAAKC,uBAEvC,EAAKpB,MAAME,KAAKiB,GAAG,YAAa,EAAKM,sBA3JhB,KA8JvBe,UAAY,WACV,EAAKb,kBAAkB,SAACV,GACtBA,EAAWC,KAAKuB,IAAI,YAAa,EAAKrB,uBAExC,EAAKpB,MAAME,KAAKuC,IAAI,YAAa,EAAKhB,qBACtC,EAAKC,YAlKLgB,KAAKhD,UAAYA,EACjBgD,KAAK1C,MAAQN,EAAUM,MACvB0C,KAAKC,a,kKAIL,IAAIC,EACAC,OACeC,IAAfJ,KAAKjC,QACPmC,EAAYF,KAAKjC,MACjBoC,EAAaH,KAAKhC,QAGpBgC,KAAKjC,WAAQqC,EACbJ,KAAKhC,YAASoC,EACdJ,KAAKK,OAAS,UACdL,KAAKX,YAAc,GACnBW,KAAKM,UAAOF,GACZJ,KAAKO,cAAWH,KAEZF,GACFF,KAAKQ,QAAQN,EAAWC,K,sCAK1B,MAAQ,CACNjC,MAAO8B,KAAK9B,MACZmB,YAAaF,OAAOsB,QAAQT,KAAKX,aAAaqB,OAAO,SAACC,EAAD,GAA+B,0BAArBC,EAAqB,KAAhBrC,EAAgB,KAElF,OADAoC,EAAOC,GAAOrC,EAAWsC,SAClBF,GACN,O,sCAIC5C,EAAOC,GAAQ,WAEf8C,EAAgBC,YAAO,WAC3B,EAAK/C,OAASA,EACd,EAAKD,MAAQA,IAEfiD,WAAWF,EAAe,K,gCAed,OAAOd,KAAKK,Q,iBAChBY,GACRjB,KAAKK,OAASY,EACdjB,KAAKtC,WAAWO,UAAYgD,M,8BApE7BC,K,gHACAA,K,gHACAA,K,oHACAA,K,qHACAA,K,8GACAA,K,kHACAA,K,6GAiEAH,K,gGAAa,SAACxC,GACbA,EAAWiB,OAAO,GAClB,EAAKH,YAAL,iBACK,EAAKA,YADV,mBAEGd,EAAWqC,IAAMrC,IAGF,WAAd,EAAK+B,MACP,EAAKhC,sBAAsBC,GAG7B,EAAKJ,W,kDAGN4C,K,gGAAgB,SAACxC,GAChBA,EAAWC,KAAKuB,IAAI,YAAa,EAAKrB,qBACtCH,EAAWC,KAAK2C,SAEhB,IAAMC,EAAQ,cAAH,GAAQ,EAAK/B,oBACjB+B,EAAM7C,EAAWqC,KACxB,EAAKvB,YAAc+B,EACnB,EAAKjD,W,mDAGN4C,K,gGAAiB,SAACM,GAGA,SAAXC,GAAWC,GAAM,OAAKC,IAAaD,GAAUF,IAAaE,EAChD,SAAVE,GAAUF,GAAM,OAAKC,IAAaD,GAAUF,IAAaE,EAH/D,IAAMC,EAAW,EAAKlB,KAKlBgB,GAAS,WAAa,EAAKzB,WAC3B4B,GAAQ,WAAa,EAAK3B,YAE1BwB,GAAS,cAAe,EAAKtE,UAAU0E,KAAKC,UAAW,GACvDF,GAAQ,cAAe,EAAKzE,UAAU0E,KAAKC,UAAW,GAEtDL,GAAS,WAAY,EAAKtE,UAAU0E,KAAKE,OAAQ,GACjDH,GAAQ,WAAY,EAAKzE,UAAU0E,KAAKE,OAAQ,GAGpD,EAAKtB,KAAOe,M,kDAGbN,K,gGAAgB,SAACvC,GAChB,EAAKQ,WACLR,EAAK+B,UAAW,EAChB,EAAKA,SAAW,EAAKlB,YAAYb,EAAKqD,MACtC,EAAKvE,MAAME,KAAKoC,a,oDAGjBmB,K,gGAAkB,WACb,EAAKR,WACP,EAAKA,SAAS/B,KAAK+B,UAAW,EAC9B,EAAKA,cAAWH,GAElB,EAAK9C,MAAME,KAAKoC,a,GAiDL7C,O,0pFC9KTa,G,66BAAkBkE,Q,sJAWpB,6FAEE/D,MAAOiC,KAAKjC,MACZC,OAAQgC,KAAKhC,OACb+D,OAAQ/B,KAAK+B,W,wCA0BRC,GAAW,MACDhC,KAAKiC,SAAdC,EADU,EACVA,EAAGC,EADO,EACPA,EACLC,EAAOpC,KAAKqC,SAASH,GACrBI,EAAOtC,KAAKqC,SAASF,EAAG,UACxBI,EAAWvC,KAAKqC,SAASrC,KAAKjC,OAC9ByE,EAAYxC,KAAKqC,SAASrC,KAAKhC,QAErC,IAAIgC,KAAK1C,MAAMK,KAAKC,UAApB,iBACKoE,EADL,CAEES,MAAO,CAACL,EAAQG,EAAW,EAAID,EAAQE,EAAY,GACnDE,KAAM,CAACH,EAAUC,GACjBT,OAAS/B,KAAK+B,OAAS,KAAQY,KAAKC,IAAIL,EAAUC,GAAa,Q,gCAjCrD,OAAOxC,KAAK6C,Q,iBAIhB5B,GAERjB,KAAK6C,OAAS5B,EACdjB,KAAK8C,a,iCANQ,OAAO9C,KAAK+C,S,iBAShB9B,GAETjB,KAAK+C,QAAU9B,EACfjB,KAAK8C,a,iCAXQ,OAAO9C,KAAKgD,S,iBAchB/B,GAETjB,KAAKgD,QAAU/B,EACfjB,KAAK8C,c,iCApCc,OAAO,K,iCACN,OAAO,K,iCACP,OAAO,M,kCAE5B5B,K,qFAAoBtD,EAAUqF,S,mDAC9B/B,K,qFAAqBtD,EAAUsF,U,mDAC/BhC,K,qFAAqBtD,EAAUuF,U,GAiDnBvF,O,w/BCvCAwF,G,0CAfb,iB,4GAAc,+MACZpD,KAAKC,a,gKAILD,KAAKqD,QAAU,QACfrD,KAAK2B,UAAW,EAChB3B,KAAK4B,OAAQ,M,8BAXdV,K,kHACAA,K,+GACAA,K,6GAYAH,K,gGAAa,SAACuC,GACb,EAAKD,QAAUC,M,m2BCAJC,G,oDAbb,kB,sHAAc,qJACZvD,KAAKC,a,+LAILD,KAAKwD,sBAAmBpD,M,wCAPzBc,K,kIAUAH,K,gGAAwB,SAAC0C,GACxB,EAAKD,iBAAmBC,M,yBCdE,SAkBfC,GAlBgBC,GAE7B,OADuBA,EAAcC,YAAYC,YAC3BC,IAAI,SAAClD,GACzB,GAAY,cAARA,EACF,OAAOzB,OAAO4E,KAAKJ,EAAcK,WAAWF,IAAI,SAAAG,GAAS,OACvDN,EAAcK,UAAUC,GAAWH,IAAIJ,MAI3C,IAAMzC,EAAQ0C,EAAc/C,GAC5B,OAAIK,EAAM2C,YAAYC,YACbH,GAAsBzC,GAGxBA,I,kBCSIiD,G,gdAfb,oB,wHAAc,e,kNAAA,yBACZC,gBAAuB,CACrBC,OAAQ,0CACRC,WAAY,8BACZC,YAAa,qCACbC,UAAW,cACXC,cAAe,0BACfC,kBAAmB,eACnBC,MAAO,8CAGT1E,KAAK2E,SAAWR,aAAoBS,IAAI,W,sBAbzC1D,K,mtBCkEY2D,G,oCAnDb,qBAAc,Y,iHAAA,4VA0CdC,MAAQ,WACN,EAAKC,QAAQ9E,aACb,EAAK+E,OAAO/E,aACZ,EAAK7B,UAAU6B,aACf,EAAKyB,KAAKzB,aACV,EAAKgF,MAAMhF,cA9CXD,KAAK1C,MAAQ,IAAIA,IAAM4H,WAEvBlF,KAAK+E,QAAU,IAAII,IAAQnF,MAC3BA,KAAKgF,OAAS,IAAIjI,IAAOiD,MACzBA,KAAK5B,UAAY,IAAIgH,IACrBpF,KAAK0B,KAAO,IAAI2D,EAChBrF,KAAKiF,MAAQ,IAAIK,EACjBtF,KAAKuF,QAAU,IAAIC,EARP,IAYNC,EADeC,OAAOC,SAApBC,SACmBC,MAAM,KAEjC,GCnCmB,SAAjBC,iBACJ,IACEC,aAAaC,QAAQ,QAAS,QAC9B,MAAOC,GACP,OAAO,EAET,OAAO,ED8BHH,IACoB,EAAnBL,EAAUS,QAA+B,YAAjBT,EAAU,GACnC,CACA,IAAMU,EAAaJ,aAAaK,QAAQ,sBACpCD,GACFnF,WAAW,WACT,EAAK+D,QAAQsB,KAAKF,IACjB,KAGLG,YAAQ,WACN,IAAMC,EAAgB,EAAKxB,QAAQyB,OACnCT,aAAaC,QAAQ,qBAAsBO,IAC1C,CAAEE,MAAO,MAIdC,YACE,iBAAO,CACL,EAAKtI,UAAUuB,IACf,EAAKqF,OAAO9G,MACZiB,OAAOC,OAAO,EAAK4F,OAAO3F,aAAayE,IAAIJ,MAE7C,kBAAM,EAAKsB,OAAO7G,W,qBA7CrB+C,K,qHACAA,K,wHACAA,K,mHACAA,K,oHACAA,K,sHACAA,K,iEETGyF,G,UAAQ,IAAI9B,GACZ+B,EAAUxJ,SAASC,eAAe,OAExCwJ,IAASC,OACP,kBAACC,EAAA,EAAD,CAAKJ,MAAOA,IACZC,I,6pCCFIG,EADLC,Y,4eACiBC,gB,+MAMP,IACCN,EAAU3G,KAAKkH,MAAfP,MAGFlB,EAFeC,OAAOC,SAApBC,SAEmBC,MAAM,KACjC,OAAuB,EAAnBJ,EAAUS,QAA+B,YAAjBT,EAAU,GAC7B,kBAAC,IAAD,CAASd,SAAUgC,EAAMpB,QAAQZ,WAIxC,kBAAC,IAAD,CACEwC,UAAU,QACVC,iBAAiB,YAEjB,kBAAC,IAAD,CAAgB1F,KAAMiF,EAAMjF,OACJ,UAAvBiF,EAAMjF,KAAK2B,SACV,kBAAC,IAAD,CAAWsD,MAAOA,IAEI,YAAvBA,EAAMjF,KAAK2B,SACV,kBAAC,IAAD,CAAasD,MAAOA,IAEE,SAAvBA,EAAMjF,KAAK2B,SACV,kBAAC,IAAD,CAAUsD,MAAOA,IAEK,WAAvBA,EAAMjF,KAAK2B,SACV,kBAAC,IAAD,CAAYsD,MAAOA,S,WAOdU,kBAAIC,EAAJD,CAAYN,K,m1BC/CX,SA0DDQ,GA1DE,GAOX,IANJC,EAMI,EANJA,UACAC,EAKI,EALJA,YACAC,EAII,EAJJA,QACAC,EAGI,EAHJA,SACAhI,EAEI,EAFJA,IACAiI,EACI,EADJA,eAEMC,EAAeL,GAAa,EAE5BM,EAAMD,EAAeJ,EACrBM,EAAuB,EAAdN,EAAkBK,EAAM,EACjCE,EAAOC,UAAUP,EAAUE,GAAkBE,GAC7CI,EAAOD,UAAUR,EAAcE,GAAYG,GAE7CK,EAAaF,SAAUtI,EAAMmI,EAAOE,GACpB,IAAhBP,EACFU,EAAaL,EACJnI,IAAQ+H,EACjBS,EAAa,EACJxI,IAAQgI,IACjBQ,EAAaN,EAAeG,EAAOE,EAAOH,GAE5C,IAAMK,EAAazI,IAAQgI,EAAW,EAAIE,EAAeG,EAAOE,EAAOC,EAAaJ,EAEpF,OACE,yBAAKM,MAAO,CAAEC,QAAS,SACrB,yBAAKD,MAAK,iBACLE,EADK,CAERxK,MAAOiK,EACPQ,gBAAiB,yBAEnB,yBAAKH,MAAK,iBACLE,EADK,CAERxK,MAAOoK,EACPK,gBAAiB,yBAEnB,yBAAKH,MAAK,iBACLE,EADK,CAERxK,MAAOgK,EACP/J,OAAQ,OACRyK,UAAW,MACXD,gBAAiB,wBAEnB,yBAAKH,MAAK,iBACLE,EADK,CAERxK,MAAOqK,EACPI,gBAAiB,yBAEnB,yBAAKH,MAAK,iBACLE,EADK,CAERxK,MAAOmK,EACPM,gBAAiB,0BAtDzB,I,EAAMD,EAAe,CAAEvK,OAAQ,OAAQ0K,OAAQ,Y,q+BCMzCC,EADL3B,Y,gVAEC4B,cAAgB,WAAM,MACQ,EAAK1B,MAAzBlC,EADY,EACZA,OAAQ6D,EADI,EACJA,QAChB7D,EAAO/H,gBAAgB,gBACvB4L,K,2QAJiB5B,gB,mJAOV,MACuBjH,KAAKkH,MAA3BlC,EADD,EACCA,OAAQ5G,EADT,EACSA,UAChB,OACE,kBAAC,IAAM0K,SAAP,KACE,kBAAC/L,EAAA,EAAD,CACEG,GAAG,eACHa,MAAOiH,EAAOjH,MACdC,OAAQgH,EAAOhH,OACf+K,QAAS/I,KAAK4I,gBAEhB,kBAAC,GAAD,CACEpB,UAAWxC,EAAOjH,MAClB0J,YAAarJ,EAAU4K,OACvBtB,QAAStJ,EAAUC,WACnBsJ,SAAUvJ,EAAU6K,UACpBtJ,IAAKvB,EAAUuB,IACfiI,eAAgBxC,IAAU8D,a,cAOrBP,O,kCCjBM,SAAfQ,GAAgBC,EAAMC,GAAP,OArBJ,SAAXC,SAAYF,EAAMG,EAAUC,GAChC,IAAMC,EAAO,IAAIC,KAAK,CAACN,GAAO,CAAEI,SAChC,GAAI9D,OAAOiE,UAAUC,iBACnBlE,OAAOiE,UAAUC,iBAAiBH,EAAMF,OACnC,CACL,IAAMM,EAAMzM,SAAS0M,cAAc,KAC7BC,EAAMrE,OAAOsE,IAAIC,gBAAgBR,GAEvCI,EAAIK,KAAOH,EACXF,EAAIP,SAAWC,EAEfnM,SAAS+M,KAAKC,YAAYP,GAC1BA,EAAIQ,QAEJrJ,WAAW,WACT5D,SAAS+M,KAAKG,YAAYT,GAC1BnE,OAAOsE,IAAIO,gBAAgBR,MAM/BT,CAASF,EAAD,UAAUC,EAAV,SAA2B,a,k2BCjB/BlE,G,0CAKJ,iBAAYnI,GAAW,Y,4GAAA,6KA0BvB4E,MAAQ,WACN,EAAKtE,MAAMyH,QAAQnD,QACnB,EAAKtE,MAAMyH,QAAQ5D,SAFP,MAIkB,EAAKnE,UAA3BgI,EAJI,EAIJA,OAAQ5G,EAJJ,EAIIA,UAChB4G,EAAOxE,aAAQJ,OAAWA,GAC1BhC,EAAUoM,MAAMpF,IAAU8D,OAC1B9K,EAAUqM,OAAOrM,EAAU4K,SAjCN,KAoCvB3C,KAAO,SAACqE,EAAWC,EAAUzL,GAAa,MACV,EAAKlC,UAA3BgI,EADgC,EAChCA,OAAQ5G,EADwB,EACxBA,UACVwM,EAAQC,KAAKC,MAAMJ,GAEnB7I,EAAO8I,GAAYC,EAAM7F,QAAQlD,KACvC,EAAKkJ,QAAQlJ,EAAKmJ,QAAQ,YAAa,KAEvC7L,OAAO4E,KAAK6G,EAAMxM,WAAWkB,QAAQ,SAACsB,GACpCxC,EAAUwC,GAAOgK,EAAMxM,UAAUwC,KAGnCzB,OAAO4E,KAAK6G,EAAM5F,QAAQ1F,QAAQ,SAACsB,GACrB,gBAARA,EACF,EAAKqK,WAAaL,EAAM5F,OAAO3F,YAE/B2F,EAAOpE,GAAOgK,EAAM5F,OAAOpE,KAI3B1B,GAAUA,KAvDO,KA0DvBgM,aAAe,SAACtM,EAAOM,GAAa,IAE5BiM,EADYvM,EAAMwM,OAAhBC,MACiB,GACnBC,EAAS,IAAIC,WACnBD,EAAOE,OAAS,kBAAM,EAAKnF,KAAKiF,EAAOG,OAAQN,EAAWtJ,KAAM3C,IAEhE,EAAKlC,UAAU8H,QACfwG,EAAOI,WAAWP,IAjEG,KAoEvB3E,KAAO,WAAM,MAEmB,EAAKxJ,UAA3BgI,EAFG,EAEHA,OAAQ5G,EAFL,EAEKA,UAMhB,OALsByM,KAAKc,UAAU,CACnC5G,QAAS,EAAKlE,SACdzC,UAAWA,EAAUyC,SACrBmE,OAAQA,EAAOnE,YA1EI,KA+EvByI,SAAW,SAACsC,GACVzC,GAAayC,EAAQ,EAAK/J,OAhFL,KAmFvBgK,QAAU,WACR,IAAMtF,EAAgB,EAAKC,OAC3B,EAAKxJ,UAAUuI,QAAQZ,SAASmH,OAAOC,IAAIxF,IApF3CvG,KAAKhD,UAAYA,EACjBgD,KAAK1C,MAAQN,EAAUM,MACvB0C,KAAKC,a,mKAIDD,KAAK1C,MAAMyH,UACb/E,KAAK1C,MAAMyH,QAAQnD,QACnB5B,KAAK1C,MAAMyH,QAAQ5D,UAErBnB,KAAK6B,KAAO,eACZ7B,KAAKiL,gBAAa7K,EAClBJ,KAAKgM,YAAa,I,sCAIlB,MAAQ,CACNnK,KAAM7B,KAAK6B,Q,sCAICA,GACd7B,KAAK6B,KAAOA,M,8BA3BbX,K,oHACAA,K,oHACAA,K,+GAwBAH,K,uEAuEYoE,O,4+DCnGT8G,G,22CAAenK,Q,mJAOjB,0FAEEC,OAAQ/B,KAAK+B,W,wCAWRC,GAAW,MACDhC,KAAKiC,SAAdC,EADU,EACVA,EAAGC,EADO,EACPA,EACX,IAAInC,KAAK1C,MAAMK,KAAKsO,OAApB,iBACKjK,EADL,CAEEkK,OAAQ,CAAClM,KAAKqC,SAASH,GAAIlC,KAAKqC,SAASF,EAAG,WAC5CJ,OAAQ/B,KAAKqC,SAASrC,KAAK+B,QAAU,O,iCAZ1B,OAAO/B,KAAKgD,S,iBAChB/B,GAETjB,KAAKgD,QAAU/B,EACfjB,KAAK8C,c,kCAfe,OAAO,O,gCAE5B5B,K,qFAAqB+K,EAAO9I,U,GA0BhB8I,O,u4FCnBf,IAUM/H,EADL8C,Y,mVAECmF,MAAQ,CACNC,MAAO,GACPrO,WAAOqC,EACPpC,YAAQoC,G,EAiDVwI,cAAgB,SAAChI,EAAKyL,EAAMC,GAAZ,OAAqB,WACnCD,EAAKrH,OAAO/H,gBAAZ,uBAA4C2D,IAC5CyL,EAAKrH,OAAOzF,QACZ8M,EAAKtH,QAAQsB,KAAKiG,GAClB,EAAKC,iBAAiBF,GACtBA,EAAKjO,UAAUoO,S,EAGjBD,iBAAmB,SAACF,GAClBlN,OAAOsB,QAAQ4L,EAAKtH,QAAQkG,YAAY3L,QAAQ,YAAwB,0BAAtBmN,EAAsB,KAAbC,EAAa,KACvDC,EAAwCD,EADe,MAC5C1I,EAA6B0I,EAA7B1I,UAAc4I,EAD8B,yBACfF,EADe,uBAGhEnO,EAAa,IAAIsO,IAAMF,GAAWF,GACxCJ,EAAKrH,OAAO8H,IAAIvO,GAEhB,IAAMwO,EAAiB5N,OAAOsB,QAAQuD,GACnCtD,OAAO,SAACsM,EAAD,GAAyC,0BAAhCC,EAAgC,KAAlBC,EAAkB,KAG/C,OADAF,EAAMC,GAAgBC,EAAapJ,IAAIqJ,IAASC,UACzCJ,GACN,IACLzO,EAAWyF,U,mXAAX,IACK,EAAKA,UADV,GAEK+I,GAGL5N,OAAOsB,QAAQmM,GAAYtN,QAAQ,YAAkB,0BAAhBsB,EAAgB,KAAXK,EAAW,KACnD1C,EAAWqC,GAAOK,MAItBoL,EAAKrH,OAAOhG,WACZqN,EAAKrH,OAAO7G,Q,4QArFM8I,gB,0KAOA,WACZoG,EAAYjQ,SAASC,eAAe,sBACpCU,EAAQ4E,KAAK2K,MAAMD,EAAUE,aAAe,GAC5CvP,EAAS2E,KAAK2K,MAAO,EAAI,GAAMvP,GACrCiC,KAAKwN,SAAS,CAAEzP,QAAOC,WAGFgC,KAAKkH,MAAlBvC,SACClG,GAAG,cAAe,SAAC2K,GAC1B,IAAMqE,EAAU,CACd7M,IAAK,GAAF,OAAK8M,YAAWtE,EAAKuE,QACxBrB,KAAMlD,EAAKuE,MACXtB,KA7BS,SAAXuB,WACJ,IAAMC,EAAM,GAKZ,OAJAA,EAAIvQ,MAAQ,IAAIA,IAAM4H,WACtB2I,EAAI9I,QAAU,IAAII,IAAQ0I,GAC1BA,EAAI7I,OAAS,IAAIjI,IAAO8Q,GACxBA,EAAIzP,UAAY,IAAIgH,IACbyI,EAuBKD,IAGR,EAAKJ,SAAS,SAACM,GACb,IAAMC,EAAYD,EAAU1B,MAAM,GAClC,OAAI2B,EACM,CACN3B,MAAO,CACL2B,EACAN,GAFG,0BAGAK,EAAU1B,MAAM4B,MAAM,MAIvB,CAAE5B,MAAO,CAACqB,U,4DAKLQ,EAAWH,GAAW,MACN9N,KAAKmM,MAA9BpO,EAD+B,EAC/BA,MAAOC,EADwB,EACxBA,OAAQoO,EADgB,EAChBA,MACjB8B,EAAeJ,EAAU1B,MAAMlG,OACrC,GAAIkG,EAAMlG,OAASgI,EAAc,CAC/B,IAAMC,EAA+B,IAAjBD,EAAqB,EAAI,EAC7C9B,EAAM+B,GAAa9B,KAAKrH,OAAOxE,QAAQzC,EAAOC,GAC9C0I,YACE,iBAAO,CACL0F,EAAM+B,GAAa9B,KAAKjO,UAAUuB,MAEpC,kBAAMyM,EAAM+B,GAAa9B,KAAKrH,OAAO7G,Y,sCAwClC,WACCiO,EAAUpM,KAAKmM,MAAfC,MAER,OACE,6BACE,yBAAK/D,MAAO,CAAEtK,MAAO,OAAQqQ,QAAS,OAAQnM,SAAU,QAASuG,gBAAiB,QAAS6F,OAAQ,QACjG,wBAAIhG,MAAO,CAAEiG,aAAc,QAA3B,0BACA,+BAAQlC,EAAMlG,OAAd,+CAGF,yBAAKhJ,GAAG,qBAAqBmL,MAAO,CAAEtK,MAAO,OAAQqQ,QAAS,WAAYG,WAAY,UAClE,IAAjBnC,EAAMlG,OACL,+CAEAkG,EAAMtI,IAAI,gBAAGuI,EAAH,EAAGA,KAAMzL,EAAT,EAASA,IAAK0L,EAAd,EAAcA,KAAd,OACR,yBAAK1L,IAAKA,EAAKyH,MAAO,CAAE+F,QAAS,aAC/B,wBAAI/F,MAAO,CAAEiG,aAAc,QAAUjC,EAAKtH,QAAQlD,MAClD,kBAAC,IAAD,CACE3E,GAAE,uBAAkB0D,GACpB7C,MAAOsO,EAAKrH,OAAOjH,MACnBC,OAAQqO,EAAKrH,OAAOhH,OACpB+K,QAAS,EAAKH,cAAchI,EAAKyL,EAAMC,c,eAW1CpI,O,oeCzIAsK,IANE,SAAXA,SAAY,GAAD,IAAGtR,EAAH,EAAGA,GAAIuR,EAAP,EAAOA,SAAapG,EAApB,qDACf,yBAAKnL,GAAIA,EAAImL,MAAOA,GACjBoG,K,49BCFCC,G,0CAUJ,gBAAYlF,I,4GAAM,uHAChBxJ,KAAKwJ,KAAOA,EACZxJ,KAAK2O,UAAY,GACjB3O,KAAK4O,SAAW,E,+DAZC,OAAO,M,+BACN,OAAO,K,sCAEzB,MAAO,CAAC,YAAa,gB,2DAarB,MAAQ,CACNpF,KAAMxJ,KAAKwJ,KACXmF,UAAW3O,KAAK2O,UAChBC,SAAU5O,KAAK4O,Y,oCAID,OAAO5O,KAAK6O,Y,iBAchB5N,GACZjB,KAAK6O,WAAa5N,I,mCAdH,OAAOjB,KAAK8O,W,iBAiBhB7N,GACXjB,KAAK8O,UAAY7N,I,mCAhBjB,IAAIiB,EAAIlC,KAAK2O,UACTxM,EAAInC,KAAK4O,SAOb,MANkB,OAAd5O,KAAKwJ,OACPtH,EAAIwM,OAAOK,IAAM/O,KAAK2O,UACtBxM,EAAIuM,OAAOK,IAAM/O,KAAK4O,UAIjB,CAAE1M,EAFTA,GAAKwM,OAAOK,IAEA5M,EADZA,GAAKuM,OAAOK,M,oBAYS,IAAR7M,EAAQ,EAARA,EACP8M,GADe,EAAL7M,EACHD,EAAIwM,OAAOK,KAClBE,EAAO/M,EAAIwM,OAAOK,IACN,OAAd/O,KAAKwJ,MACPxJ,KAAK2O,UAAYD,OAAOK,IAAMC,EAC9BhP,KAAK4O,SAAWF,OAAOK,IAAME,IAE7BjP,KAAK2O,UAAYK,EACjBhP,KAAK4O,SAAWK,O,mCA/CnB/N,K,mHACAA,K,iEAmDYwN,O,oCC7Df,oEAAMQ,EAAY,SAAZA,UAAaC,GAIjB,IADA,IAAMC,EAAWD,EAAIE,cAAcxJ,MAAM,UAChCyJ,EAAI,EAAGA,EAAIF,EAASlJ,OAAQoJ,GAAK,EACxCF,EAASE,GAAKF,EAASE,GAAGC,OAAO,GAAGC,cAAgBJ,EAASE,GAAGG,UAAU,GAE5E,OAAOL,EAASM,KAAK,MAGjBhC,EAAa,SAAbA,WAAcyB,GAElB,IAAIQ,EAAO,EACX,GAAmB,IAAfR,EAAIjJ,OAAc,OAAOyJ,EAE7B,IAAK,IAAIL,EAAI,EAAGA,EAAIH,EAAIjJ,OAAQoJ,GAAK,EAAG,CAEtCK,GAASA,GAAQ,GAAKA,EADTR,EAAIS,WAAWN,GAE5BK,GAAQA,EAGV,OAAOA,I,kCCrBT,4BAGM9C,EAAQ,CACZZ,WACArO,eAGaiP,O,4/BCNTzH,G,0CAcJ,qBAAc,Y,4GAAA,ijBAiDdyK,UAAY,WACV,IAAMC,EAAQ,EAAKnQ,IAAM,EACzB,OAAImQ,EAAQ,EAAK7G,UACG,SAAd,EAAKvH,KAAwB,EAAKrD,WAC/B,KAEFyR,GAvDK,KA0DdC,UAAY,WACV,IAAMC,EAAU,EAAKrQ,IAAM,EAC3B,OAAIqQ,EAAU,EAAK3R,WACC,SAAd,EAAKqD,KAAwB,EAAKuH,UAC/B,KAEF+G,GAhEK,wZACZhQ,KAAKC,a,oEAdc,OAAO,I,yCACE,MAAO,CAAC,OAAQ,Y,sEAiB5CD,KAAKgJ,OAAS,IACdhJ,KAAK3B,WAAa+G,UAAU8D,MAC5BlJ,KAAKiJ,UAAY,IACjBjJ,KAAKiQ,IAAM,GACXjQ,KAAKL,IAAMK,KAAK3B,WAChB2B,KAAKkQ,SAAU,EACflQ,KAAKmQ,KAAO,EACZnQ,KAAKoQ,UAAY,KACjBpQ,KAAK0B,KAAO,S,sCAIZ,MAAQ,CACNsH,OAAQhJ,KAAKgJ,OACb3K,WAAY2B,KAAK3B,WACjB4K,UAAWjJ,KAAKiJ,UAChBgH,IAAKjQ,KAAKiQ,IACVvO,KAAM1B,KAAK0B,Q,0CAIGwE,IAChBlG,KAAKgJ,OAAS9C,GACDlG,KAAKiJ,YAChBjJ,KAAKiJ,UAAY/C,O,kCAvCpBhF,K,oHACAA,K,mHACAA,K,6GACAA,K,6GACAA,K,iHACAA,K,8GACAA,K,mHACAA,K,8GACAA,K,iHA4BAH,K,uHAOAA,K,gGAAe,SAACsP,GACXA,EAAIjL,EAAU8D,OAASmH,EAAI,EAAKrH,SACpC,EAAK3K,WAAagS,EACd,EAAK1Q,IAAM0Q,GACb,EAAKC,UAAUD,Q,kDAIlBtP,K,gGAAgB,SAACsP,GACZA,EAAIjL,EAAU8D,OAASmH,EAAI,EAAKrH,SACpC,EAAKC,UAAYoH,EACb,EAAK1Q,IAAM0Q,GACb,EAAKC,UAAUD,Q,gDAsBlBtP,K,gGAAc,WACY,OAArB,EAAK8O,cACT,EAAKK,SAAU,EACf,EAAKK,cAAc,WACjB,IAAMV,EAAY,EAAKA,YACvB,GAAkB,OAAdA,EAAoB,OAAO,EAAKW,QACpC,EAAK7Q,IAAMkQ,S,iDAId9O,K,gGAAe,WACd,EAAKmP,SAAU,EACX,EAAKE,WAAWK,qBAAqB,EAAKL,e,qDAG/CrP,K,gGAAmB,SAACtB,GACnB,EAAKE,IAAMF,M,qDAGZsB,K,gGAAmB,WAClB,EAAKuP,UAAU,EAAKjS,gB,oDAGrB0C,K,gGAAkB,WACjB,EAAKuP,UAAU,EAAKrH,e,oDAGrBlI,K,gGAAkB,WACjB,IAAM8O,EAAY,EAAKA,YACL,OAAdA,GACJ,EAAKS,UAAUT,O,oDAGhB9O,K,gGAAkB,WACjB,IAAMgP,EAAY,EAAKA,YACL,OAAdA,GACJ,EAAKO,UAAUP,O,yDAGhBhP,K,gGAAuB,SAAC2P,GACvB,IAAMC,EAAW,IAAO,EAAKV,IACzBW,EAAOC,KAAKlR,OAEH,SAAPmR,OACJ,IAAqB,IAAjB,EAAKZ,QAAT,CACA,EAAKE,UAAYW,sBAAsBD,MACvC,IAAMnR,EAAMkR,KAAKlR,MACXqR,EAAQrR,EAAMiR,EACPD,GAATK,IACFJ,EAAOjR,EAAOqR,EAAQL,EACtB,EAAKR,KAAOxN,KAAK2K,MAAM0D,EAAQL,EAAYK,EAAQL,GACnDD,MAGJI,O,GAIW1L,O,80BCrIA6L,IANF,SAAPA,KAAQ,GAAD,IAAGxC,EAAH,EAAGA,SAAapG,EAAhB,gDACX,yBAAKA,M,mXAAK,EAAIC,QAAS,QAAWD,IAC/BoG,K,qBCJL,IAAMyC,EAAaC,UAMnBD,EAAWnN,OAAOzE,QAAQ4R,I,6zCC+DXE,EA/DdpK,Y,wWAECqK,OAAS,SAACzS,GACRA,EAAM0S,iBACN,EAAKpK,MAAMqK,QAAQ3S,EAAME,cAAc5B,K,EAGzCsU,UAAY,WAAM,IACRC,EAAa,EAAKvK,MAAlBuK,SACFC,EAAS,IAAIzF,IAAJ,iBAAqB9M,OAAO4E,KAAK0N,GAAUvL,SAC1D,EAAKgB,MAAM4F,IAAI4E,I,EAGjBC,aAAe,WAAM,IACXF,EAAa,EAAKvK,MAAlBuK,SACFG,EAAO,IAAIhU,IAAJ,eAAsBuB,OAAO4E,KAAK0N,GAAUvL,SACzD,EAAKgB,MAAM4F,IAAI8E,I,mRAfU3K,gB,2JAkBlB,IACC3G,EAASN,KAAKkH,MAAd5G,KAER,OACE,yBAAK+H,MAAO,CAAEC,QAAS,OAAQ8F,QAAS,uBACtC,qCACE5E,KAAK,SACLtM,GAAG,WACH2U,QAAS7R,KAAKqR,QACA,aAAT/Q,EAAsB,CAAEwR,QAAS,QAAW,IAEjD,mCAEF,4BACEtI,KAAK,SACLtM,GAAG,QACH2U,QAAS7R,KAAKqR,QAEd,mCAEF,qCACE7H,KAAK,SACLtM,GAAG,SACH2U,QAAS7R,KAAKqR,QACA,WAAT/Q,EAAoB,CAAEwR,QAAS,QAAW,IAE/C,yBAAKzJ,MAAO,CAAE0J,UAAW,oBAAzB,MAWF,4BAAQvI,KAAK,SAASqI,QAAS7R,KAAKwR,WAApC,YACA,4BAAQhI,KAAK,SAASqI,QAAS7R,KAAK2R,cAApC,oB,qnCCUOK,EAtEdhL,Y,sYAECmF,MAAQ,CACN8F,WAAY,G,EAUdC,SAAW,SAACtT,GACV,EAAK4O,SAAS,CAAEyE,WAAYrT,EAAMwM,OAAOnK,S,EAG3CkR,OAAS,WAAM,MACe,EAAKjL,MAAzBjG,EADK,EACLA,MAAOmR,EADF,EACEA,SACPH,EAAe,EAAK9F,MAApB8F,WAEFI,EAAcpK,SAASgK,GACzBxG,EAASxK,EACTqR,OAAOC,UAAUF,KACnB5G,EAAS4G,GAGXD,EAAS3G,GACT,EAAK+B,SAAS,CAAEyE,WAAYxG,K,EAG9B+G,cAAgB,SAAC5T,GAAU,IACjBgC,EAAkBhC,EAAlBgC,IAAK6R,EAAa7T,EAAb6T,SACD,YAAR7R,GAAqB6R,EACvB,EAAKC,YAAY,IACA,YAAR9R,EACT,EAAK8R,YAAY,GACA,cAAR9R,GAAuB6R,EAChC,EAAKE,YAAY,IACA,cAAR/R,GACT,EAAK+R,YAAY,I,EAIrBC,SAAW,SAAAC,GAAS,OAAI,SAACC,GAAW,MACN,EAAK5L,MAAzBjG,EAD0B,EAC1BA,MAAOmR,EADmB,EACnBA,SACTW,EAAOF,EAAU5R,EAAO6R,GAC9BV,EAASW,GACT,EAAKvF,SAAS,CAAEyE,WAAYc,M,EAI9BL,YAAc,EAAKE,SAAS,SAACI,EAAGC,GAAJ,OAAUD,EAAIC,I,EAC1CN,YAAc,EAAKC,SAAS,SAACI,EAAGC,GAAJ,OAAUD,EAAIC,I,ySApDjBhM,gB,mNAKL,IACVhG,EAAUjB,KAAKkH,MAAfjG,MACJA,IAAUjB,KAAKmM,MAAM8F,YACvBjS,KAAKwN,SAAS,CAAEyE,WAAYhR,M,sCA8CvB,IACCgR,EAAejS,KAAKmM,MAApB8F,WACR,OACE,2BACEzI,KAAK,OACLnB,MAAO,CAAEtK,MAAO,OAAQmV,YAAa,OAAQC,UAAW,UACxDlS,MAAOgR,EACPC,SAAUlS,KAAKkS,SACfkB,UAAWpT,KAAKwS,cAChBL,OAAQnS,KAAKmS,a,ioCC3CP,SAmBCkB,GAnBA,GAAoC,IAAlC5E,EAAkC,EAAlCA,SAAU6E,EAAwB,EAAxBA,KAAMC,EAAkB,EAAlBA,YACzBC,EAAcC,iBAAO,MAO3B,OACW,IAATH,EAAiB,KACf,yBAAKjL,MAAOA,EAAMgF,UAAWwE,QAPb,SAAd6B,YAAe9U,GACf4U,EAAYnQ,QAAQsQ,SAAS/U,EAAMwM,SACvCmI,MAMI,yBAAK3O,IAAK4O,EAAanL,MAAOA,EAAM8B,MAClC,yBAAK9B,MAAOA,EAAMuL,SAAUnF,K,MCoDvBoF,EAjFd7M,Y,kZAEC8M,eAAiB,SAAAC,GAAQ,OAAI,SAAC9S,GAAU,MAChB,EAAKiG,MAAnB1I,EAD8B,EAC9BA,KAAMmB,EADwB,EACxBA,IAEd,GAAInB,EAAKwF,UAAU+P,IAAavV,EAAKwF,UAAU+P,GAAU7N,OAAQ,CAC/D,IAAM8N,EAAmBxV,EAAKwF,UAAU+P,GAAUE,KAAK,SAAAxQ,GAAQ,OAAIA,EAAShE,QAAUE,IAClFqU,EACFA,EAAiB/S,MAAQA,EAEzBzC,EAAK0V,OAAL,UAAeH,GAAYpU,EAAKsB,QAGlCzC,EAAKuV,GAAY9S,I,+SAZMgG,gB,mNAgBX,IACNzI,EAASwB,KAAKkH,MAAd1I,KACFmO,EAAYnO,EAAKoF,YAAY/B,KAEnC,MAAkB,WAAd8K,EAEA,kBAAC,IAAM7D,SAAP,KACE,yCACA,yBAAKT,MAAO,CAAEC,QAAS,SACrB,kBAAC,EAAD,CAAcrH,MAAOzC,EAAKuD,OAAQqQ,SAAUpS,KAAK8T,eAAe,cAMtD,cAAdnH,EAEA,kBAAC,IAAM7D,SAAP,KACE,uCACA,yBAAKT,MAAO,CAAEC,QAAS,SACrB,kBAAC,EAAD,CAAcrH,MAAOzC,EAAKT,MAAOqU,SAAUpS,KAAK8T,eAAe,WAC/D,kBAAC,EAAD,CAAc7S,MAAOzC,EAAKR,OAAQoU,SAAUpS,KAAK8T,eAAe,mBANxE,I,sCAaO,IACCtV,EAASwB,KAAKkH,MAAd1I,KAER,YAAa4B,IAAT5B,EAEA,wBAAI6J,MAAO,CAAE+F,QAAS,OAAQlQ,MAAO,aAArC,iCAOF,yBAAKmK,MAAO,CAAE+F,QAAS,SACrB,4BAAK5P,EAAKoC,KACV,2CACA,yBAAKyH,MAAO,CAAEC,QAAS,SACrB,kBAAC,EAAD,CAAcrH,MAAOzC,EAAK0D,EAAGkQ,SAAUpS,KAAK8T,eAAe,OAC3D,kBAAC,EAAD,CAAc7S,MAAOzC,EAAK2D,EAAGiQ,SAAUpS,KAAK8T,eAAe,QAG7D,wCACA,yBAAKzL,MAAO,CAAEC,QAAS,SACrB,kBAAC,EAAD,CAAcrH,MAAOzC,EAAK2V,MAAO/B,SAAUpS,KAAK8T,eAAe,YAGjE,2CACA,yBAAKzL,MAAO,CAAEC,QAAS,SACrB,kBAAC,EAAD,CAAcrH,MAAOzC,EAAK4V,SAAUhC,SAAUpS,KAAK8T,eAAe,eAGnE9T,KAAKqU,qB,sBDhFRhM,EAAQ,CACZgF,UAAW,CACTpL,SAAU,QACVoM,OAAQ,IACRiG,KAAM,EACNC,IAAK,EACLxW,MAAO,OACPC,OAAQ,OACRwW,SAAU,OACVhM,gBAAiB,sBAEnB2B,KAAM,CACJ3B,gBAAiB,UACjBE,OAAQ,WACR+L,OAAQ,iBACR1W,MAAO,OAET6V,QAAS,CACPxF,QAAS,S,6nCEgCEsG,EA/Cd1N,Y,wZAEC+D,QAAU,SAACnM,GACS,EAAKsI,MAAfP,MACF5B,QAAQgG,QAAQnM,EAAMwM,OAAOnK,Q,EAGrC0T,UAAY,SAAC/V,GAAU,IACb+H,EAAU,EAAKO,MAAfP,MACFT,EAAS+B,SAASrJ,EAAMwM,OAAOnK,OACrC0F,EAAMvI,UAAUuW,UAAUzO,I,EAG5B0O,SAAW,SAAChW,GACQ,EAAKsI,MAAfP,MACF3B,OAAO9G,MAAQU,EAAMwM,OAAOnK,O,EAGpC4T,WAAa,kBAAM,EAAK3N,MAAMP,MAAM3B,OAAOuM,QAAQ,W,kTAjBvBtK,gB,yMAmBnB,IACCN,EAAU3G,KAAKkH,MAAfP,MAER,OACE,kBAAC,GAAD,CAAO2M,KAAM3M,EAAMjF,KAAKC,SAAU4R,YAAavT,KAAK6U,YAClD,gDAEA,+CACA,2BAAOrL,KAAK,OAAOvI,MAAO0F,EAAM5B,QAAQlD,KAAMqQ,SAAUlS,KAAK+K,UAE7D,mDACA,2BAAOvB,KAAK,SAASsL,KAAK,IAAI7T,MAAO0F,EAAMvI,UAAU4K,OAAQkJ,SAAUlS,KAAK2U,YAE5E,oDACA,4BAAQ1T,MAAO0F,EAAM3B,OAAO9G,MAAOgU,SAAUlS,KAAK4U,UAChD,4BAAQ3T,MAAM,WAAd,SACA,4BAAQA,MAAM,WAAd,UAGF,yBAAKoH,MAAO,CAAEC,QAAS,OAAQyM,cAAe,gBAC5C,4BAAQvL,KAAK,SAASqI,QAAS7R,KAAK6U,YAApC,e,snCCZKG,EA5BdhO,Y,sYAEC6N,WAAa,kBAAM,EAAK3N,MAAMP,MAAM3B,OAAOuM,QAAQ,W,ySAD1BtK,gB,6LAGhB,IACCN,EAAU3G,KAAKkH,MAAfP,MACAjF,EAAyBiF,EAAzBjF,KAAMqD,EAAmB4B,EAAnB5B,QAASD,EAAU6B,EAAV7B,MAEvB,OACE,kBAAC,GAAD,CAAOwO,KAAM5R,EAAKE,MAAO2R,YAAavT,KAAK6U,YACzC,+CAEA,sDAEE,gCAAS9P,EAAQlD,MAFnB,mFAOA,yBAAKwG,MAAO,CAAEC,QAAS,OAAQ2M,eAAgB,aAC7C,4BAAQzL,KAAK,SAASqI,QAAS7R,KAAK6U,YAApC,UACA,4BAAQrL,KAAK,SAASqI,QAAS/M,GAA/B,gB,88ECVJoQ,EADLlO,Y,oXAECmF,MAAQ,CACNgJ,OAAO,EACPC,iBAAiB,G,EAGnBC,qB,IAmEAxM,QAAU,WACW,EAAK3B,MAAMP,MAAtB3B,OACDzF,QACP,EAAKiO,SAAS,CAAE2H,OAAO,K,EAGzBrI,IAAM,SAACtO,GACc,EAAK0I,MAAMP,MAAtB3B,OACD8H,IAAItO,I,gSAjFSyI,gB,uMAQF,aACUjH,KAAKkH,MAAMP,MAA/B3B,EADU,EACVA,OAAQD,EADE,EACFA,QACVsI,EAAYjQ,SAASC,eAAe,mBAC1C2D,WAAW,WACT,IAAMjD,EAAQ4E,KAAK2K,MAAMD,EAAUE,aAAe,GAC5CvP,EAAS2E,KAAK2K,MAAO,EAAI,GAAMvP,GACrCiH,EAAOxE,QAAQzC,EAAOC,IACrB,GAEiB,WAAhBgH,EAAO1E,MACTU,WAAW,WACTgE,EAAOuM,aAAQnR,GACf4E,EAAOuM,QAAQ,WACd,IAGLvR,KAAKqV,gBAAkB/O,YAAQ,WAC7B,EAAKkH,SAAS,CAAE4H,gBAAiBE,QAAQvQ,EAAQkG,kB,4DAIlCgD,EAAWH,GAAW,WACjCyH,EAAsBzH,EAAUsH,gBADC,EAEXpV,KAAKkH,MAAMP,MAA/B3B,EAF+B,EAE/BA,OAAQD,EAFuB,EAEvBA,QAFuB,EAGJ/E,KAAKmM,MAAhCgJ,EAH+B,EAG/BA,MAAOC,EAHwB,EAGxBA,iBAEZrQ,EAAQiH,aAENmJ,IAAUI,GAAuBH,GACjCA,IAAoBtH,EAAUqH,OAASA,KAG1ChW,OAAOsB,QAAQsE,EAAQkG,YAAY3L,QAAQ,YAAwB,0BAAtBmN,EAAsB,KAAbC,EAAa,KAClDC,EAAwCD,EADU,MACvC1I,EAA6B0I,EAA7B1I,UAAc4I,EADyB,yBACVF,EADU,uBAG3DnO,EAAa,IAAIsO,IAAMF,GAAWF,GACxCzH,EAAO8H,IAAIvO,GAEX,IAAMwO,EAAiB5N,OAAOsB,QAAQuD,GACnCtD,OAAO,SAACsM,EAAD,GAAyC,0BAAhCC,EAAgC,KAAlBC,EAAkB,KAG/C,OADAF,EAAMC,GAAgBC,EAAapJ,IAAIqJ,IAASC,UACzCJ,GACN,IACLzO,EAAWyF,U,mXAAX,IACK,EAAKA,UADV,GAEK+I,GAGL5N,OAAOsB,QAAQmM,GAAYtN,QAAQ,YAAkB,0BAAhBsB,EAAgB,KAAXK,EAAW,KACnD1C,EAAWqC,GAAOK,MAItB8D,EAAQiH,YAAa,K,kEAIF,MACOhM,KAAKkH,MAAMP,MAA/B5B,EADa,EACbA,QADa,EACJC,OACVlF,YACPiF,EAAQnD,QACR5B,KAAKqV,oB,sCAcE,MACuBrV,KAAKkH,MAAMP,MAAjC3B,EADD,EACCA,OAAQ5G,EADT,EACSA,UACR+W,EAAUnV,KAAKmM,MAAfgJ,MACR,OACE,kBAAC,IAAMrM,SAAP,KACE,kBAAC,EAAD,CAAiBnC,MAAO3G,KAAKkH,MAAMP,QACnC,kBAAC,EAAD,CAAcA,MAAO3G,KAAKkH,MAAMP,QAChC,kBAACsK,EAAA,EAAD,CACE7J,iBAAiB,YACjBoO,oBAAoB,cAEpB,kBAAChH,EAAA,EAAD,CAAUiH,SAAS,gBAAgBvY,GAAG,kBAAkBkR,QAAQ,OAAOsH,UAAU,UAC/E,kBAAC/M,EAAA,EAAD,CAAQ3D,OAAQA,EAAQ5G,UAAWA,EAAWyK,QAAS7I,KAAK6I,WAE9D,kBAAC2F,EAAA,EAAD,CAAUiH,SAAS,gBAAgBjN,gBAAgB,sBACjD,kBAAC,EAAD,CAAgBhK,KAAMwG,EAAOzE,SAAUZ,IAAKvB,EAAUuB,OAExD,kBAAC6O,EAAA,EAAD,CAAUiH,SAAS,gBAAgBjN,gBAAgB,sBAC/C2M,GACA,kBAAC,EAAD,CACE1D,SAAUzM,EAAO3F,YACjByN,IAAK9M,KAAK8M,IACVxM,KAAM0E,EAAO1E,KACbiR,QAASvM,EAAOuM,iB,iBAUjB2D,O,kCCrIE,SAAXS,GAAYC,EAAMC,GAAP,MAAiB,CAAED,OAAMC,QAEzB,SAAXC,GAAY5T,EAAG6T,EAAGC,EAAGC,EAAGC,GAC5B,IAAMC,EAAKJ,EAAI7T,EACTkU,EAAKD,EAAKH,EACVK,EAAKD,EAAKlU,EAAI+T,EACpB,MAAO,CACLK,EAAGD,EAAKnU,EAAIgU,EACZK,IAAKJ,EAAKC,GAAMlU,EAAImU,EACpBD,KACAC,MAqCkB,SAAhBG,GAAiBT,EAAGC,EAAGC,EAAGC,GAC9B,IAAIO,EACAzD,EACA0D,EACAC,EACJ,GAAU,IAANZ,EACFU,OAAIrW,EACJ4S,EAAIgD,EACJU,EAAKT,EACLU,EAAKT,OACA,GAAU,IAANA,EACTO,EAAI,EACJzD,EAAI+C,EACJW,EAAKV,EACLW,EAAKV,MACA,CAGL,IAAIW,EAAWd,GADfW,GAAMT,GADNhD,EAAI+C,GACW,EACYA,EAAGC,EAAGC,EAAGC,GAChCW,EAAID,EAASN,EACbQ,EAAKF,EAASL,GAClBG,EAAKE,EAASR,GACdO,EAAKC,EAASP,GAEd,IAAIU,EAAIF,EAAId,EACRiB,EAAIrU,KAAK,IAALA,KAAKsU,IAAIF,GAAO,EAAI,GACtBG,EAAIvU,KAAKwU,KAAKJ,GAEZ,GADRA,GAAKD,EAAKf,KAERiB,EAAI,kBAAoBrU,KAAKC,IAAIoU,EAAGrU,KAAKyU,KAAKL,KAEhD,IAAIM,EAAKZ,EAAIS,EAAIF,EACjB,GAAIK,IAAOZ,EAAG,CAEZ,IADA,IAAMa,EAAM,EAAK,IAAMhF,OAAOiF,QAI5BV,GADAD,EAAWd,GADXW,EAAIY,EACmBtB,EAAGC,EAAGC,EAAGC,IACnBI,EACbQ,EAAKF,EAASL,GACdG,EAAKE,EAASR,GACdO,EAAKC,EAASP,GAEEa,EAAIT,EAAbS,GADPG,EAAa,IAAPP,EAAWL,EAAIA,EAAKI,EAAIC,EAAMQ,KAElC3U,KAAKsU,IAAIlB,GAAKU,EAAIA,EAAI9T,KAAKsU,IAAIf,EAAIO,KAErCC,IADAC,GAAMT,EAAIO,GACCR,GAAKQ,IAItB,IAAMe,EAAQ,QACJpX,IAANqW,GACFe,EAAM1L,KAAK6J,GAASc,EAAG,IAEzB,IAAMgB,EAtFM,SAARC,MAAS3B,EAAGC,EAAGC,GACnB,IAAMhD,GAAK+C,EAAI,EACTa,EAAI5D,EAAIA,EAAI8C,EAAIE,EAClB0B,EAAK,EACLC,EAAK,EACLC,EAAK,EACLC,EAAK,EAET,GAAIjB,EAAI,EAAG,CACT,IAAMJ,EAAIxD,EAAI8C,EACRgC,EAAIpV,KAAKyU,MAAMP,GAAKd,EAG1B8B,EAFAF,EAAKlB,EAGLqB,IAFAF,EAAKG,OAGA,CAELD,EADAF,EAAK,EAEL,IAAMZ,EAAI/D,EAAItQ,KAAKwU,KAAKlE,GAAKtQ,KAAKyU,KAAKP,GAGrCgB,EAFQ,GAANb,GACFW,EAAK1B,EAAIF,GACHE,EAAIF,IAEV4B,EAAK1B,EAAIe,EACJA,EAAIjB,GAGb,MAAO,CACLJ,GAASgC,EAAIC,GACbjC,GAASkC,EAAIC,IAyDEJ,CAAM1E,EAAG0D,EAAIC,GAC9B,OAAOa,EAAMQ,OAAOP,G,0CA+CPQ,EAxCK,SAAdA,YAAe,GAAuB,IAArBC,EAAqB,EAArBA,GAAIC,EAAiB,EAAjBA,GAAIC,EAAa,EAAbA,GAAIC,EAAS,EAATA,GAIjC,GAAS,EAALH,GAAUA,EAAK,GAAU,EAALC,GAAUA,EAAK,EACrC,MAAMG,MAAM,2DAcJ,SAAJvB,GAAK7U,GACT,IACMsV,EAAQhB,GAAc+B,EAAIC,EAAIC,GADxBvW,GASZ,OAPAsV,EAAMkB,OAAO,SAAA1B,GAAC,OACD,IAAXA,EAAEnB,MACoB,GAAtBmB,EAAEpB,KAAK+C,QAAQ,KACf3B,EAAEpB,KAAK+C,QAAQ,KAAO,IACrBxZ,OAAOyZ,GAAG5B,EAAEpB,MAAO,KAGf4B,EAAM,GAAG5B,KAnBlB,IAAM2C,EAAK,EAAIL,EAAK,EAAIC,EAAK,EACvBK,GAAK,EAASN,EAAK,EAAIC,EACvBM,EAAK,EAAIP,EAETW,EAAK,EAAIT,EAAK,EAAIC,EAAK,EACvBS,GAAK,EAASV,EAAK,EAAIC,EACvBU,EAAK,EAAIX,EAqBf,MAAQ,CAAErB,KAAG5U,EALH,SAAJA,EAAKD,GAET,OAtCU,SAAR8W,MAAS9W,EAAG8Q,EAAGC,EAAGgG,EAAGC,GAAb,OACXlG,EAAI,KAAH,IAAI9Q,EAAK,GAAO+Q,EAAI,KAAH,IAAI/Q,EAAK,GAAO+W,EAAI/W,EAAKgX,EAqCnCF,CADMjC,GAAE7U,GACI2W,EAAIC,EAAIC,EAjBlB,M,k6BCxHP5L,G,eAUJ,kBAAY1N,EAAOwB,I,4GAAO,uNACxBjB,KAAKP,MAAQA,EACbO,KAAKiB,MAAQA,EACbjB,KAAKmZ,SAAW,IAAIzK,IAAO,MAC3B1O,KAAKoZ,UAAY,IAAI1K,IAAO,O,yEAZ5B,MAAO,CAAC,QAAS,QAAS,WAAY,iB,6DAgBtC,MAAQ,CACNjP,MAAOO,KAAKP,MACZwB,MAAOjB,KAAKiB,MACZkY,SAAUnZ,KAAKmZ,SAAStY,SACxBuY,UAAWpZ,KAAKoZ,UAAUvY,a,yCAId+J,GAAO,IACbnL,EAAsCmL,EAAtCnL,MAAOwB,EAA+B2J,EAA/B3J,MAAOkY,EAAwBvO,EAAxBuO,SAAUC,EAAcxO,EAAdwO,UAC1B3V,EAAW,IAAI0J,SAAS1N,EAAOwB,GAKrC,OAJAwC,EAAS0V,SAASxK,UAAYwK,EAASxK,UACvClL,EAAS0V,SAASvK,SAAWuK,EAASvK,SACtCnL,EAAS2V,UAAUzK,UAAYyK,EAAUzK,UACzClL,EAAS2V,UAAUxK,SAAWwK,EAAUxK,SACjCnL,M,cAGF4V,KAAO,SAACrG,EAAGC,GAAJ,OAAWD,EAAEvT,MAAQwT,EAAExT,O,EAE9B6Z,YAAc,SAACC,EAAIC,GAAL,OACnBvB,EAAY,CACVC,GAAIqB,EAAGH,UAAUnX,SAASC,EAC1BkW,GAAImB,EAAGH,UAAUnX,SAASE,EAC1BgW,GAAIqB,EAAGL,SAASlX,SAASC,EACzBmW,GAAImB,EAAGL,SAASlX,SAASE,K,EAItBsX,YAAc,SAACF,EAAIC,EAAI/Z,GAC5B,IAAMia,EAAQvM,EAASmM,YAAYC,EAAIC,GACjCG,GAAala,EAAQ8Z,EAAG9Z,QAAU+Z,EAAG/Z,MAAQ8Z,EAAG9Z,OAEhDma,EAAaF,EAAMvX,EAAEwX,GAE3B,OADuBH,EAAGvY,MAAQsY,EAAGtY,OAAS2Y,EAAcL,EAAGtY,O,qDA/ChEC,K,+GACAA,K,kHACAA,K,mHACAA,K,iEAiDYiM,O,8iCC1DTpQ,EADLiK,Y,wfACoBC,gB,yKAEjBjH,KAAK6Z,wB,4DAGY5L,QACO7N,IAApB6N,EAAUlQ,OACZiC,KAAK6Z,wB,gEAIa,MACO7Z,KAAKkH,MAAxBnJ,EADY,EACZA,MAAOgL,EADK,EACLA,aACD3I,IAAVrC,GACFgL,M,sCAIK,MACuB/I,KAAKkH,MAA3BhK,EADD,EACCA,GAAIa,EADL,EACKA,MAAOC,EADZ,EACYA,OACnB,YAAcoC,IAAVrC,EAA4B,KAE9B,4BACEsK,MAAO,CAAEC,QAAS,SAClBpL,GAAIA,EACJa,MAAOA,EACPC,OAAQA,Q,cAMDjB,O,wjCCrBT+c,E,0VACJC,cAAgB,SAACnb,GAAU,MACC,EAAKsI,MAAMP,MAA7B5B,EADiB,EACjBA,QAASrD,EADQ,EACRA,KACjB,OAAOqD,EAAQmG,aAAatM,EAAO,kBAAM8C,EAAKqK,IAAI,Y,EAGpDiO,iBAAmB,WAAM,IACfjV,EAAY,EAAKmC,MAAMP,MAAvB5B,QACRA,EAAQuE,SAASvE,EAAQyB,S,+QARJS,gB,uJAWd,IACClC,EAAY/E,KAAKkH,MAAMP,MAAvB5B,QAER,OACE,kBAAC,IAAD,CACEqC,iBAAiB,cACjBoO,oBAAoB,OAEpByE,aAAa,UAOb,kBAAC,IAAD,CAAUvE,UAAU,OAClB,4BAAQlM,KAAK,SAASqI,QAAS7R,KAAKga,kBAApC,2BAEF,kBAAC,IAAD,CAAUtE,UAAU,UAClB,2BAAOwE,QAAQ,cAAc7R,MAAO,CAAEC,QAAS,QAASvK,MAAO,UAA/D,4BACA,2BAAOyL,KAAK,OAAOtM,GAAG,cAAcgV,SAAUlS,KAAK+Z,cAAe1R,MAAO,CAAEtK,MAAO,YAEpF,kBAAC,IAAD,KACE,4BAAQyL,KAAK,SAASqI,QAAS9M,EAAQ8G,SAAvC,sC,cAOKiO,O,qBCxDfxS,EAAO6S,QAAU,IAA0B,gB,kqFCIrCrY,G,0CAoBJ,wBAAYlB,GAAK,Y,4GAAA,oXAgJjByB,SAAW,SAACpB,GAAD,IAAQmZ,EAAR,uDAAoB,QAApB,OACTnZ,EAAQ,IAAM,EAAK+D,OAAOoV,IAjJX,KAoJjBC,SAAW,SAAApZ,GAAK,OACdA,EAAQ,KArJO,KAoMjBqZ,cAAgB,SAAC7a,EAAOuE,GACtB,IAAMgF,EAAShF,EAAUF,IAAI,SAAAlD,GAAG,OAAIA,EAAInB,QAGxC,GAAIuJ,EAAOuR,SAAS9a,GAElB,OAAOuE,EADOgF,EAAOwR,QAAQ/a,IACLwB,MAI1B+H,EAAO8C,KAAKrM,GACZuJ,EAAOqQ,KAAK,SAACrG,EAAGC,GAAJ,OAAUD,EAAIC,IAC1B,IAAMwH,EAAQzR,EAAOwR,QAAQ/a,GAG7B,GAAc,IAAVgb,EAAa,OAAOzW,EAAU,GAAG/C,MACrC,GAAIwZ,IAAUzR,EAAO9C,OAAS,EAAG,OAAOlC,EAAUA,EAAUkC,OAAS,GAAGjF,MAGxE,IAAMyZ,EAAS1W,EAAUyW,EAAQ,GAC3BE,EAAQ3W,EAAUyW,GACxB,OAAOtN,IAASsM,YAAYiB,EAAQC,EAAOlb,IAxN3CO,KAAKY,IAAMA,EACXZ,KAAK1C,WAAQ8C,E,qEApBE,OAAO,K,4BACP,OAAO,K,gCAGH,OAAO,M,mCACJ,OAAO,I,qCAE7B,MAAO,CACLwa,IAAKjY,KAAKkY,MAAsB,IAAhBlY,KAAKmY,UACrBC,WAAY,GACZC,WAAY,K,sCAKd,MAAO,CAAC,IAAK,IAAK,QAAS,WAAY,YAAa,iB,mEAsBpD,MAAQ,CACNC,MAAOjb,KAAK4D,YAAY/B,KACxBK,EAAGlC,KAAKkC,EACRC,EAAGnC,KAAKmC,EACRgS,MAAOnU,KAAKmU,MACZC,SAAUpU,KAAKoU,SACfnW,UAAW+B,KAAK/B,UAChB+F,UAAW7E,OAAOsB,QAAQT,KAAKgE,WAAWtD,OACxC,SAACC,EAAD,GAAkC,0BAAxBua,EAAwB,KAAlBhO,EAAkB,KAGhC,OADAvM,EAAOua,GAAQhO,EAAapJ,IAAI,SAAAL,GAAQ,OAAIA,EAAS5C,WAC9CF,GACN,O,0CAmDSqE,GAChBhF,KAAKgF,OAASA,EACdhF,KAAK1C,MAAQ0H,EAAO1H,Q,8DAIpB0C,KAAKxB,KAAK2V,MAAMnU,KAAKqa,SAASra,KAAKmU,QACnCnU,KAAKxB,KAAK2c,OAAOnb,KAAKoU,Y,sDAGAL,EAAU/P,GAChChE,KAAKgE,UAAL,iBACKhE,KAAKgE,UADV,mBAEG+P,EAAW/P,M,oCAIT+P,EAAUtU,E,KAAkD,IAAxB2b,EAAwB,6B,KAC3DC,GAD2D,6B,SAAnCjb,IACFJ,KAAK+T,GAC3BuH,EAAI,IAAInO,IAAS1N,EAAO4b,GACxBrX,EAAY,GAAH,0BAAOhE,KAAKgE,UAAU+P,IAAtB,CAAiCuH,IAGhD,GAFAtX,EAAUqV,KAAKlM,IAASkM,OAEnB+B,GAAkB,CAAC,IAAK,KAAKb,SAASxG,GAAW,OAChDwH,EACa,MAAbxH,IAAoBwH,EAAS,KAChB,MAAbxH,IAAoBwH,EAAS,KAEjC,IAAMC,EAAcxb,KAAKub,GACnBE,EAAK,IAAItO,IAAS1N,EAAO+b,GACzBE,EAAkB,GAAH,0BAAO1b,KAAKgE,UAAUuX,IAAtB,CAA+BE,IACpDC,EAAgBrC,KAAKlM,IAASkM,MAE9BrZ,KAAKgE,UAAL,iBACKhE,KAAKgE,WADV,qBAEG+P,EAAW/P,GAFd,kBAGGuX,EAASG,GAHZ,SAMA1b,KAAK2b,gBAAgB5H,EAAU/P,GAGjC,OAAOsX,I,0CAGCvH,EAAUtU,GAClB,IAAIuE,EAAY,mBAAIhE,KAAKgE,UAAU+P,IAGnC,GAFA/P,EAAYA,EAAU0U,OAAO,SAAA4C,GAAC,OAAIA,EAAE7b,QAAUA,IAE7B,MAAbsU,EAAkB,CACpB,IAAI6H,EAAa,mBAAI5b,KAAKgE,UAAU7B,GACpCyZ,EAAaA,EAAWlD,OAAO,SAAA4C,GAAC,OAAIA,EAAE7b,QAAUA,IAChDO,KAAKgE,UAAL,iBACKhE,KAAKgE,UADV,CAEE9B,EAAG8B,EACH7B,EAAGyZ,SAGL5b,KAAK2b,gBAAgB5H,EAAU/P,K,oCAY5BgB,QACe5E,IAAhBJ,KAAKgF,QAAsBhF,KAAK6b,UAAU7W,GAE9C,IAAM8W,EAAc,CAClBja,KAAM7B,KAAKY,IACX3C,UAAW+B,KAAK/B,WAGW,mBAAlB+B,KAAK+b,UACd/b,KAAK+b,SAASD,QAGE1b,IAAdJ,KAAKxB,MAAoBwB,KAAKgc,uB,0CAIlChc,KAAKxB,KAAK2C,SACVnB,KAAKR,OAAOQ,KAAKgF,QACjBhF,KAAKgF,OAAO1G,sBAAsB0B,Q,gCAG/BP,GAAO,gBACQW,IAAdJ,KAAKxB,MAETW,OAAOsB,QAAQT,KAAKgE,WAAW1E,QAAQ,YAA2B,0BAAzByU,EAAyB,KAAf/P,EAAe,KAEhE,GAAiB,MAAb+P,EACJ,GAAiB,MAAbA,EAAkB,CAEpB,IAAMkI,EAAajY,EACbkY,EAAa,EAAKlY,UAAU7B,EAClC,GAA0B,IAAtB8Z,EAAW/V,QAAsC,IAAtBgW,EAAWhW,OAAc,OACxD,IAAMiW,EAAS,EAAK7B,cAAc7a,EAAOwc,GACnCG,EAAS,EAAK9B,cAAc7a,EAAOyc,GACzC,EAAKja,SAAW,CAAEC,EAAGia,EAAQha,EAAGia,OAC3B,CAEL,GAAyB,IAArBpY,EAAUkC,OAAc,OAC5B,IAAMjF,EAAQ,EAAKqZ,cAAc7a,EAAOuE,GACxC,EAAK+P,GAAY9S,O,+BA3JV,OAAOjB,KAAK1C,MAAMyH,QAAQsX,YAAY5N,SAASzO,KAAKY,O,4BACvD,OAAOZ,KAAKsc,I,iBAOhBrb,GACJjB,KAAKxB,KAAKyD,SAASC,EAAIlC,KAAKqC,SAASpB,GACrCjB,KAAKsc,GAAKrb,I,4BARF,OAAOjB,KAAKuc,I,iBAWhBtb,GACJjB,KAAKxB,KAAKyD,SAASE,EAAInC,KAAKqC,SAASpB,EAAO,UAC5CjB,KAAKuc,GAAKtb,I,mCAZK,MAAO,CAAEiB,EAAGlC,KAAKkC,EAAGC,EAAGnC,KAAKmC,I,oBAetB,IAARD,EAAQ,EAARA,EAAGC,EAAK,EAALA,EAChBnC,KAAKkC,EAAIA,EACTlC,KAAKmC,EAAIA,I,gCAhBG,OAAOnC,KAAKwc,Q,iBAmBhBvb,GACR,GAAmB,IAAfjB,KAAKmU,OAAyB,IAAVlT,EACtBjB,KAAKxB,KAAK2C,SACVnB,KAAKR,OAAOQ,KAAKgF,QACjBhF,KAAKxB,KAAK2V,MAAMnU,KAAKqa,SAASpZ,QACzB,CACL,IAAMwb,EAAUxb,EAAQjB,KAAKmU,MAC7BnU,KAAKxB,KAAK2V,MAAMsI,GAElBzc,KAAKwc,OAASvb,I,mCA3BC,OAAOjB,KAAK0c,W,iBA8BhBzb,GACX,IAAM0b,EAAW1b,EAAQjB,KAAKoU,SAC9BpU,KAAKxB,KAAK2c,OAAOwB,GACjB3c,KAAK0c,UAAYzb,I,oCAhCD,OAAOjB,KAAK4c,Y,iBAmChB3b,GACZjB,KAAKxB,KAAKP,UAAYgD,EACtBjB,KAAK4c,WAAa3b,M,uCA1EnBC,K,4GACAA,K,qFAAgBY,EAAe2U,K,8CAC/BvV,K,qFAAgBY,EAAeiW,K,kDAC/B7W,K,qFAAoBY,EAAe+a,S,qDACnC3b,K,qFAAuBY,EAAegb,Y,sDACtC5b,K,qFAAwBY,EAAeib,c,qDACvC7b,K,oFAAuB,CACtBgB,EAAGhB,YAAW,IACdiB,EAAGjB,YAAW,IACdiT,MAAOjT,YAAW,IAClBkT,SAAUlT,YAAW,Q,mDAmEtBH,K,kIAKAA,K,wIAKAA,K,+EAiIYe,O,qxCChPTkb,E,sWACJC,SAAW,SAACre,GACVA,EAAM0S,iBACW,EAAKpK,MAAdxF,KACHqK,IAAInN,EAAMwM,OAAO8R,YAAY1N,gB,mRAJTvI,gB,2JAOlB,IACC5D,EAAYrD,KAAKkH,MAAMxF,KAAvB2B,QACR,OACE,kBAAC,IAAD,CAAMmS,oBAAoB,kBAAkB2H,aAAa,gCACvD,kBAAC,IAAD,CAAU7U,QAAQ,OAAO8U,WAAW,SAASnD,aAAa,UACxD,qCACEzQ,KAAK,SACLnB,MAAO,CAAEK,OAAQ,OACjBmJ,QAAS7R,KAAKid,UACG,UAAZ5Z,EAAsB,CAAEyO,QAAS,QAAW,IAJnD,UASF,kBAAC,IAAD,CAAUxJ,QAAQ,OAAO8U,WAAW,SAASnD,aAAa,UACxD,qCACEzQ,KAAK,SACLnB,MAAO,CAAEK,OAAQ,OACjBmJ,QAAS7R,KAAKid,UACG,YAAZ5Z,EAAwB,CAAEyO,QAAS,QAAW,IAJrD,YASF,kBAAC,IAAD,CAAUxJ,QAAQ,OAAO8U,WAAW,SAASnD,aAAa,UACxD,qCACEzQ,KAAK,SACLnB,MAAO,CAAEK,OAAQ,OACjBmJ,QAAS7R,KAAKid,UACG,SAAZ5Z,EAAqB,CAAEyO,QAAS,QAAW,IAJlD,SASF,kBAAC,IAAD,CAAUxJ,QAAQ,OAAO8U,WAAW,SAASnD,aAAa,UACxD,qCACEzQ,KAAK,SACLnB,MAAO,CAAEK,OAAQ,OACjBmJ,QAAS7R,KAAKid,UACG,WAAZ5Z,EAAuB,CAAEyO,QAAS,QAAW,IAJpD,gB,kBAcKkL,O,miCC0JAK,E,WAlNb,sBAAYC,EAAWC,EAAgBC,EAAeC,GAAQ,Y,4GAAA,yBAU9DC,UAAY,SAACxgB,GACX,IAAMC,EAAUC,SAASC,eAAeH,GACxC,EAAKC,QAAUA,EACf,EAAKG,MAAMC,MAAMJ,IAb2C,KAoL9DwgB,aAAe,kBACb,EAAKC,uBAAuB,EAAKL,eAAenE,UAAUnX,WArLE,KAwL9D4b,YAAc,kBACZ,EAAKD,uBAAuB,EAAKJ,cAAcrE,SAASlX,WAxLxDjC,KAAKsd,UAAYA,EACjBtd,KAAKud,eAAiBA,EACtBvd,KAAKwd,cAAgBA,EACrBxd,KAAKyd,OAASA,EACdzd,KAAK1C,MAAQ,IAAIA,IAAM4H,WAEvBlF,KAAK7C,aAAUiD,E,kKAUXJ,KAAK1C,MAAMyH,UACb/E,KAAK1C,MAAMyH,QAAQnD,QACnB5B,KAAK1C,MAAMyH,QAAQ5D,Y,kCAIhB,WAELnB,KAAKoO,QAAU,GACfpO,KAAKjC,MAAQiC,KAAKsd,UAA4B,EAAftd,KAAKoO,QAH/B,IAIGrQ,EAAmBiC,KAAnBjC,MAAOqQ,EAAYpO,KAAZoO,QAETvQ,EAAU,CAACuQ,EAASA,GACpB0P,EAAW,CAAC/f,EAAQqQ,EAASA,GAC7B2P,EAAa,CAAC3P,EAASrQ,EAAQqQ,GAE/B4P,EAAUjgB,EAAQ2Q,IAAOuP,KACzB/R,EAASlM,KAAKsd,UAAY,EAGhC,IAAItd,KAAK1C,MAAMK,KAAKC,UAAU,CAC5BC,QAAS,CAAC,EAAG,GACbC,YAAa,CAACkC,KAAKsd,UAAWtd,KAAKsd,WACnCrf,UAAW,uBAab,IATA,IAAMigB,EAAW,IAAIle,KAAK1C,MAAM6gB,iBAC9B,IAAIne,KAAK1C,MAAMK,KAAKygB,KAAK,CACvBC,KAAM,CAAC,EAAG,GACVC,GAAI,CAAC,EAAGte,KAAKsd,WAEbiB,YAAa,qBACbC,YAAa,KAGRlP,EAAI,EAAGA,GAAKZ,IAAOuP,KAAM3O,GAAK,EAAG,CACxC,IAAMmP,EAASrQ,EAAU,EAAK4P,EAAU1O,EACxC4O,EAASQ,MAAM,IAAI1e,KAAK1C,MAAMqhB,MAAMF,EAAQvS,IAC5BgS,EAASQ,MAAM,IAAI1e,KAAK1C,MAAMqhB,MAAMzS,EAAQuS,IACpDtD,OAAO,IAIjBnb,KAAK0Z,MAAQ,IAAI1Z,KAAK1C,MAAMK,KAAKygB,KAAK,CAEpCG,YAAa,oBACbC,YAAa,EACbH,KAAM,IAAIre,KAAK1C,MAAMqhB,MAAMZ,GAC3BO,GAAI,IAAIte,KAAK1C,MAAMqhB,MAAMb,KAE3B9d,KAAK4e,wBAGL,IAAMC,EAAc,CAElBN,YAAa,oBACbC,YAAa,GAETM,EAAqB,IAAI9e,KAAK1C,MAAMK,KAAKygB,KAApB,iBACtBS,EADsB,CAEzBR,KAAMN,EACNO,GAAIte,KAAK2d,kBAELoB,EAAoB,IAAI/e,KAAK1C,MAAMK,KAAKygB,KAApB,iBACrBS,EADqB,CAExBR,KAAMre,KAAK6d,cACXS,GAAIR,KAIAkB,EAAgB,IAAIhf,KAAK1C,MAAM6gB,iBACnC,IAAIne,KAAK1C,MAAMK,KAAKsO,OAAO,CACzBxJ,MAAO5E,EACPkE,OAAQ,EAERwc,YAAa,oBACbC,YAAa,EACbvgB,UAAW,IAAI+B,KAAK1C,MAAM2hB,MAAM,EAAG,QAGjCC,EAAmB,IAAIlf,KAAK1C,MAAM6gB,iBACtC,IAAIne,KAAK1C,MAAMK,KAAKC,UAAU,CAC5B6E,MAAO,CAAC,IAAK,KACbC,KAAM,CAAC,GAAI,IAEXzE,UAAW,uBAGfihB,EAAiBR,MAAMX,GACvBmB,EAAiBR,MAAMZ,GACvB,IAAMH,EAAeqB,EAAcN,MAAM1e,KAAK2d,gBACxCE,EAAcmB,EAAcN,MAAM1e,KAAK6d,eAG7CF,EAAawB,aAAe,WAC1B,EAAKhiB,QAAQkL,MAAM+W,OAAS,WAE9BzB,EAAa0B,aAAe,WAC1B,EAAKliB,QAAQkL,MAAM+W,OAAS,WAE9BzB,EAAa2B,YAAc,SAAC1gB,GAC1B,EAAKzB,QAAQkL,MAAM+W,OAAS,UAC5B,IAAMG,EAAY3gB,EAAM6D,MAAM+c,SAAS7B,EAAa1b,UAE9Cwd,EAAU9c,KAAKsU,IAAIsI,EAAUrd,IAAO8b,EAAU,EAC9C0B,EAAU/c,KAAKsU,IAAIsI,EAAUpd,IAAO6b,EAAU,EACpD,GAAIyB,GAAWC,EAAS,CACtB,IAAMC,EAAQhd,KAAKwU,KAAKoI,EAAUrd,GAC5B0d,EAAQjd,KAAKwU,KAAKoI,EAAUpd,GAC5B0d,EAAclC,EAAa1b,SAAS6K,IAAI,CAC5C5K,EAAGyd,EAAQ3B,EAAUyB,EACrBtd,EAAGyd,EAAQ5B,EAAU0B,IAGvB/B,EAAa1b,SAAW4d,EACxBf,EAAmBgB,YAAYrd,MAAQod,EACvC,EAAKpC,OAAO,MAAO,CACjB9O,UAAWgR,EAAQjR,IAAOuP,KAAOwB,EACjC7Q,UAAW,EAAIgR,EAAQlR,IAAOuP,KAAOyB,IAEvC,EAAKd,0BAGTjB,EAAaoC,UAAY,WACvB,EAAK5iB,QAAQkL,MAAM+W,OAAS,WAG9BvB,EAAYsB,aAAe,WACzB,EAAKhiB,QAAQkL,MAAM+W,OAAS,WAE9BvB,EAAYwB,aAAe,WACzB,EAAKliB,QAAQkL,MAAM+W,OAAS,WAE9BvB,EAAYyB,YAAc,SAAC1gB,GACzB,EAAKzB,QAAQkL,MAAM+W,OAAS,UAC5B,IAAMG,EAAY3gB,EAAM6D,MAAM+c,SAAS3B,EAAY5b,UAE7Cwd,EAAU9c,KAAKsU,IAAIsI,EAAUrd,IAAO8b,EAAU,EAC9C0B,EAAU/c,KAAKsU,IAAIsI,EAAUpd,IAAO6b,EAAU,EACpD,GAAIyB,GAAWC,EAAS,CACtB,IAAMC,EAAQhd,KAAKwU,KAAKoI,EAAUrd,GAC5B0d,EAAQjd,KAAKwU,KAAKoI,EAAUpd,GAC5B0d,EAAchC,EAAY5b,SAAS6K,IAAI,CAC3C5K,EAAGyd,EAAQ3B,EAAUyB,EACrBtd,EAAGyd,EAAQ5B,EAAU0B,IAGvB7B,EAAY5b,SAAW4d,EACvBd,EAAkBiB,aAAavd,MAAQod,EACvC,EAAKpC,OAAO,KAAM,CAChB9O,WAAY,EAAIgR,EAAQjR,IAAOuP,KAAOwB,EACtC7Q,SAAUgR,EAAQlR,IAAOuP,KAAOyB,IAElC,EAAKd,0BAGTf,EAAYkC,UAAY,WACtB,EAAK5iB,QAAQkL,MAAM+W,OAAS,a,oEAaTa,GACrB,MAAQ,CACNA,EAAe/d,EAAIlC,KAAKjC,MAAQiC,KAAKoO,QAErCpO,KAAKjC,MAASkiB,EAAe9d,EAAInC,KAAKjC,MAASiC,KAAKoO,W,oEAKlDpO,KAAK0Z,QACP1Z,KAAK0Z,MAAMsG,aAAa5G,UAAY,IAAIpZ,KAAK1C,MAAMqhB,MACjD3e,KAAKud,eAAenE,UAAUzK,UAAY3O,KAAKjC,MAAQ2Q,IAAOK,KAC7D,EAAI/O,KAAKud,eAAenE,UAAUxK,SAAW5O,KAAKjC,MAAQ2Q,IAAOK,KAEpE/O,KAAK0Z,MAAMoG,YAAY3G,SAAW,IAAInZ,KAAK1C,MAAMqhB,OAC9C,EAAI3e,KAAKwd,cAAcrE,SAASxK,UAAY3O,KAAKjC,MAAQ2Q,IAAOK,IACjE/O,KAAKwd,cAAcrE,SAASvK,SAAW5O,KAAKjC,MAAQ2Q,IAAOK,U,mgCC/IpDsO,EA3DdrW,Y,8WAECmF,MAAQ,G,EAER+T,kB,IASAC,oBAAsB,WACpB,EAAKC,2B,EAGPA,wBAA0B,WAAM,MAC2B,EAAKlZ,MAAtDnJ,EADsB,EACtBA,MAAOwf,EADe,EACfA,eAAgBC,EADD,EACCA,cAAeC,EADhB,EACgBA,OAE1CF,GAAkBC,IACpB,EAAK0C,aAAe,IAAIG,EAAqBtiB,EAAOwf,EAAgBC,EAAeC,GACnF,EAAKyC,aAAaxC,UAAU,iBAC5B,EAAKwC,aAAaI,S,iRAtBGC,IAAMtZ,W,mNAKZgH,QACa7N,IAA1B6N,EAAUuS,aAA6BvS,EAAUuS,cAAgBxgB,KAAKkH,MAAMsZ,cAC1ExgB,KAAKkgB,cAAclgB,KAAKkgB,aAAaO,UACzCzgB,KAAKogB,6B,sCAkBA,MACuDpgB,KAAKkH,MAA3DnJ,EADD,EACCA,MAAOyiB,EADR,EACQA,YAAajD,EADrB,EACqBA,eAAgBC,EADrC,EACqCA,cAE5C,YAAoBpd,IAAhBogB,EAEA,wBAAInY,MAAO,CAAE+F,QAAS,OAAQlQ,MAAO,aAArC,sCAMAqf,IAAmBC,EAEnB,wBAAInV,MAAO,CAAE+F,QAAS,OAAQlQ,MAAO,aACnC,mFAMJ,yBAAKmK,MAAO,CAAE+F,QAAS,SACrB,kBAACrR,EAAA,EAAD,CACEG,GAAG,gBACHa,MAAOA,EACPC,OAAQD,EACRgL,QAAS/I,KAAKmgB,2B,isDC6NTO,EAlRd1Z,Y,kZAECmF,MAAQ,CACNwU,+BAA2BvgB,G,EAG7B9C,MAAQ,IAAIA,IAAM4H,W,EAClB/H,a,IAwBAyjB,sBAAwB,WACtB,EAAKC,6B,EAGPC,oBAAsB,SAACliB,GACrBA,EAAMC,kBADyB,IAEvBC,EAAkBF,EAAlBE,cAEAiiB,EAAa,EAAK7Z,MAAlB6Z,SACAJ,EAA8B,EAAKxU,MAAnCwU,0BAEJA,IACFA,EAA0BnC,YAAc,EACxCmC,EAA0BK,YAAYC,MAAQ,GAEhDniB,EAAc0f,YAAc,EAC5B1f,EAAckiB,YAAYC,MAAQ,GAClCF,EAASjiB,EAAc+C,MACvB,EAAK2L,SAAS,CAAEmT,0BAA2B7hB,K,EAG7CoiB,YAAc,SAACtiB,GAAU,IACfgC,EAAQhC,EAARgC,IADe,EAE2B,EAAKsG,MAA/C1I,EAFe,EAEfA,KAAMgiB,EAFS,EAETA,YAAa/c,EAFJ,EAEIA,SAAUsd,EAFd,EAEcA,SACrC,GAAY,cAARngB,GAA+B,WAARA,EAAkB,CAC3ChC,EAAM0S,iBAEN,IAAMrE,EAAeuT,EAAY3a,MAAM,KAAK,GAC5Ckb,OAAS3gB,GACT5B,EAAK2iB,UAAUlU,EAAcxJ,EAAShE,OACtC,EAAK2hB,Y,EAITP,0BAA4B,WAAM,IACxBriB,EAAS,EAAK0I,MAAd1I,KACR,EAAKrB,QAAUC,SAASC,eAAe,mBACvC,EAAKC,MAAMC,MAAM,EAAKJ,SAHU,MAKsC,EAAKkkB,eAAnEC,EALwB,EAKxBA,gBAAiBC,EALO,EAKPA,cAAeC,EALR,EAKQA,YAAaC,EALrB,EAKqBA,aACjDC,EAAiB,EAEbC,EAAiB,EAAKC,gBAAtBD,aACFE,EAAmB,GAEzB1iB,OAAOsB,QAAQjC,EAAKwF,WAAW1E,QAAQ,YAAkB,0BAAhB4b,EAAgB,KAAV4G,EAAU,KACnDC,EAAW7G,EACT8G,EAAUN,EAAiBJ,EAAkBA,EAEnD,GAAa,MAATpG,EAAJ,CACa,MAATA,IACF6G,EAAW,YAIb,IAAI,EAAKzkB,MAAM2kB,UAAU,CACvBxf,MAAO,CAAC,EAAGuf,GACXpO,QAASmO,EACT9jB,UAAW,QACXikB,SAAU,KAEZ,IAAMC,EAAgB,IAAI,EAAK7kB,MAAMK,KAAKygB,KAAK,CAC7Cvc,KAAM,gBACNwc,KAAM,CAACkD,EAAgB,EAAGS,EAAU,GACpC1D,GAAI,CAACkD,EAAaQ,EAAU,GAC5BzD,YAAa,yBACbC,YAAa,KAET4D,EAAW,IAAI,EAAK9kB,MAAMK,KAAKygB,KAAK,CACxCC,KAAM,CAACkD,EAAgB,EAAGS,EAAU,GACpC1D,GAAI,CAACkD,EAAaQ,EAAU,GAC5BzD,YAAa,YACbC,YAAa,IAGT6D,EAAkB,IAAI,EAAK/kB,MAAMK,KAAKC,UAAU,CACpDiE,KAAM,kBACNY,MAAO,CAAC,EAAGuf,EAAU,IACrBtf,KAAM,CAAC,GAAI,IACXX,OAAQ,EACR9D,UAAW,0BACXmW,SAAU,GACVkO,SAAS,IAELC,EAAkB,IAAI,EAAKjlB,MAAM2kB,UAAU,CAC/Cxf,MAAO,CAAC,EAAGuf,EAAU,GACrBpO,QAAS,IACT3V,UAAW,0BACXikB,SAAU,GACVI,SAAS,IAGXT,EAAiB/V,KAAK,CAACqW,EAAeE,EAAiBE,IAGvD,IAAMC,EAAyB,SAAzBA,uBAA0B5jB,GAC9ByjB,EAAgBC,SAAU,EAC1BC,EAAgBD,SAAU,EAC1BD,EAAgBpgB,SAASC,EAAItD,EAAM6D,MAAMP,EACzCqgB,EAAgBtgB,SAASC,EAAItD,EAAM6D,MAAMP,EAAI,IAEzCugB,EAAkB,SAAlBA,kBACJJ,EAAgBC,SAAU,EAC1BC,EAAgBD,SAAU,GAEtBI,EAAc,SAAdA,YAAe9jB,GACnB,IAAMa,EAAQkD,KAAK2K,OAAO1O,EAAM6D,MAAMP,EAAIqf,GAAiBE,GAC3DjjB,EAAK0V,OAAOgH,EAAMzb,GAElB,EAAK2hB,WAGPe,EAAcQ,YAAcH,EAC5BL,EAAc9C,aAAeoD,EAC7BL,EAASO,YAAcH,EACvBJ,EAAS/C,aAAeoD,EAExBJ,EAAgBM,YAAc,SAAC/jB,GACzBujB,EAAcS,QAAQhkB,EAAM6D,MAAO,CAAEogB,QAAQ,EAAMC,UAAU,IAC/DN,EAAuB5jB,GAEvB6jB,KAIJN,EAActQ,QAAU6Q,EACxBN,EAASvQ,QAAU6Q,EACnBL,EAAgBxQ,QAAU6Q,EAG1BZ,EAAKxiB,QAAQ,SAACmE,EAAUsf,GACtB,IAAMC,EAAe,IAAI,EAAK1lB,MAAMK,KAAKC,UAAU,CACjDiE,KAAM,GAAF,OAAKrD,EAAKoC,IAAV,YAAiBsa,EAAjB,YAAyB6H,GAC7BtgB,MAAO,CAAC8e,EAAgB9d,EAAShE,MAAQgiB,EAAe,EAAGO,EAAU,IACrEtf,KAAM,CAAC,GAAI,IACXX,OAAQ,EACR9D,UAAW,oBACXmW,SAAU,GACVmK,YAAa,QACbC,YAAa,EACbwC,YAAa,mBACbiC,WAAY,IAGdD,EAAavkB,GAAG,YAAa,EAAKqiB,qBAClCkC,EAAa7D,aAAe,WAC1B,EAAKhiB,QAAQkL,MAAM+W,OAAS,UAC5BqD,KAEFO,EAAa3D,aAAe,WAC1B,EAAKliB,QAAQkL,MAAM+W,OAAS,aAIhCsC,GAAkB,KAGpBC,EAAagB,YAAc,SAAC/jB,GAC1BijB,EAAiBviB,QAAQ,YAInB,0BAHJ6iB,EAGI,KAFJE,EAEI,KADJE,EACI,KACAJ,EAAcS,QAAQhkB,EAAM6D,QAE9B4f,EAAgBC,SAAU,EAC1BC,EAAgBD,SAAU,EAC1BD,EAAgBpgB,SAASC,EAAItD,EAAM6D,MAAMP,EACzCqgB,EAAgBtgB,SAASC,EAAItD,EAAM6D,MAAMP,EAAI,KAE7CmgB,EAAgBC,SAAU,EAC1BC,EAAgBD,SAAU,MAIhCX,EAAauB,gB,+SA7MY3C,IAAMtZ,W,2NAS/B7J,SAAS+lB,iBAAiB,QAASnjB,KAAKkhB,e,4DAGvBjT,QAEI7N,IAAnB6N,EAAUzP,WACU4B,IAApBJ,KAAKkH,MAAM1I,MACXyP,EAAUzP,KAAKoC,MAAQZ,KAAKkH,MAAM1I,KAAKoC,KAEvCZ,KAAKohB,UAGHnT,EAAUtO,MAAQK,KAAKkH,MAAMvH,KAC/BK,KAAK4hB,kB,kEAKPxkB,SAASgmB,oBAAoB,QAASpjB,KAAKkhB,e,wCAsL3ClhB,KAAK1C,MAAMyH,QAAQnD,QACnB5B,KAAK1C,MAAMyH,QAAQ5D,SACnBnB,KAAK6gB,8B,oDAGS,MACQ7gB,KAAKkH,MAAnBxE,EADM,EACNA,KAAM/C,EADA,EACAA,IADA,EAE0BK,KAAKqhB,eAArCE,EAFM,EAENA,cAAeE,EAFT,EAESA,aAcvB,MAAO,CAAEE,aAbY,IAAI3hB,KAAK1C,MAAMK,KAAKygB,KAAK,CAC5CC,KAAM,CAACkD,EAAgB5hB,EAAM8hB,EAAc,IAC3CnD,GAAI,CAACiD,EAAgB5hB,EAAM8hB,EAAc/e,EAAK1E,OAAS,IACvDugB,YAAa,QACbC,YAAa,IASQ6E,iBAPE,IAAIrjB,KAAK1C,MAAMK,KAAK2lB,eAAe,CAC1DpX,OAAQ,CAACqV,EAAgB5hB,EAAM8hB,EAAc,IAC7C8B,MAAO,EACPxhB,OAAQ,EACRqS,SAAU,IACVnW,UAAW,a,kDAKA,MACY+B,KAAKkH,MAAtBxE,EADK,EACLA,KAAMsG,EADD,EACCA,OAGRwY,EAAc9e,EAAK3E,MAFD,GAGlBylB,EAAgBhC,EAFA,GAItB,MAAO,CACLF,gBANsB,GAOtBC,cANoB,GAOpBC,cACAgC,gBACA/B,aANmB+B,EAAgBxa,K,sCAU9B,MACgBhJ,KAAKkH,MAApBxE,EADD,EACCA,KAAMlE,EADP,EACOA,KAEd,YAAa4B,IAATsC,QAA+BtC,IAAT5B,EAEtB,wBAAI6J,MAAO,CAAE+F,QAAS,OAAQlQ,MAAO,SAArC,yCAOF,yBAAKmK,MAAO,CAAE+F,QAAS,SACrB,kBAACrR,EAAA,EAAD,CACEG,GAAG,kBACHa,MAAO2E,EAAK3E,MACZC,OAAQ0E,EAAK1E,OACb+K,QAAS/I,KAAK4gB,6B,mvDCpQlB6C,EADLzc,Y,gYAECmF,MAAQ,CACNuX,aAAStjB,EACTujB,YAAQvjB,EACRwjB,qBAAiBxjB,G,EAGnBiV,qB,IAkDAxM,QAAU,WAAM,IACN7D,EAAW,EAAKkC,MAAMP,MAAtB3B,OACRA,EAAOzF,QACPyB,WAAW,WACTgE,EAAOuM,aAAQnR,GACf4E,EAAOuM,QAAQ,WACd,K,EAGLsS,qBAAuB,SAACC,EAAD,GAAyC,IAA1BnV,EAA0B,EAA1BA,UAAWC,EAAe,EAAfA,SAAe,EACpC,EAAK1H,MAAMP,MAA7B1B,EADsD,EACtDA,MAAOD,EAD+C,EAC/CA,OACf,GAAKC,EAAMzB,iBAAX,CAEA,IAAMugB,EAAe7U,YAAU4U,GAJ+B,4BAK5B7e,EAAMzB,iBAAiBqC,MAAM,KALD,GAKvDme,EALuD,KAKhDC,EALgD,KAKzCC,EALyC,KAM1DC,EAASlc,SAASic,GACH,OAAfJ,IACFK,GAAU,GAGZ,IACIC,EADEC,EAAerf,EAAO3F,YAAY2kB,GAAOhgB,UAAUigB,GAAOE,GAA3C,gBAA4DJ,IAEnE,MAAVE,IACFG,EAAiBpf,EAAO3F,YAAY2kB,GAAOhgB,UAAU7B,EAAEgiB,GAAtC,gBAAuDJ,KAG1EM,EAAa1V,WAAaA,EAC1B0V,EAAazV,UAAYA,EAErBwV,IACFA,EAAezV,WAAaA,EAC5ByV,EAAexV,UAAYA,K,sSAxFP3H,gB,+MASJ,WACVjC,EAAWhF,KAAKkH,MAAMP,MAAtB3B,OACFqI,EAAYjQ,SAASC,eAAe,kBAC1C2D,WAAW,WACT,IAAMjD,EAAQ4E,KAAK2K,MAAMD,EAAUE,aAAe,GAC5CvP,EAAS2E,KAAK2K,MAAO,EAAI,GAAMvP,GACrCiH,EAAOxE,QAAQzC,EAAOC,IACrB,GAEH,IAAMsmB,EAAalnB,SAASC,eAAe,oBAC3C2D,WAAW,WACT,IAAMjD,EAAQ4E,KAAK2K,MAAMgX,EAAW/W,aAAe,GAC7CvP,EAAS2E,KAAK2K,MAAMgX,EAAWC,cAAgB,GAC/CC,EAAiB7hB,KAAK8hB,IAAI1mB,EAAOC,GACvC,EAAKwP,SAAS,CAAEkW,QAASc,KACxB,GAEH,IAAME,EAAatnB,SAASC,eAAe,sBAC3C2D,WAAW,WACT,IAAMjD,EAAQ4E,KAAK2K,MAAMoX,EAAWnX,aAAe,GAC7CvP,EAAS2E,KAAK2K,MAAMoX,EAAWH,cAAgB,GACrD,EAAK/W,SAAS,CAAEmW,OAAQ,CAAE5lB,QAAOC,aAChC,GAEHgC,KAAKqV,gBAAkB/O,YAAQ,WACzBtB,EAAOzE,SACT,EAAKiN,SAAS,CAAEoW,gBAAiB5e,EAAOzE,SAASK,MAEjD,EAAK4M,SAAS,CAAEoW,qBAAiBxjB,Q,4DAKpB6N,EAAWH,GAAW,IAC/B7I,EAAUjF,KAAKkH,MAAMP,MAArB1B,MACJ6I,EAAU8V,kBAAoB5jB,KAAKmM,MAAMyX,iBAC3C3e,EAAM0f,oBAAevkB,K,kEAIF,MACcJ,KAAKkH,MAAMP,MAAtC3B,EADa,EACbA,OAAQD,EADK,EACLA,QAASE,EADJ,EACIA,MACzBD,EAAOlF,YACPiF,EAAQnD,QACRqD,EAAM0f,oBAAevkB,GACrBJ,KAAKqV,oB,sCAsCE,IAIHkI,EACAC,EALG,EAC8Bxd,KAAKkH,MAAMP,MAAxC3B,EADD,EACCA,OAAQ5G,EADT,EACSA,UAAW6G,EADpB,EACoBA,MADpB,EAEqBjF,KAAKmM,MAAzBuX,EAFD,EAECA,QAASC,EAFV,EAEUA,OAIjB,GAAI1e,EAAMzB,iBAAkB,iCACQyB,EAAMzB,iBAAiBqC,MAAM,KADrC,GACnBme,EADmB,KACZC,EADY,KACLC,EADK,KAEpBC,EAASlc,SAASic,GAClBU,EAAkB5f,EAAO3F,YAAY2kB,GAAOhgB,UAAUigB,GAC5D1G,EAAiBqH,EAAgBT,GAC7BA,EAAS,EAAIS,EAAgB1e,SAC/BsX,EAAgBoH,EAAgBT,EAAS,IAI7C,OACE,kBAAClT,EAAA,EAAD,CACE7J,iBAAiB,aACjBoO,oBAAoB,cAEpB,kBAAChH,EAAA,EAAD,CAAUtR,GAAG,iBAAiBkR,QAAQ,OAAOqH,SAAS,iBACpD,kBAAC9M,EAAA,EAAD,CAAQ3D,OAAQA,EAAQ5G,UAAWA,EAAWyK,QAAS7I,KAAK6I,WAE9D,kBAAC2F,EAAA,EAAD,CAAUtR,GAAG,mBAAmBuY,SAAS,gBAAgBjN,gBAAgB,sBACvE,kBAAC,EAAD,CACEzK,MAAO2lB,EACPlD,YAAavb,EAAMzB,iBACnB+Z,eAAgBA,EAChBC,cAAeA,EACfC,OAAQzd,KAAK6jB,wBAGjB,kBAACrV,EAAA,EAAD,CAAUtR,GAAG,qBAAqBuY,SAAS,gBAAgBjN,gBAAgB,sBACzE,kBAAC,EAAD,CACE9F,KAAMihB,EACNnlB,KAAMwG,EAAOzE,SACbigB,YAAavb,EAAMzB,iBACnBC,SAAU8Z,EACVwD,SAAU9b,EAAM0f,eAChB3b,OAAQ5K,EAAU4K,OAClBrJ,IAAKvB,EAAUuB,Y,mBAQZ8jB,O,olCCrEAoB,EA/Ed7d,Y,wWAUCwL,cAAgB,SAAC5T,GAAU,MASrB,EAAKsI,MAAM9I,UAPboO,EAFuB,EAEvBA,KACAgE,EAHuB,EAGvBA,MACAsU,EAJuB,EAIvBA,SACAC,EALuB,EAKvBA,SACAC,EANuB,EAMvBA,UACAC,EAPuB,EAOvBA,SACA/U,EARuB,EAQvBA,QAEMtP,EAAkBhC,EAAlBgC,IAAK6R,EAAa7T,EAAb6T,SAED,cAAR7R,GAAuB6R,EACzBuS,IACiB,cAARpkB,EACTmkB,IACiB,eAARnkB,GAAwB6R,EACjCwS,IACiB,eAARrkB,EACTkkB,IACiB,MAARlkB,IACThC,EAAMC,kBACND,EAAM0S,kBACU,IAAZpB,EACFM,IAEAhE,M,mRAnCqBvF,gB,iLAEzB7J,SAAS+lB,iBAAiB,UAAWnjB,KAAKwS,eAAe,K,kEAIzDpV,SAASgmB,oBAAoB,UAAWpjB,KAAKwS,eAAe,K,sCAkCrD,MASHxS,KAAKkH,MAAM9I,UAPboO,EAFK,EAELA,KACAgE,EAHK,EAGLA,MACAsU,EAJK,EAILA,SACAC,EALK,EAKLA,SACAC,EANK,EAMLA,UACAC,EAPK,EAOLA,SACA/U,EARK,EAQLA,QAGF,OACE,kBAACe,EAAA,EAAD,CAAMuE,oBAAoB,8BAA8BxX,OAAO,OAAOof,WAAW,SAASnD,aAAa,SAASiL,UAAU,gCACxH,kBAAC1W,EAAA,EAAD,CAAU2W,gBAAgB,KACxB,4BAAQ3b,KAAK,SAASnB,MAAO,CAAEK,OAAQ,GAAKmJ,QAASmT,GAArD,MAEF,kBAACxW,EAAA,EAAD,CAAU2W,gBAAgB,KACxB,4BAAQ3b,KAAK,SAASnB,MAAO,CAAEK,OAAQ,GAAKmJ,QAASkT,GAArD,MAEF,kBAACvW,EAAA,EAAD,CAAU2W,gBAAgB,MACV,IAAZjV,EACA,4BAAQ1G,KAAK,SAASnB,MAAO,CAAEK,OAAQ,GAAKmJ,QAASrF,GAArD,KACA,4BAAQhD,KAAK,SAASnB,MAAO,CAAEK,OAAQ,GAAKmJ,QAASrB,GAArD,QAGJ,kBAAChC,EAAA,EAAD,CAAU2W,gBAAgB,KACxB,4BAAQ3b,KAAK,SAASnB,MAAO,CAAEK,OAAQ,GAAKmJ,QAASiT,GACnD,yBAAKzc,MAAO,CAAE0J,UAAW,mBAAzB,OAGJ,kBAACvD,EAAA,EAAD,CAAU2W,gBAAgB,KACxB,4BAAQ3b,KAAK,SAASnB,MAAO,CAAEK,OAAQ,GAAKmJ,QAASoT,GAArD,W,sBC5EO,SAAXG,KAAW,OACf1f,OAAO2f,YACFjoB,SAASkoB,gBAAgB/X,aACzBnQ,SAAS+M,KAAKoD,YAHrB,I,ujCCQMgY,EADLve,Y,8WAcC6B,QAAU,WACW,EAAK3B,MAAMP,MAAtB3B,OACDzF,S,6RAfY0H,gB,mMACD,IACVjC,EAAWhF,KAAKkH,MAAMP,MAAtB3B,OACFjH,EAAQqnB,KAAa,GACrBpnB,EAAS2E,KAAK2K,MAAO,EAAI,GAAMvP,GACrCiH,EAAOxE,QAAQzC,EAAOC,K,kEAIFgC,KAAKkH,MAAMP,MAAvB5B,QACAnD,U,sCAQD,MACuB5B,KAAKkH,MAAMP,MAAjC3B,EADD,EACCA,OAAQ5G,EADT,EACSA,UAChB,OACE,kBAAC6S,EAAA,EAAD,CACE7J,iBAAiB,YACjBgW,WAAW,UAEX,kBAAC5O,EAAA,EAAD,CAAUJ,QAAQ,QAChB,kBAACzF,EAAA,EAAD,CAAQ3D,OAAQA,EAAQ5G,UAAWA,EAAWyK,QAAS7I,KAAK6I,WAE9D,kBAAC,EAAD,CAAgBzK,UAAWA,S,gBAMpBmnB,O,qBC5Cf,IAAIzhB,EAAM,CACT,iBAAkB,QAInB,SAAS0hB,eAAeC,GACvB,IAAIvoB,EAAKwoB,sBAAsBD,GAC/B,OAAOE,EAAoBzoB,GAE5B,SAASwoB,sBAAsBD,GAC9B,GAAIE,EAAoBC,EAAE9hB,EAAK2hB,GAK/B,OAAO3hB,EAAI2hB,GAJV,IAAIxf,EAAI,IAAIqS,MAAM,uBAAyBmN,EAAM,KAEjD,MADAxf,EAAE4f,KAAO,mBACH5f,EAIRuf,eAAezhB,KAAO,SAAS+hB,qBAC9B,OAAO3mB,OAAO4E,KAAKD,IAEpB0hB,eAAeO,QAAUL,uBACzBpe,EAAO6S,QAAUqL,gBACFtoB,GAAK,S","file":"app.0f382607.js","sourcesContent":["import { observable, action } from 'mobx'\n\nclass Canvas {\n  @observable width\n  @observable height\n  @observable _color\n  @observable background\n  @observable animatables\n  @observable tool\n  @observable selected\n\n  constructor(rootStore) {\n    this.rootStore = rootStore\n    this.paper = rootStore.paper\n    this.initialize()\n  }\n\n  initialize() {\n    let prevWidth\n    let prevHeight\n    if (this.width !== undefined) {\n      prevWidth = this.width\n      prevHeight = this.height\n    }\n\n    this.width = undefined\n    this.height = undefined\n    this._color = '#000000'\n    this.animatables = {}\n    this.tool = undefined\n    this.selected = undefined\n\n    if (prevWidth !== undefined) {\n      this.setSize(prevWidth, prevHeight)\n    }\n  }\n\n  toJSON() {\n    return ({\n      color: this.color,\n      animatables: Object.entries(this.animatables).reduce((output, [key, animatable]) => {\n        output[key] = animatable.toJSON() // eslint-disable-line\n        return output\n      }, {}),\n    })\n  }\n\n  setSize(width, height) {\n    // allows the canvas element one tick to recognize size changes\n    const setSizeAction = action(() => {\n      this.height = height\n      this.width = width\n    })\n    setTimeout(setSizeAction, 1)\n  }\n\n  attatchAndSetup = (id) => {\n    const element = document.getElementById(id)\n    this.paper.setup(element)\n    this.paper.view.autoUpdate = false\n    this.background = new this.paper.Path.Rectangle({\n      topLeft: [0, 0],\n      bottomRight: [this.paper.view.element.width, this.paper.view.element.height],\n      fillColor: this.color,\n    })\n    this.draw(this.rootStore.animation.firstFrame)\n  }\n\n  get color() { return this._color }\n  set color(value) {\n    this._color = value\n    this.background.fillColor = value\n  }\n\n  @action add = (animatable) => {\n    animatable.create(this)\n    this.animatables = {\n      ...this.animatables,\n      [animatable.key]: animatable,\n    }\n\n    if (this.tool === 'SELECT') {\n      this.addListenersAndSelect(animatable)\n    }\n\n    this.draw()\n  }\n\n  @action remove = (animatable) => {\n    animatable.item.off('mousedown', this.handleItemMouseDown)\n    animatable.item.remove()\n\n    const clone = { ...this.animatables }\n    delete clone[animatable.key]\n    this.animatables = clone\n    this.draw()\n  }\n\n  @action setTool = (nextTool) => {\n    const prevTool = this.tool\n\n    const entering = toolId => (prevTool !== toolId && nextTool === toolId)\n    const exiting = toolId => (prevTool === toolId && nextTool !== toolId)\n\n    if (entering('SELECT')) { this.selectOn() }\n    if (exiting('SELECT')) { this.selectOff() }\n\n    if (entering('SETTINGS')) { this.rootStore.mode.settings = true }\n    if (exiting('SETTINGS')) { this.rootStore.mode.settings = false }\n\n    if (entering('CLEAR')) { this.rootStore.mode.clear = true }\n    if (exiting('CLEAR')) { this.rootStore.mode.clear = false }\n\n    // Finally, set the tool in-memory\n    this.tool = nextTool\n  }\n\n  @action select = (item) => {\n    this.deselect()\n    item.selected = true // eslint-disable-line no-param-reassign\n    this.selected = this.animatables[item.name]\n    this.paper.view.update()\n  }\n\n  @action deselect = () => {\n    if (this.selected) {\n      this.selected.item.selected = false\n      this.selected = undefined\n    }\n    this.paper.view.update()\n  }\n\n  addListenersAndSelect = (animatable) => {\n    animatable.item.on('mousedown', this.handleItemMouseDown)\n    this.select(animatable.item)\n  }\n\n  handleItemMouseDown = (event) => {\n    event.stopPropagation()\n    this.select(event.currentTarget)\n  }\n\n  handleViewMouseDown = (event) => {\n    event.stopPropagation()\n    this.deselect()\n  }\n\n  forEachAnimatable = callback => (\n    Object.values(this.animatables).forEach(callback)\n  )\n\n  build = () => {\n    this.forEachAnimatable((animatable) => { animatable.create(this) })\n    this.draw()\n  }\n\n  draw = (frame) => {\n    const frameToDraw = frame || this.rootStore.animation.now\n    this.forEachAnimatable((animatable) => { animatable.draw(frameToDraw) })\n    if (this.paper.view) this.paper.view.update()\n  }\n\n  selectOn = () => {\n    this.forEachAnimatable((animatable) => {\n      animatable.item.on('mousedown', this.handleItemMouseDown)\n    })\n    this.paper.view.on('mousedown', this.handleViewMouseDown)\n  }\n\n  selectOff = () => {\n    this.forEachAnimatable((animatable) => {\n      animatable.item.off('mousedown', this.handleItemMouseDown)\n    })\n    this.paper.view.off('mousedown', this.handleViewMouseDown)\n    this.deselect()\n  }\n}\n\nexport default Canvas\n","import { observable } from 'mobx'\n\nimport AnimatableItem from '../AnimatableItem'\n\nclass Rectangle extends AnimatableItem {\n  // Canvas Size Relative Values (0-100)\n  static get WIDTH() { return 10 }\n  static get HEIGHT() { return 10 }\n  static get RADIUS() { return 0 }\n\n  @observable _width = Rectangle.WIDTH\n  @observable _height = Rectangle.HEIGHT\n  @observable _radius = Rectangle.RADIUS\n\n  toJSON() {\n    return ({\n      ...super.toJSON(),\n      width: this.width,\n      height: this.height,\n      radius: this.radius,\n    })\n  }\n\n  get width() { return this._width }\n  get height() { return this._height }\n  get radius() { return this._radius }\n\n  set width(value) {\n    // TODO: update this value using item.bounds and scale\n    this._width = value\n    this.recreate()\n  }\n\n  set height(value) {\n    // TODO: update this value using item.bounds and scale\n    this._height = value\n    this.recreate()\n  }\n\n  set radius(value) {\n    // TODO: update this value using item.bounds and scale\n    this._radius = value\n    this.recreate()\n  }\n\n  onCreate(itemProps) {\n    const { x, y } = this.position\n    const absX = this.absolute(x)\n    const absY = this.absolute(y, 'height')\n    const absWidth = this.absolute(this.width)\n    const absHeight = this.absolute(this.height)\n\n    new this.paper.Path.Rectangle({\n      ...itemProps,\n      point: [absX - (absWidth / 2), absY - (absHeight / 2)],\n      size: [absWidth, absHeight],\n      radius: (this.radius / 100) * (Math.max(absWidth, absHeight) / 2),\n    })\n  }\n}\n\nexport default Rectangle\n","import { observable, action } from 'mobx'\n\nclass Mode {\n  @observable current\n  @observable settings\n  @observable clear\n\n  constructor() {\n    this.initialize()\n  }\n\n  initialize() {\n    this.current = 'BUILD'\n    this.settings = false\n    this.clear = false\n  }\n\n  @action set = (m) => {\n    this.current = m\n  }\n}\n\nexport default Mode\n","import { observable, action } from 'mobx'\n\nclass Tools {\n  @observable selectedKeyframe\n\n  constructor() {\n    this.initialize()\n  }\n\n  initialize() {\n    this.selectedKeyframe = undefined\n  }\n\n  @action selectKeyframe = (keyframe) => {\n    this.selectedKeyframe = keyframe\n  }\n}\n\nexport default Tools\n","const observeAnimatableTree = (observableObj) => {\n  const observableKeys = observableObj.constructor.OBSERVABLES\n  return observableKeys.map((key) => {\n    if (key === 'keyframes') {\n      return Object.keys(observableObj.keyframes).map(keyFrType => (\n        observableObj.keyframes[keyFrType].map(observeAnimatableTree)\n      ))\n    }\n\n    const value = observableObj[key]\n    if (value.constructor.OBSERVABLES) {\n      return observeAnimatableTree(value)\n    }\n\n    return value\n  })\n}\n\nexport default observeAnimatableTree\n","import { observable } from 'mobx'\n\nimport * as firebase from 'firebase/app'\nimport 'firebase/database'\n\nclass Gallery {\n  @observable clipsRef\n\n  constructor() {\n    firebase.initializeApp({\n      apiKey: 'AIzaSyCdglP4EAub1kYXJrXag3vaNIxxQgEZTQk',\n      authDomain: 'micro-graph.firebaseapp.com',\n      databaseURL: 'https://micro-graph.firebaseio.com',\n      projectId: 'micro-graph',\n      storageBucket: 'micro-graph.appspot.com',\n      messagingSenderId: '662102370030',\n      appId: '1:662102370030:web:46cfe6a252ed6cc47b75ff',\n    })\n\n    this.clipsRef = firebase.database().ref('clips')\n  }\n}\n\nexport default Gallery\n","import { observable, reaction, autorun } from 'mobx'\nimport paper from 'paper'\n\nimport Project from './prototypes/Project'\nimport Canvas from './prototypes/Canvas'\nimport Animation from './prototypes/Animation'\nimport ModeStore from './prototypes/ModeStore'\nimport ToolsStore from './prototypes/ToolsStore'\nimport GalleryStore from './prototypes/GalleryStore'\n\nimport observeAnimatableTree from './util/observeAnimatableTree'\nimport { storageEnabled } from './util/storage'\n\nclass RootStore {\n  @observable project\n  @observable canvas\n  @observable animation\n  @observable mode\n  @observable tools\n  @observable gallery\n\n  constructor() {\n    this.paper = new paper.PaperScope()\n\n    this.project = new Project(this)\n    this.canvas = new Canvas(this)\n    this.animation = new Animation()\n    this.mode = new ModeStore()\n    this.tools = new ToolsStore()\n    this.gallery = new GalleryStore()\n\n    // Auto Save & Auto Load\n    const { pathname } = window.location\n    const pathArray = pathname.split('/')\n\n    if (\n      storageEnabled() &&\n      (pathArray.length > 1 && pathArray[1] !== 'gallery')\n    ) {\n      const projectObj = localStorage.getItem('micrograph.project')\n      if (projectObj) {\n        setTimeout(() => {\n          this.project.load(projectObj)\n        }, 100)\n      }\n\n      autorun(() => {\n        const projectAsJSON = this.project.save()\n        localStorage.setItem('micrograph.project', projectAsJSON)\n      }, { delay: 300 })\n    }\n\n    // Reacts to all changes made to animatable item properties and redraws the canvas\n    reaction(\n      () => ([\n        this.animation.now,\n        this.canvas.color,\n        Object.values(this.canvas.animatables).map(observeAnimatableTree),\n      ]),\n      () => this.canvas.draw()\n    )\n  }\n\n  reset = () => {\n    this.project.initialize()\n    this.canvas.initialize()\n    this.animation.initialize()\n    this.mode.initialize()\n    this.tools.initialize()\n  }\n}\n\nexport default RootStore\n","const storageEnabled = () => {\n  try {\n    localStorage.setItem('_test', 'test')\n  } catch (e) {\n    return false\n  }\n  return true\n}\n\nconst storageSet = (key, value) => {\n  localStorage.setItem(key, JSON.stringify(value))\n}\n\nconst storageGet = (key) => {\n  const value = localStorage.getItem(key)\n  return value && JSON.parse(value)\n}\n\nexport {\n  storageEnabled,\n  storageSet,\n  storageGet,\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\n\n// Root Application Container\nimport App from './containers/App'\nimport RootStore from './store'\n\n// Styles\nimport '../css'\n\nconst store = new RootStore()\nconst appNode = document.getElementById('app')\n\nReactDOM.render(\n  <App store={store} />,\n  appNode\n)\n","import React, { Component } from 'react'\nimport { hot } from 'react-hot-loader'\nimport { observer } from 'mobx-react'\n\nimport ModeController from './ModeController'\nimport BuildMode from './BuildMode'\nimport AnimateMode from './AnimateMode'\nimport ViewMode from './ViewMode'\nimport ExportMode from './ExportMode'\nimport Gallery from './Gallery'\nimport Grid from '../components/Grid'\n\n@observer\nclass App extends Component {\n  componentDidMount() {\n    // const { store } = this.props\n    // store.canvas.setTool('SETTINGS')\n  }\n\n  render() {\n    const { store } = this.props\n    const { pathname } = window.location\n\n    const pathArray = pathname.split('/')\n    if (pathArray.length > 1 && pathArray[1] === 'gallery') {\n      return <Gallery clipsRef={store.gallery.clipsRef} />\n    }\n\n    return (\n      <Grid\n        minHeight=\"100vh\"\n        gridTemplateRows=\"60px 1fr\"\n      >\n        <ModeController mode={store.mode} />\n        {store.mode.current === 'BUILD' &&\n          <BuildMode store={store} />\n        }\n        {store.mode.current === 'ANIMATE' &&\n          <AnimateMode store={store} />\n        }\n        {store.mode.current === 'VIEW' &&\n          <ViewMode store={store} />\n        }\n        {store.mode.current === 'EXPORT' &&\n          <ExportMode store={store} />\n        }\n      </Grid>\n    )\n  }\n}\n\nexport default hot(module)(App)\n","import React from 'react'\n\nconst playbarStyle = { height: '10px', margin: '10px 0px' }\n\nconst Playbar = ({\n  fullWidth,\n  totalFrames,\n  inPoint,\n  outPoint,\n  now,\n  ABSOLUTE_FIRST,\n}) => {\n  const playbarWidth = fullWidth || 0\n\n  const per = playbarWidth / totalFrames\n  const marker = totalFrames > 1 ? per : 0\n  const head = parseInt((inPoint - ABSOLUTE_FIRST) * per)\n  const tail = parseInt((totalFrames - outPoint) * per)\n\n  let activeHead = parseInt((now * per) - head)\n  if (totalFrames === 1) {\n    activeHead = per\n  } else if (now === inPoint) {\n    activeHead = 0\n  } else if (now === outPoint) {\n    activeHead = playbarWidth - head - tail - marker\n  }\n  const activeTail = now === outPoint ? 0 : playbarWidth - head - tail - activeHead - marker\n\n  return (\n    <div style={{ display: 'flex' }}>\n      <div style={{\n        ...playbarStyle,\n        width: head,\n        backgroundColor: 'rgb(150, 160, 170)' }}\n      />\n      <div style={{\n        ...playbarStyle,\n        width: activeHead,\n        backgroundColor: 'rgb(220, 225, 240)' }}\n      />\n      <div style={{\n        ...playbarStyle,\n        width: marker,\n        height: '20px',\n        marginTop: '5px',\n        backgroundColor: 'rgb(30, 155, 255)' }}\n      />\n      <div style={{\n        ...playbarStyle,\n        width: activeTail,\n        backgroundColor: 'rgb(220, 225, 240)' }}\n      />\n      <div style={{\n        ...playbarStyle,\n        width: tail,\n        backgroundColor: 'rgb(150, 160, 170)' }}\n      />\n    </div>\n  )\n}\n\nexport default Playbar\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Animation from '../prototypes/Animation'\nimport Canvas from '../components/Canvas'\nimport Playbar from '../components/Playbar'\n\n@observer\nclass Viewer extends Component {\n  canvasHasSize = () => {\n    const { canvas, onSetup } = this.props\n    canvas.attatchAndSetup('paper-canvas')\n    onSetup()\n  }\n\n  render() {\n    const { canvas, animation } = this.props\n    return (\n      <React.Fragment>\n        <Canvas\n          id=\"paper-canvas\"\n          width={canvas.width}\n          height={canvas.height}\n          hasSize={this.canvasHasSize}\n        />\n        <Playbar\n          fullWidth={canvas.width}\n          totalFrames={animation.frames}\n          inPoint={animation.firstFrame}\n          outPoint={animation.lastFrame}\n          now={animation.now}\n          ABSOLUTE_FIRST={Animation.FIRST}\n        />\n      </React.Fragment>\n    )\n  }\n}\n\nexport default Viewer\n","const download = (data, filename, type) => {\n  const file = new Blob([data], { type })\n  if (window.navigator.msSaveOrOpenBlob) {\n    window.navigator.msSaveOrOpenBlob(file, filename)\n  } else {\n    const elm = document.createElement('a')\n    const url = window.URL.createObjectURL(file)\n\n    elm.href = url\n    elm.download = filename\n\n    document.body.appendChild(elm)\n    elm.click()\n\n    setTimeout(() => {\n      document.body.removeChild(elm)\n      window.URL.revokeObjectURL(url)\n    })\n  }\n}\n\nconst downloadJSON = (data, basename) => (\n  download(data, `${basename}.json`, 'text/json')\n)\n\nexport {\n  download,\n  downloadJSON,\n}\n","import { observable, action } from 'mobx'\n\nimport Animation from './Animation'\nimport { downloadJSON } from '../util/download'\n\nclass Project {\n  @observable name\n  @observable inputItems\n  @observable inputBuilt\n\n  constructor(rootStore) {\n    this.rootStore = rootStore\n    this.paper = rootStore.paper\n    this.initialize()\n  }\n\n  initialize() {\n    if (this.paper.project) {\n      this.paper.project.clear()\n      this.paper.project.remove()\n    }\n    this.name = 'My Animation'\n    this.inputItems = undefined\n    this.inputBuilt = false\n  }\n\n  toJSON() {\n    return ({\n      name: this.name,\n    })\n  }\n\n  @action setName(name) {\n    this.name = name\n  }\n\n  clear = () => {\n    this.paper.project.clear()\n    this.paper.project.remove()\n\n    const { canvas, animation } = this.rootStore\n    canvas.setSize(undefined, undefined)\n    animation.setIn(Animation.FIRST)\n    animation.setOut(animation.frames)\n  }\n\n  load = (inputJSON, fileName, callback) => {\n    const { canvas, animation } = this.rootStore\n    const input = JSON.parse(inputJSON)\n\n    const name = fileName || input.project.name\n    this.setName(name.replace(/\\.[^/.]+$/, ''))\n\n    Object.keys(input.animation).forEach((key) => {\n      animation[key] = input.animation[key]\n    })\n\n    Object.keys(input.canvas).forEach((key) => {\n      if (key === 'animatables') {\n        this.inputItems = input.canvas.animatables\n      } else {\n        canvas[key] = input.canvas[key]\n      }\n    })\n\n    if (callback) callback()\n  }\n\n  loadFromFile = (event, callback) => {\n    const { files } = event.target\n    const targetFile = files[0]\n    const reader = new FileReader()\n    reader.onload = () => this.load(reader.result, targetFile.name, callback)\n\n    this.rootStore.reset()\n    reader.readAsText(targetFile)\n  }\n\n  save = () => {\n    /* eslint no-param-reassign: 0 */\n    const { canvas, animation } = this.rootStore\n    const projectAsJSON = JSON.stringify({\n      project: this.toJSON(),\n      animation: animation.toJSON(),\n      canvas: canvas.toJSON(),\n    })\n    return projectAsJSON\n  }\n\n  download = (object) => {\n    downloadJSON(object, this.name)\n  }\n\n  publish = () => {\n    const projectAsJSON = this.save()\n    this.rootStore.gallery.clipsRef.push().set(projectAsJSON)\n  }\n\n  // render() {\n  //   // render canvas animation to frames\n  // }\n}\n\nexport default Project\n","import { observable } from 'mobx'\n\nimport AnimatableItem from '../AnimatableItem'\n\nclass Circle extends AnimatableItem {\n  // Canvas Size Relative Values (0-100)\n  static get RADIUS() { return 10 }\n\n  @observable _radius = Circle.RADIUS\n\n  toJSON() {\n    return ({\n      ...super.toJSON(),\n      radius: this.radius,\n    })\n  }\n\n  get radius() { return this._radius }\n  set radius(value) {\n    // TODO: update this value using item.bounds and scale\n    this._radius = value\n    this.recreate()\n  }\n\n  onCreate(itemProps) {\n    const { x, y } = this.position\n    new this.paper.Path.Circle({\n      ...itemProps,\n      center: [this.absolute(x), this.absolute(y, 'height')],\n      radius: this.absolute(this.radius) / 2,\n    })\n  }\n}\n\nexport default Circle\n","import React, { Component } from 'react'\nimport { reaction } from 'mobx'\nimport { observer } from 'mobx-react'\nimport paper from 'paper'\n\nimport CanvasEl from '../components/Canvas'\n\nimport Project from '../prototypes/Project'\nimport Canvas from '../prototypes/Canvas'\nimport Animation from '../prototypes/Animation'\nimport Keyframe from '../prototypes/Keyframe'\nimport items from '../prototypes/items'\n\nimport { simpleHash } from '../util/string'\n\nconst playable = () => {\n  const obj = {}\n  obj.paper = new paper.PaperScope()\n  obj.project = new Project(obj)\n  obj.canvas = new Canvas(obj)\n  obj.animation = new Animation()\n  return obj\n}\n\n@observer\nclass Gallery extends Component {\n  state = {\n    clips: [],\n    width: undefined,\n    height: undefined,\n  }\n\n  componentDidMount() {\n    const container = document.getElementById('playback-container')\n    const width = Math.round(container.clientWidth) - 20\n    const height = Math.round((9 / 16) * width)\n    this.setState({ width, height })\n\n\n    const { clipsRef } = this.props\n    clipsRef.on('child_added', (data) => {\n      const newClip = {\n        key: `${simpleHash(data.val())}`,\n        json: data.val(),\n        clip: playable(),\n      }\n\n      this.setState((prevState) => {\n        const firstClip = prevState.clips[0]\n        if (firstClip) {\n          return ({\n            clips: [\n              firstClip,\n              newClip,\n              ...prevState.clips.slice(1),\n            ],\n          })\n        }\n        return ({ clips: [newClip] })\n      })\n    })\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const { width, height, clips } = this.state\n    const prevClipsLen = prevState.clips.length\n    if (clips.length > prevClipsLen) {\n      const targetIndex = prevClipsLen === 0 ? 0 : 1\n      clips[targetIndex].clip.canvas.setSize(width, height)\n      reaction(\n        () => ([\n          clips[targetIndex].clip.animation.now,\n        ]),\n        () => clips[targetIndex].clip.canvas.draw()\n      )\n    }\n  }\n\n  canvasHasSize = (key, clip, json) => () => {\n    clip.canvas.attatchAndSetup(`paper-canvas-${key}`)\n    clip.canvas.build()\n    clip.project.load(json)\n    this.buildAnimatables(clip)\n    clip.animation.play()\n  }\n\n  buildAnimatables = (clip) => {\n    Object.entries(clip.project.inputItems).forEach(([itemKey, itemObj]) => {\n      const { class: itemClass, keyframes, ...properties } = itemObj\n\n      const animatable = new items[itemClass](itemKey)\n      clip.canvas.add(animatable)\n\n      const inputKeyframes = Object.entries(keyframes)\n        .reduce((accum, [keyframeProp, keyframeList]) => {\n          /* eslint no-param-reassign: 0 */\n          accum[keyframeProp] = keyframeList.map(Keyframe.fromJSON)\n          return accum\n        }, {})\n      animatable.keyframes = {\n        ...this.keyframes,\n        ...inputKeyframes,\n      }\n\n      Object.entries(properties).forEach(([key, value]) => {\n        animatable[key] = value\n      })\n    })\n\n    clip.canvas.deselect()\n    clip.canvas.draw()\n  }\n\n  render() {\n    const { clips } = this.state\n\n    return (\n      <div>\n        <div style={{ width: '100%', padding: '10px', position: 'fixed', backgroundColor: 'white', zIndex: '100' }}>\n          <h1 style={{ marginBottom: '0px' }}>Welcome to the Gallery</h1>\n          <small>{clips.length} Published Animations, scroll to see them!</small>\n        </div>\n\n        <div id=\"playback-container\" style={{ width: '100%', padding: '0px 10px', paddingTop: '100px' }}>\n          {clips.length === 0 ? (\n            <p>Loading Clips...</p>\n          ) : (\n            clips.map(({ clip, key, json }) => (\n              <div key={key} style={{ padding: '10px 0px' }}>\n                <h4 style={{ marginBottom: '4px' }}>{clip.project.name}</h4>\n                <CanvasEl\n                  id={`paper-canvas-${key}`}\n                  width={clip.canvas.width}\n                  height={clip.canvas.height}\n                  hasSize={this.canvasHasSize(key, clip, json)}\n                />\n              </div>\n            ))\n          )}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Gallery\n","import React from 'react'\n\nconst GridItem = ({ id, children, ...style }) => (\n  <div id={id} style={style}>\n    {children}\n  </div>\n)\n\nexport default GridItem\n","import { observable } from 'mobx'\n\nclass Handle {\n  static get MAX() { return 100 }\n  static get STEP() { return 10 }\n  static get OBSERVABLES() {\n    return ['influence', 'distance']\n  }\n\n  @observable _influence\n  @observable _distance\n\n  constructor(type) {\n    this.type = type\n    this.influence = 50\n    this.distance = 0\n  }\n\n  toJSON() {\n    return ({\n      type: this.type,\n      influence: this.influence,\n      distance: this.distance,\n    })\n  }\n\n  get influence() { return this._influence }\n  get distance() { return this._distance }\n  get position() {\n    let x = this.influence\n    let y = this.distance\n    if (this.type === 'IN') {\n      x = Handle.MAX - this.influence\n      y = Handle.MAX - this.distance\n    }\n    x /= Handle.MAX\n    y /= Handle.MAX\n    return { x, y }\n  }\n\n  set influence(value) {\n    this._influence = value\n  }\n\n  set distance(value) {\n    this._distance = value\n  }\n\n  set position({ x, y }) {\n    const newX = x * Handle.MAX\n    const newY = x * Handle.MAX\n    if (this.type === 'IN') {\n      this.influence = Handle.MAX - newX\n      this.distance = Handle.MAX - newY\n    } else {\n      this.influence = newX\n      this.distance = newY\n    }\n  }\n}\n\nexport default Handle\n","const titleCase = (str) => {\n  /* Convert `any string` into `Any String`, including replacing underscores\n    with spaces */\n  const splitStr = str.toLowerCase().split(/[\\s_]+/)\n  for (let i = 0; i < splitStr.length; i += 1) {\n    splitStr[i] = splitStr[i].charAt(0).toUpperCase() + splitStr[i].substring(1)\n  }\n  return splitStr.join(' ')\n}\n\nconst simpleHash = (str) => {\n  /* eslint no-bitwise: 0 */\n  let hash = 0\n  if (str.length === 0) return hash\n\n  for (let i = 0; i < str.length; i += 1) {\n    const char = str.charCodeAt(i)\n    hash = ((hash << 5) - hash) + char\n    hash &= hash\n  }\n\n  return hash\n}\n\nexport {\n  titleCase,\n  simpleHash,\n}\n","import Circle from './Circle'\nimport Rectangle from './Rectangle'\n\nconst items = {\n  Circle,\n  Rectangle,\n}\n\nexport default items\n","import { observable, action } from 'mobx'\n\nclass Animation {\n  static get FIRST() { return 1 }\n  static get PLAYBACK_MODES() { return ['LOOP', 'ONCE'] }\n\n  @observable frames\n  @observable firstFrame\n  @observable lastFrame\n  @observable fps\n  @observable now\n  @observable playing\n  @observable sync\n  @observable requestId\n  @observable mode\n\n  constructor() {\n    this.initialize()\n  }\n\n  initialize() {\n    this.frames = 100\n    this.firstFrame = Animation.FIRST\n    this.lastFrame = 100\n    this.fps = 30\n    this.now = this.firstFrame\n    this.playing = false\n    this.sync = 0\n    this.requestId = null\n    this.mode = 'LOOP'\n  }\n\n  toJSON() {\n    return ({\n      frames: this.frames,\n      firstFrame: this.firstFrame,\n      lastFrame: this.lastFrame,\n      fps: this.fps,\n      mode: this.mode,\n    })\n  }\n\n  @action setLength(length) {\n    this.frames = length\n    if (length < this.lastFrame) {\n      this.lastFrame = length\n    }\n  }\n\n  @action setIn = (f) => {\n    if (f < Animation.FIRST || f > this.frames) return\n    this.firstFrame = f\n    if (this.now < f) {\n      this.goToFrame(f)\n    }\n  }\n\n  @action setOut = (f) => {\n    if (f < Animation.FIRST || f > this.frames) return\n    this.lastFrame = f\n    if (this.now > f) {\n      this.goToFrame(f)\n    }\n  }\n\n  nextFrame = () => {\n    const later = this.now + 1\n    if (later > this.lastFrame) {\n      if (this.mode === 'LOOP') return this.firstFrame\n      return null\n    }\n    return later\n  }\n\n  prevFrame = () => {\n    const earlier = this.now - 1\n    if (earlier < this.firstFrame) {\n      if (this.mode === 'LOOP') return this.lastFrame\n      return null\n    }\n    return earlier\n  }\n\n  @action play = () => {\n    if (this.nextFrame() === null) return\n    this.playing = true\n    this.animateAtRate(() => {\n      const nextFrame = this.nextFrame()\n      if (nextFrame === null) return this.pause()\n      this.now = nextFrame\n    })\n  }\n\n  @action pause = () => {\n    this.playing = false\n    if (this.requestId) cancelAnimationFrame(this.requestId)\n  }\n\n  @action goToFrame = (frame) => {\n    this.now = frame\n  }\n\n  @action goToFirst = () => {\n    this.goToFrame(this.firstFrame)\n  }\n\n  @action goToLast = () => {\n    this.goToFrame(this.lastFrame)\n  }\n\n  @action goToNext = () => {\n    const nextFrame = this.nextFrame()\n    if (nextFrame === null) return\n    this.goToFrame(nextFrame)\n  }\n\n  @action goToPrev = () => {\n    const prevFrame = this.prevFrame()\n    if (prevFrame === null) return\n    this.goToFrame(prevFrame)\n  }\n\n  @action animateAtRate = (func) => {\n    const interval = 1000 / this.fps\n    let then = Date.now()\n\n    const loop = () => {\n      if (this.playing === false) return\n      this.requestId = requestAnimationFrame(loop)\n      const now = Date.now()\n      const delta = now - then\n      if (delta >= interval) {\n        then = now - (delta % interval)\n        this.sync = Math.round(delta - interval - (delta % interval))\n        func()\n      }\n    }\n    loop()\n  }\n}\n\nexport default Animation\n","import React from 'react'\n\nconst Grid = ({ children, ...style }) => (\n  <div style={{ display: 'grid', ...style }}>\n    {children}\n  </div>\n)\n\nexport default Grid\n","const cssContext = require.context(\n  '!!file-loader?name=[name].[ext]!.',\n  true,\n  /\\.(css)$/\n)\n\ncssContext.keys().forEach(cssContext)\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Circle from '../prototypes/items/Circle'\nimport Rectangle from '../prototypes/items/Rectangle'\n\n@observer\nclass ToolController extends Component {\n  choose = (event) => {\n    event.preventDefault()\n    this.props.setTool(event.currentTarget.id)\n  }\n\n  addCircle = () => {\n    const { existing } = this.props\n    const circle = new Circle(`circle-${Object.keys(existing).length}`)\n    this.props.add(circle)\n  }\n\n  addRectangle = () => {\n    const { existing } = this.props\n    const rect = new Rectangle(`rect-${Object.keys(existing).length}`)\n    this.props.add(rect)\n  }\n\n  render() {\n    const { tool } = this.props\n\n    return (\n      <div style={{ display: 'flex', padding: '10px 10px 0px 10px' }}>\n        <button\n          type=\"button\"\n          id=\"SETTINGS\"\n          onClick={this.choose}\n          {...(tool === 'SETTINGS' ? { primary: 'true' } : {})}\n        >\n          <div>&#9776;</div>\n        </button>\n        <button\n          type=\"button\"\n          id=\"CLEAR\"\n          onClick={this.choose}\n        >\n          <div>&#10007;</div>\n        </button>\n        <button\n          type=\"button\"\n          id=\"SELECT\"\n          onClick={this.choose}\n          {...(tool === 'SELECT' ? { primary: 'true' } : {})}\n        >\n          <div style={{ transform: 'rotate(-135deg)' }}>&#10148;</div>\n        </button>\n        {/* <button\n          type=\"button\"\n          id=\"DRAW\"\n          onClick={this.choose}\n          {...(tool === 'DRAW' ? { primary: 'true' } : {})}\n        >\n          ✎\n        </button> */}\n\n        <button type=\"button\" onClick={this.addCircle}>+ Circle</button>\n        <button type=\"button\" onClick={this.addRectangle}>+ Rectangle</button>\n      </div>\n    )\n  }\n}\n\nexport default ToolController\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\n@observer\nclass IntegerInput extends Component {\n  state = {\n    localValue: 0,\n  }\n\n  componentDidMount() {\n    const { value } = this.props\n    if (value !== this.state.localValue) {\n      this.setState({ localValue: value })\n    }\n  }\n\n  onChange = (event) => {\n    this.setState({ localValue: event.target.value })\n  }\n\n  onBlur = () => {\n    const { value, setValue } = this.props\n    const { localValue } = this.state\n\n    const possibleInt = parseInt(localValue)\n    let result = value\n    if (Number.isInteger(possibleInt)) {\n      result = possibleInt\n    }\n\n    setValue(result)\n    this.setState({ localValue: result })\n  }\n\n  handleKeyDown = (event) => {\n    const { key, shiftKey } = event\n    if (key === 'ArrowUp' && shiftKey) {\n      this.incrementBy(10)\n    } else if (key === 'ArrowUp') {\n      this.incrementBy(1)\n    } else if (key === 'ArrowDown' && shiftKey) {\n      this.decrementBy(10)\n    } else if (key === 'ArrowDown') {\n      this.decrementBy(1)\n    }\n  }\n\n  changeBy = operation => (amount) => {\n    const { value, setValue } = this.props\n    const next = operation(value, amount)\n    setValue(next)\n    this.setState({ localValue: next })\n  }\n\n  // eslint-disable-next-line\n  incrementBy = this.changeBy((a, b) => a + b)\n  decrementBy = this.changeBy((a, b) => a - b)\n\n  render() {\n    const { localValue } = this.state\n    return (\n      <input\n        type=\"text\"\n        style={{ width: '60px', marginRight: '20px', textAlign: 'center' }}\n        value={localValue}\n        onChange={this.onChange}\n        onKeyDown={this.handleKeyDown}\n        onBlur={this.onBlur}\n      />\n    )\n  }\n}\n\nexport default IntegerInput\n","import React, { useRef } from 'react'\n\nconst style = {\n  container: {\n    position: 'fixed',\n    zIndex: 100,\n    left: 0,\n    top: 0,\n    width: '100%',\n    height: '100%',\n    overflow: 'auto',\n    backgroundColor: 'rgba(0, 0, 0, 0.4)',\n  },\n  body: {\n    backgroundColor: '#fefefe',\n    margin: '15% auto',\n    border: '1px solid #888',\n    width: '80%',\n  },\n  content: {\n    padding: '16px',\n  },\n}\n\nconst Modal = ({ children, open, handleClose }) => {\n  const clickawayEl = useRef(null)\n\n  const onClickaway = (event) => {\n    if (clickawayEl.current.contains(event.target)) return\n    handleClose()\n  }\n\n  return (\n    open === false ? null : (\n      <div style={style.container} onClick={onClickaway}>\n        <div ref={clickawayEl} style={style.body}>\n          <div style={style.content}>{children}</div>\n        </div>\n      </div>\n    )\n  )\n}\n\nexport default Modal\n","// encapsulates ValueEditor, implements editing the paper properties of an AnimatibleItem\n\nimport React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport IntegerInput from '../components/IntegerInput'\n\n@observer\nclass PropertyEditor extends Component {\n  propertySetter = property => (value) => {\n    const { item, now } = this.props\n\n    if (item.keyframes[property] && item.keyframes[property].length) {\n      const existingKeyframe = item.keyframes[property].find(keyframe => keyframe.frame === now)\n      if (existingKeyframe) {\n        existingKeyframe.value = value\n      } else {\n        item.addKey(`${property}`, now, value)\n      }\n    } else {\n      item[property] = value\n    }\n  }\n\n  classControls() {\n    const { item } = this.props\n    const itemClass = item.constructor.name\n\n    if (itemClass === 'Circle') {\n      return (\n        <React.Fragment>\n          <label>Radius</label>\n          <div style={{ display: 'flex' }}>\n            <IntegerInput value={item.radius} setValue={this.propertySetter('radius')} />\n          </div>\n        </React.Fragment>\n      )\n    }\n\n    if (itemClass === 'Rectangle') {\n      return (\n        <React.Fragment>\n          <label>Size</label>\n          <div style={{ display: 'flex' }}>\n            <IntegerInput value={item.width} setValue={this.propertySetter('width')} />\n            <IntegerInput value={item.height} setValue={this.propertySetter('height')} />\n          </div>\n        </React.Fragment>\n      )\n    }\n  }\n\n  render() {\n    const { item } = this.props\n\n    if (item === undefined) {\n      return (\n        <h3 style={{ padding: '10px', color: 'darkgray' }}>\n          Select an Item on the Canvas.\n        </h3>\n      )\n    }\n\n    return (\n      <div style={{ padding: '10px' }}>\n        <h4>{item.key}</h4>\n        <label>Position</label>\n        <div style={{ display: 'flex' }}>\n          <IntegerInput value={item.x} setValue={this.propertySetter('x')} />\n          <IntegerInput value={item.y} setValue={this.propertySetter('y')} />\n        </div>\n\n        <label>Scale</label>\n        <div style={{ display: 'flex' }}>\n          <IntegerInput value={item.scale} setValue={this.propertySetter('scale')} />\n        </div>\n\n        <label>Rotation</label>\n        <div style={{ display: 'flex' }}>\n          <IntegerInput value={item.rotation} setValue={this.propertySetter('rotation')} />\n        </div>\n\n        {this.classControls()}\n      </div>\n    )\n  }\n}\n\nexport default PropertyEditor\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Modal from '../components/Modal'\n\n@observer\nclass ProjectSettings extends Component {\n  setName = (event) => {\n    const { store } = this.props\n    store.project.setName(event.target.value)\n  }\n\n  setLength = (event) => {\n    const { store } = this.props\n    const length = parseInt(event.target.value)\n    store.animation.setLength(length)\n  }\n\n  setColor = (event) => {\n    const { store } = this.props\n    store.canvas.color = event.target.value\n  }\n\n  closeModal = () => this.props.store.canvas.setTool('SELECT')\n\n  render() {\n    const { store } = this.props\n\n    return (\n      <Modal open={store.mode.settings} handleClose={this.closeModal}>\n        <h3>Project Settings</h3>\n\n        <label>Project Name</label>\n        <input type=\"text\" value={store.project.name} onChange={this.setName} />\n\n        <label>Animation Length</label>\n        <input type=\"number\" step=\"1\" value={store.animation.frames} onChange={this.setLength} />\n\n        <label>Canvas Background</label>\n        <select value={store.canvas.color} onChange={this.setColor}>\n          <option value=\"#000000\">Black</option>\n          <option value=\"#ffffff\">White</option>\n        </select>\n\n        <div style={{ display: 'flex', flexDirection: 'row-reverse' }}>\n          <button type=\"button\" onClick={this.closeModal}>Close</button>\n        </div>\n      </Modal>\n    )\n  }\n}\n\nexport default ProjectSettings\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Modal from '../components/Modal'\n\n@observer\nclass ClearProject extends Component {\n  closeModal = () => this.props.store.canvas.setTool('SELECT')\n\n  render() {\n    const { store } = this.props\n    const { mode, project, reset } = store\n\n    return (\n      <Modal open={mode.clear} handleClose={this.closeModal}>\n        <h3>Remove Project?</h3>\n\n        <p>\n          You are about to remove&nbsp;\n          <strong>{project.name}</strong>\n          &nbsp;from your workspace, and start from scratch.\n          Are you sure you want to do this?\n        </p>\n\n        <div style={{ display: 'flex', justifyContent: 'flex-end' }}>\n          <button type=\"button\" onClick={this.closeModal}>Cancel</button>\n          <button type=\"button\" onClick={reset}>Remove</button>\n        </div>\n      </Modal>\n    )\n  }\n}\n\nexport default ClearProject\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\nimport { autorun } from 'mobx'\n\nimport Viewer from './Viewer'\nimport ToolController from './ToolController'\nimport PropertyEditor from './PropertyEditor'\nimport ProjectSettings from './ProjectSettings'\nimport ClearProject from './ClearProject'\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\nimport items from '../prototypes/items'\nimport Keyframe from '../prototypes/Keyframe'\n\n@observer\nclass BuildMode extends Component {\n  state = {\n    ready: false,\n    inputItemsExist: false,\n  }\n\n  autorunDisposer\n\n  componentDidMount() {\n    const { canvas, project } = this.props.store\n    const container = document.getElementById('build-container')\n    setTimeout(() => {\n      const width = Math.round(container.clientWidth) - 20\n      const height = Math.round((9 / 16) * width)\n      canvas.setSize(width, height)\n    }, 1)\n\n    if (canvas.tool === 'SELECT') {\n      setTimeout(() => {\n        canvas.setTool(undefined)\n        canvas.setTool('SELECT')\n      }, 20)\n    }\n\n    this.autorunDisposer = autorun(() => {\n      this.setState({ inputItemsExist: Boolean(project.inputItems) })\n    })\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const prevInputItemsExist = prevState.inputItemsExist\n    const { canvas, project } = this.props.store\n    const { ready, inputItemsExist } = this.state\n    if (\n      !project.inputBuilt &&\n      (\n        (ready && !prevInputItemsExist && inputItemsExist) ||\n        (inputItemsExist && !prevState.ready && ready)\n      )\n    ) {\n      Object.entries(project.inputItems).forEach(([itemKey, itemObj]) => {\n        const { class: itemClass, keyframes, ...properties } = itemObj\n\n        const animatable = new items[itemClass](itemKey)\n        canvas.add(animatable)\n\n        const inputKeyframes = Object.entries(keyframes)\n          .reduce((accum, [keyframeProp, keyframeList]) => {\n            /* eslint no-param-reassign: 0 */\n            accum[keyframeProp] = keyframeList.map(Keyframe.fromJSON)\n            return accum\n          }, {})\n        animatable.keyframes = {\n          ...this.keyframes,\n          ...inputKeyframes,\n        }\n\n        Object.entries(properties).forEach(([key, value]) => {\n          animatable[key] = value\n        })\n      })\n\n      project.inputBuilt = true\n    }\n  }\n\n  componentWillUnmount() {\n    const { project, canvas } = this.props.store\n    canvas.selectOff()\n    project.clear()\n    this.autorunDisposer()\n  }\n\n  onSetup = () => {\n    const { canvas } = this.props.store\n    canvas.build()\n    this.setState({ ready: true })\n  }\n\n  add = (item) => {\n    const { canvas } = this.props.store\n    canvas.add(item)\n  }\n\n  render() {\n    const { canvas, animation } = this.props.store\n    const { ready } = this.state\n    return (\n      <React.Fragment>\n        <ProjectSettings store={this.props.store} />\n        <ClearProject store={this.props.store} />\n        <Grid\n          gridTemplateRows=\"auto 60px\"\n          gridTemplateColumns=\"auto 340px\"\n        >\n          <GridItem gridArea=\"1 / 1 / 1 / 2\" id=\"build-container\" padding=\"10px\" alignSelf=\"center\">\n            <Viewer canvas={canvas} animation={animation} onSetup={this.onSetup} />\n          </GridItem>\n          <GridItem gridArea=\"1 / 2 / 1 / 3\" backgroundColor=\"rgb(210, 210, 210)\">\n            <PropertyEditor item={canvas.selected} now={animation.now} />\n          </GridItem>\n          <GridItem gridArea=\"2 / 1 / 2 / 3\" backgroundColor=\"rgb(180, 180, 180)\">\n            { ready && (\n              <ToolController\n                existing={canvas.animatables}\n                add={this.add}\n                tool={canvas.tool}\n                setTool={canvas.setTool}\n              />\n            )}\n          </GridItem>\n        </Grid>\n      </React.Fragment>\n    )\n  }\n}\n\nexport default BuildMode\n","const makeRoot = (real, imag) => ({ real, imag })\n\nconst evaluate = (x, A, B, C, D) => {\n  const q0 = A * x\n  const B1 = q0 + B\n  const C2 = B1 * x + C\n  return {\n    Q: C2 * x + D,\n    dQ: (q0 + B1) * x + C2,\n    B1,\n    C2,\n  }\n}\n\nconst qdrtc = (A, B, C) => {\n  const b = -B / 2\n  const q = b * b - A * C\n  let X1 = 0\n  let Y1 = 0\n  let X2 = 0\n  let Y2 = 0\n\n  if (q < 0) {\n    const X = b / A\n    const Y = Math.sqrt(-q) / A\n    X1 = X\n    Y1 = Y\n    X2 = X\n    Y2 = -Y\n  } else {\n    Y1 = 0\n    Y2 = 0\n    const r = b + Math.sign(b) * Math.sqrt(q)\n    if (r === 0) {\n      X1 = C / A\n      X2 = -C / A\n    } else {\n      X1 = C / r\n      X2 = r / A\n    }\n  }\n  return [\n    makeRoot(X1, Y1),\n    makeRoot(X2, Y2),\n  ]\n}\n\nconst getCubicRoots = (A, B, C, D) => {\n  let X\n  let a\n  let b1\n  let c2\n  if (A === 0) {\n    X = undefined\n    a = B\n    b1 = C\n    c2 = D\n  } else if (D === 0) {\n    X = 0\n    a = A\n    b1 = B\n    c2 = C\n  } else {\n    a = A\n    X = -(B / A) / 3\n    let evalInfo = evaluate(X, A, B, C, D)\n    let q = evalInfo.Q\n    let dq = evalInfo.dQ\n    b1 = evalInfo.B1\n    c2 = evalInfo.C2\n\n    let t = q / A\n    let r = Math.abs(t) ** (1 / 3)\n    const s = Math.sign(t)\n    t = -dq / A\n    if (t > 0) {\n      r = 1.324717957244746 * Math.max(r, Math.sqrt(t))\n    }\n    let x0 = X - s * r\n    if (x0 !== X) {\n      const den = 1 + (100 * Number.EPSILON)\n      do {\n        X = x0\n        evalInfo = evaluate(X, A, B, C, D)\n        q = evalInfo.Q\n        dq = evalInfo.dQ\n        b1 = evalInfo.B1\n        c2 = evalInfo.C2\n        x0 = (dq === 0 ? X : X - (q / dq) / den)\n      } while (s * x0 > s * X)\n      if (Math.abs(A) * X * X > Math.abs(D / X)) {\n        c2 = -D / X\n        b1 = (c2 - C) / X\n      }\n    }\n  }\n  const roots = []\n  if (X !== undefined) {\n    roots.push(makeRoot(X, 0))\n  }\n  const quadInfo = qdrtc(a, b1, c2)\n  return roots.concat(quadInfo)\n}\n\nconst cubic = (x, a, b, c, d) => (\n  (a * (x ** 3)) + (b * (x ** 2)) + (c * x) + d\n)\n\nconst bezierCurve = ({ x2, x3, y2, y3 }) => {\n  /* x2, and x3 are the X values from the 2nd and 3rd points for a bezier\n      definition. For this use case, they must be between 0 - 1.\n  */\n  if (x2 > 1 || x2 < 0 || x3 > 1 || x3 < 0) {\n    throw Error('This bezier curve requires control values between 0 & 1')\n  }\n\n  // These constants were reduced from the Cubic Bézier curve definition, with\n  // values of (0, 0) and (1, 1) used for p1 & p4 respectively\n  const xA = 3 * x2 - 3 * x3 + 1\n  const xB = -1 * 6 * x2 + 3 * x3\n  const xC = 3 * x2\n\n  const yA = 3 * y2 - 3 * y3 + 1\n  const yB = -1 * 6 * y2 + 3 * y3\n  const yC = 3 * y2\n  const yD = 0\n\n  const t = (x) => {\n    const xD = -x\n    const roots = getCubicRoots(xA, xB, xC, xD)\n    roots.filter(r => (\n      r.imag === 0 &&\n      r.real.toFixed(10) >= 0 &&\n      r.real.toFixed(10) <= 1 &&\n      !Object.is(r.real, -0)\n    ))\n    // console.log(JSON.stringify(roots))\n    return roots[0].real\n  }\n\n  const y = (x) => {\n    const time = t(x)\n    return cubic(time, yA, yB, yC, yD)\n  }\n\n  return ({ t, y })\n}\n\nexport default bezierCurve\n","import { observable } from 'mobx'\n\nimport Handle from './Handle'\nimport bezierCurve from '../util/bezierCurve'\n\nclass Keyframe {\n  static get OBSERVABLES() {\n    return ['frame', 'value', 'handleIn', 'handleOut']\n  }\n\n  @observable frame\n  @observable value\n  @observable handleIn\n  @observable handleOut\n\n  constructor(frame, value) {\n    this.frame = frame\n    this.value = value\n    this.handleIn = new Handle('IN')\n    this.handleOut = new Handle('OUT')\n  }\n\n  toJSON() {\n    return ({\n      frame: this.frame,\n      value: this.value,\n      handleIn: this.handleIn.toJSON(),\n      handleOut: this.handleOut.toJSON(),\n    })\n  }\n\n  static fromJSON(input) {\n    const { frame, value, handleIn, handleOut } = input\n    const keyframe = new Keyframe(frame, value)\n    keyframe.handleIn.influence = handleIn.influence\n    keyframe.handleIn.distance = handleIn.distance\n    keyframe.handleOut.influence = handleOut.influence\n    keyframe.handleOut.distance = handleOut.distance\n    return keyframe\n  }\n\n  static sort = (a, b) => (a.frame - b.frame)\n\n  static createCurve = (k1, k2) => (\n    bezierCurve({\n      x2: k1.handleOut.position.x,\n      y2: k1.handleOut.position.y,\n      x3: k2.handleIn.position.x,\n      y3: k2.handleIn.position.y,\n    })\n  )\n\n  static interpolate = (k1, k2, frame) => {\n    const curve = Keyframe.createCurve(k1, k2)\n    const timeRatio = (frame - k1.frame) / (k2.frame - k1.frame)\n    // BUG: Bezier Interpolation is broken for certain ranges\n    const valueRatio = curve.y(timeRatio)\n    const interpolated = ((k2.value - k1.value) * valueRatio) + k1.value\n    return interpolated\n  }\n}\n\nexport default Keyframe\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\n@observer\nclass Canvas extends Component {\n  componentDidMount() {\n    this.testForAvailability()\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.width === undefined) {\n      this.testForAvailability()\n    }\n  }\n\n  testForAvailability() {\n    const { width, hasSize } = this.props\n    if (width !== undefined) {\n      hasSize()\n    }\n  }\n\n  render() {\n    const { id, width, height } = this.props\n    if (width === undefined) return null\n    return (\n      <canvas\n        style={{ display: 'block' }}\n        id={id}\n        width={width}\n        height={height}\n      />\n    )\n  }\n}\n\nexport default Canvas\n","/* encapsulates Mode, implements:\n\n  | Viewer     | ExportEditor   |\n  |            |                |\n   ------------|                |\n  | Format     |                |\n  | Controller |                |\n\n*/\n\nimport React, { Component } from 'react'\n\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\nclass ExportMode extends Component {\n  loadThenBuild = (event) => {\n    const { project, mode } = this.props.store\n    return project.loadFromFile(event, () => mode.set('BUILD'))\n  }\n\n  saveThenDownload = () => {\n    const { project } = this.props.store\n    project.download(project.save())\n  }\n\n  render() {\n    const { project } = this.props.store\n\n    return (\n      <Grid\n        gridTemplateRows=\"1fr 1fr 1fr\"\n        gridTemplateColumns=\"auto\"\n        // alignItems=\"center\"\n        justifyItems=\"center\"\n      >\n        {/* <GridItem padding=\"10px\">\n          <h3 style={{ padding: '10px', color: 'darkgray' }}>\n            Feature under construction.\n          </h3>\n        </GridItem> */}\n        <GridItem alignSelf=\"end\">\n          <button type=\"button\" onClick={this.saveThenDownload}>&#x21e9; Save Project to File</button>\n        </GridItem>\n        <GridItem alignSelf=\"center\">\n          <label htmlFor=\"file-button\" style={{ display: 'block', width: '300px' }}>&#x21aa; Load Project from File</label>\n          <input type=\"file\" id=\"file-button\" onChange={this.loadThenBuild} style={{ width: '300px' }} />\n        </GridItem>\n        <GridItem>\n          <button type=\"button\" onClick={project.publish}>&#x2912; Publish Project to Gallery</button>\n        </GridItem>\n      </Grid>\n    )\n  }\n}\n\nexport default ExportMode\n","module.exports = __webpack_public_path__ + \"bare.min.css\";","import { observable, action } from 'mobx'\n\nimport Keyframe from './Keyframe'\n\nclass AnimatableItem {\n  // Canvas Size Relative Values (0-100)\n  static get X() { return 50 }\n  static get Y() { return 50 }\n\n  // Absolute Values\n  static get SCALE() { return 100 }\n  static get ROTATION() { return 0 }\n  static get FILL_COLOR() {\n    return {\n      hue: Math.floor(Math.random() * 361),\n      saturation: 0.4,\n      brightness: 1,\n    }\n  }\n\n  static get OBSERVABLES() {\n    return ['x', 'y', 'scale', 'rotation', 'fillColor', 'keyframes']\n  }\n\n  constructor(key) {\n    this.key = key\n    this.paper = undefined\n  }\n\n  @observable canvas\n  @observable _x = AnimatableItem.X\n  @observable _y = AnimatableItem.Y\n  @observable _scale = AnimatableItem.SCALE\n  @observable _rotation = AnimatableItem.ROTATION\n  @observable _fillColor = AnimatableItem.FILL_COLOR\n  @observable keyframes = {\n    x: observable([]),\n    y: observable([]),\n    scale: observable([]),\n    rotation: observable([]),\n  }\n\n  toJSON() {\n    return ({\n      class: this.constructor.name,\n      x: this.x,\n      y: this.y,\n      scale: this.scale,\n      rotation: this.rotation,\n      fillColor: this.fillColor,\n      keyframes: Object.entries(this.keyframes).reduce(\n        (output, [prop, keyframeList]) => {\n          /* eslint no-param-reassign: 0 */\n          output[prop] = keyframeList.map(keyframe => keyframe.toJSON())\n          return output\n        }, {}\n      ),\n    })\n  }\n\n  get item() { return this.paper.project.activeLayer.children[this.key] }\n  get x() { return this._x }\n  get y() { return this._y }\n  get position() { return { x: this.x, y: this.y } }\n  get scale() { return this._scale }\n  get rotation() { return this._rotation }\n  get fillColor() { return this._fillColor }\n\n  set x(value) {\n    this.item.position.x = this.absolute(value)\n    this._x = value\n  }\n\n  set y(value) {\n    this.item.position.y = this.absolute(value, 'height')\n    this._y = value\n  }\n\n  set position({ x, y }) {\n    this.x = x\n    this.y = y\n  }\n\n  set scale(value) {\n    if (this.scale === 0 && value !== 0) {\n      this.item.remove()\n      this.create(this.canvas)\n      this.item.scale(this.fraction(value))\n    } else {\n      const scaleBy = value / this.scale\n      this.item.scale(scaleBy)\n    }\n    this._scale = value\n  }\n\n  set rotation(value) {\n    const rotateBy = value - this.rotation\n    this.item.rotate(rotateBy)\n    this._rotation = value\n  }\n\n  set fillColor(value) {\n    this.item.fillColor = value\n    this._fillColor = value\n  }\n\n  @action setCanvas(canvas) {\n    this.canvas = canvas\n    this.paper = canvas.paper\n  }\n\n  @action setUntrackedValues() {\n    this.item.scale(this.fraction(this.scale))\n    this.item.rotate(this.rotation)\n  }\n\n  @action updateKeyframes(property, keyframes) {\n    this.keyframes = {\n      ...this.keyframes,\n      [property]: keyframes,\n    }\n  }\n\n  addKey(property, frame, value = undefined, ignorePairings = false) {\n    const valueToKey = value || this[property]\n    const k = new Keyframe(frame, valueToKey)\n    const keyframes = [...this.keyframes[property], k]\n    keyframes.sort(Keyframe.sort)\n\n    if (!ignorePairings && ['x', 'y'].includes(property)) {\n      let paired\n      if (property === 'x') { paired = 'y' }\n      if (property === 'y') { paired = 'x' }\n\n      const valueToPair = this[paired]\n      const kP = new Keyframe(frame, valueToPair)\n      const keyframesPaired = [...this.keyframes[paired], kP]\n      keyframesPaired.sort(Keyframe.sort)\n\n      this.keyframes = {\n        ...this.keyframes,\n        [property]: keyframes,\n        [paired]: keyframesPaired,\n      }\n    } else {\n      this.updateKeyframes(property, keyframes)\n    }\n\n    return k\n  }\n\n  removeKey(property, frame) {\n    let keyframes = [...this.keyframes[property]]\n    keyframes = keyframes.filter(k => k.frame !== frame)\n\n    if (property === 'x') {\n      let keyframesY = [...this.keyframes.y]\n      keyframesY = keyframesY.filter(k => k.frame !== frame)\n      this.keyframes = {\n        ...this.keyframes,\n        x: keyframes,\n        y: keyframesY,\n      }\n    } else {\n      this.updateKeyframes(property, keyframes)\n    }\n  }\n\n  absolute = (value, dimension = 'width') => (\n    value / 100 * this.canvas[dimension]\n  )\n\n  fraction = value => (\n    value / 100\n  )\n\n  create(canvas) {\n    if (this.canvas === undefined) this.setCanvas(canvas)\n\n    const sharedProps = {\n      name: this.key,\n      fillColor: this.fillColor,\n    }\n\n    if (typeof this.onCreate === 'function') {\n      this.onCreate(sharedProps)\n    }\n\n    if (this.item !== undefined) this.setUntrackedValues()\n  }\n\n  recreate() {\n    this.item.remove()\n    this.create(this.canvas)\n    this.canvas.addListenersAndSelect(this)\n  }\n\n  draw(frame) {\n    if (this.item === undefined) return\n\n    Object.entries(this.keyframes).forEach(([property, keyframes]) => {\n      // Ignore `y` property\n      if (property === 'y') return\n      if (property === 'x') {\n        // Interpret `x` & `y` at the same time\n        const xKeyframes = keyframes\n        const yKeyframes = this.keyframes.y\n        if (xKeyframes.length === 0 && yKeyframes.length === 0) return\n        const xValue = this.valueForFrame(frame, xKeyframes)\n        const yValue = this.valueForFrame(frame, yKeyframes)\n        this.position = { x: xValue, y: yValue }\n      } else {\n        // Interpret all other properties individually\n        if (keyframes.length === 0) return\n        const value = this.valueForFrame(frame, keyframes)\n        this[property] = value\n      }\n    })\n  }\n\n  valueForFrame = (frame, keyframes) => {\n    const frames = keyframes.map(key => key.frame)\n\n    // is frame a keyframe\n    if (frames.includes(frame)) {\n      const where = frames.indexOf(frame)\n      return keyframes[where].value\n    }\n\n    // where is frame with respect to keyframes\n    frames.push(frame)\n    frames.sort((a, b) => a - b)\n    const where = frames.indexOf(frame)\n\n    // is frame before or after last key\n    if (where === 0) return keyframes[0].value\n    if (where === frames.length - 1) return keyframes[keyframes.length - 1].value\n\n    // frame is between two keys\n    const before = keyframes[where - 1]\n    const after = keyframes[where]\n    return Keyframe.interpolate(before, after, frame)\n  }\n}\n\nexport default AnimatableItem\n","import React, { Component } from 'react'\n\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\nclass ModeController extends Component {\n  navigate = (event) => {\n    event.preventDefault()\n    const { mode } = this.props\n    mode.set(event.target.textContent.toUpperCase())\n  }\n\n  render() {\n    const { current } = this.props.mode\n    return (\n      <Grid gridTemplateColumns=\"1fr 1fr 1fr 1fr\" borderBottom=\"1px solid rgb(230, 230, 230)\">\n        <GridItem display=\"grid\" alignItems=\"center\" justifyItems=\"center\">\n          <button\n            type=\"button\"\n            style={{ margin: '0px' }}\n            onClick={this.navigate}\n            {...(current === 'BUILD' ? { primary: 'true' } : {})}\n          >\n            Build\n          </button>\n        </GridItem>\n        <GridItem display=\"grid\" alignItems=\"center\" justifyItems=\"center\">\n          <button\n            type=\"button\"\n            style={{ margin: '0px' }}\n            onClick={this.navigate}\n            {...(current === 'ANIMATE' ? { primary: 'true' } : {})}\n          >\n            Animate\n          </button>\n        </GridItem>\n        <GridItem display=\"grid\" alignItems=\"center\" justifyItems=\"center\">\n          <button\n            type=\"button\"\n            style={{ margin: '0px' }}\n            onClick={this.navigate}\n            {...(current === 'VIEW' ? { primary: 'true' } : {})}\n          >\n            View\n          </button>\n        </GridItem>\n        <GridItem display=\"grid\" alignItems=\"center\" justifyItems=\"center\">\n          <button\n            type=\"button\"\n            style={{ margin: '0px' }}\n            onClick={this.navigate}\n            {...(current === 'EXPORT' ? { primary: 'true' } : {})}\n          >\n            Export\n          </button>\n        </GridItem>\n      </Grid>\n    )\n  }\n}\n\nexport default ModeController\n","import paper from 'paper'\n\nimport Handle from './Handle'\n\nclass HandleEditor {\n  constructor(trueWidth, keyframeBefore, keyframeAfter, onMove) {\n    this.trueWidth = trueWidth\n    this.keyframeBefore = keyframeBefore\n    this.keyframeAfter = keyframeAfter\n    this.onMove = onMove\n    this.paper = new paper.PaperScope()\n\n    this.element = undefined\n  }\n\n  attatchTo = (id) => {\n    const element = document.getElementById(id)\n    this.element = element\n    this.paper.setup(element)\n  }\n\n  destroy() {\n    if (this.paper.project) {\n      this.paper.project.clear()\n      this.paper.project.remove()\n    }\n  }\n\n  init() {\n    // Assumes Width & Height are identical\n    this.padding = 10\n    this.width = this.trueWidth - (this.padding * 2)\n    const { width, padding } = this\n\n    const topLeft = [padding, padding]\n    const topRight = [width + padding, padding]\n    const bottomLeft = [padding, width + padding]\n    // const bottomRight = [width, width + padding]\n    const spacing = width / Handle.STEP\n    const center = this.trueWidth / 2\n\n    // Background\n    new this.paper.Path.Rectangle({\n      topLeft: [0, 0],\n      bottomRight: [this.trueWidth, this.trueWidth],\n      fillColor: 'rgb(210, 210, 210)',\n    })\n\n    // Gridlines\n    const gridline = new this.paper.SymbolDefinition(\n      new this.paper.Path.Line({\n        from: [0, 0],\n        to: [0, this.trueWidth],\n        // strokeColor: '#324252',\n        strokeColor: 'rgb(180, 180, 180)',\n        strokeWidth: 2,\n      })\n    )\n    for (let i = 0; i <= Handle.STEP; i += 1) {\n      const offset = padding + 0 + (spacing * i)\n      gridline.place(new this.paper.Point(offset, center))\n      const offAxis = gridline.place(new this.paper.Point(center, offset))\n      offAxis.rotate(90)\n    }\n\n    // Value Interpolation Curve\n    this.curve = new this.paper.Path.Line({\n      // strokeColor: '#2176ff',\n      strokeColor: 'rgb(30, 155, 255)',\n      strokeWidth: 2,\n      from: new this.paper.Point(bottomLeft),\n      to: new this.paper.Point(topRight),\n    })\n    this.setVisualCurveHandles()\n\n    // Handle Strings\n    const stringStyle = {\n      // strokeColor: '#2176ff',\n      strokeColor: 'rgb(30, 155, 255)',\n      strokeWidth: 2,\n    }\n    const handleBeforeString = new this.paper.Path.Line({\n      ...stringStyle,\n      from: bottomLeft,\n      to: this.handleBefore(),\n    })\n    const handleAfterString = new this.paper.Path.Line({\n      ...stringStyle,\n      from: this.handleAfter(),\n      to: topRight,\n    })\n\n    // Handle Grips\n    const handleMovable = new this.paper.SymbolDefinition(\n      new this.paper.Path.Circle({\n        point: topLeft,\n        radius: 6,\n        // strokeColor: '#2176ff',\n        strokeColor: 'rgb(30, 155, 255)',\n        strokeWidth: 2,\n        fillColor: new this.paper.Color(1, 0.01),\n      })\n    )\n    const handleStationary = new this.paper.SymbolDefinition(\n      new this.paper.Path.Rectangle({\n        point: [100, 100],\n        size: [10, 10],\n        // fillColor: '#2176ff',\n        fillColor: 'rgb(30, 155, 255)',\n      })\n    )\n    handleStationary.place(bottomLeft)\n    handleStationary.place(topRight)\n    const handleBefore = handleMovable.place(this.handleBefore())\n    const handleAfter = handleMovable.place(this.handleAfter())\n\n    // Handle Events\n    handleBefore.onMouseEnter = () => {\n      this.element.style.cursor = 'pointer'\n    }\n    handleBefore.onMouseLeave = () => {\n      this.element.style.cursor = 'default'\n    }\n    handleBefore.onMouseDrag = (event) => {\n      this.element.style.cursor = 'pointer'\n      const travelled = event.point.subtract(handleBefore.position)\n\n      const xChange = Math.abs(travelled.x) >= (spacing / 2)\n      const yChange = Math.abs(travelled.y) >= (spacing / 2)\n      if (xChange || yChange) {\n        const xSign = Math.sign(travelled.x)\n        const ySign = Math.sign(travelled.y)\n        const newPosition = handleBefore.position.add({\n          x: xSign * spacing * xChange,\n          y: ySign * spacing * yChange,\n        })\n\n        handleBefore.position = newPosition\n        handleBeforeString.lastSegment.point = newPosition\n        this.onMove('OUT', {\n          influence: xSign * Handle.STEP * xChange,\n          distance: -1 * ySign * Handle.STEP * yChange,\n        })\n        this.setVisualCurveHandles()\n      }\n    }\n    handleBefore.onMouseUp = () => {\n      this.element.style.cursor = 'default'\n    }\n\n    handleAfter.onMouseEnter = () => {\n      this.element.style.cursor = 'pointer'\n    }\n    handleAfter.onMouseLeave = () => {\n      this.element.style.cursor = 'default'\n    }\n    handleAfter.onMouseDrag = (event) => {\n      this.element.style.cursor = 'pointer'\n      const travelled = event.point.subtract(handleAfter.position)\n\n      const xChange = Math.abs(travelled.x) >= (spacing / 2)\n      const yChange = Math.abs(travelled.y) >= (spacing / 2)\n      if (xChange || yChange) {\n        const xSign = Math.sign(travelled.x)\n        const ySign = Math.sign(travelled.y)\n        const newPosition = handleAfter.position.add({\n          x: xSign * spacing * xChange,\n          y: ySign * spacing * yChange,\n        })\n\n        handleAfter.position = newPosition\n        handleAfterString.firstSegment.point = newPosition\n        this.onMove('IN', {\n          influence: -1 * xSign * Handle.STEP * xChange,\n          distance: ySign * Handle.STEP * yChange,\n        })\n        this.setVisualCurveHandles()\n      }\n    }\n    handleAfter.onMouseUp = () => {\n      this.element.style.cursor = 'default'\n    }\n  }\n\n\n  handleBefore = () => (\n    this.absoluteHandlePosition(this.keyframeBefore.handleOut.position)\n  )\n\n  handleAfter = () => (\n    this.absoluteHandlePosition(this.keyframeAfter.handleIn.position)\n  )\n\n  absoluteHandlePosition(handlePosition) {\n    return ([\n      handlePosition.x * this.width + this.padding,\n      // Compensates for 4th quadrant cartesian system\n      this.width - (handlePosition.y * this.width) + this.padding,\n    ])\n  }\n\n  setVisualCurveHandles() {\n    if (this.curve) {\n      this.curve.firstSegment.handleOut = new this.paper.Point(\n        this.keyframeBefore.handleOut.influence * this.width / Handle.MAX,\n        -1 * this.keyframeBefore.handleOut.distance * this.width / Handle.MAX\n      )\n      this.curve.lastSegment.handleIn = new this.paper.Point(\n        -1 * this.keyframeAfter.handleIn.influence * this.width / Handle.MAX,\n        this.keyframeAfter.handleIn.distance * this.width / Handle.MAX\n      )\n    }\n  }\n}\n\nexport default HandleEditor\n","import React from 'react'\nimport { observer } from 'mobx-react'\n\nimport Canvas from '../components/Canvas'\n\nimport HandleEditorInstance from '../prototypes/HandleEditor'\n\n@observer\nclass HandleEditor extends React.Component {\n  state = {}\n\n  handleEditor\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.keyframeKey !== undefined && prevProps.keyframeKey !== this.props.keyframeKey) {\n      if (this.handleEditor) this.handleEditor.destroy()\n      this.buildHandleEditorCanvas()\n    }\n  }\n\n  handleEditorHasSize = () => {\n    this.buildHandleEditorCanvas()\n  }\n\n  buildHandleEditorCanvas = () => {\n    const { width, keyframeBefore, keyframeAfter, onMove } = this.props\n\n    if (keyframeBefore && keyframeAfter) {\n      this.handleEditor = new HandleEditorInstance(width, keyframeBefore, keyframeAfter, onMove)\n      this.handleEditor.attatchTo('handle-editor')\n      this.handleEditor.init()\n    }\n  }\n\n  render() {\n    const { width, keyframeKey, keyframeBefore, keyframeAfter } = this.props\n\n    if (keyframeKey === undefined) {\n      return (\n        <h3 style={{ padding: '10px', color: 'darkgray' }}>\n          Select a Keyframe on the Timeline.\n        </h3>\n      )\n    }\n\n    if (keyframeBefore && !keyframeAfter) {\n      return (\n        <h3 style={{ padding: '10px', color: 'darkgray' }}>\n          <i>Selected tail Keyframe has no handle relationships.</i>\n        </h3>\n      )\n    }\n\n    return (\n      <div style={{ padding: '10px' }}>\n        <Canvas\n          id=\"handle-editor\"\n          width={width}\n          height={width}\n          hasSize={this.handleEditorHasSize}\n        />\n      </div>\n    )\n  }\n}\n\nexport default HandleEditor\n","import React from 'react'\nimport { observer } from 'mobx-react'\nimport paper from 'paper'\n\nimport Canvas from '../components/Canvas'\n\n@observer\nclass KeyframeEditor extends React.Component {\n  state = {\n    previouslyClickedKeyframe: undefined,\n  }\n\n  paper = new paper.PaperScope()\n  element\n\n  componentDidMount() {\n    document.addEventListener('keyup', this.handleKeyUp)\n  }\n\n  componentDidUpdate(prevProps) {\n    if (\n      prevProps.item !== undefined &&\n      this.props.item !== undefined &&\n      prevProps.item.key !== this.props.item.key\n    ) {\n      this.rebuild()\n    }\n\n    if (prevProps.now !== this.props.now) {\n      this.buildPlayhead()\n    }\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keyup', this.handleKeyUp)\n  }\n\n  keyframeEditorHasSize = () => {\n    this.buildKeyframeEditorCanvas()\n  }\n\n  handleKeyframeClick = (event) => {\n    event.stopPropagation()\n    const { currentTarget } = event\n\n    const { onSelect } = this.props\n    const { previouslyClickedKeyframe } = this.state\n\n    if (previouslyClickedKeyframe) {\n      previouslyClickedKeyframe.strokeWidth = 0\n      previouslyClickedKeyframe.shadowColor.alpha = 0\n    }\n    currentTarget.strokeWidth = 1\n    currentTarget.shadowColor.alpha = 0.3\n    onSelect(currentTarget.name)\n    this.setState({ previouslyClickedKeyframe: currentTarget })\n  }\n\n  handleKeyUp = (event) => {\n    const { key } = event\n    const { item, keyframeKey, keyframe, onSelect } = this.props\n    if (key === 'Backspace' || key === 'Delete') {\n      event.preventDefault()\n\n      const keyframeProp = keyframeKey.split('.')[1]\n      onSelect(undefined)\n      item.removeKey(keyframeProp, keyframe.frame)\n      this.rebuild()\n    }\n  }\n\n  buildKeyframeEditorCanvas = () => {\n    const { item } = this.props\n    this.element = document.getElementById('keyframe-editor')\n    this.paper.setup(this.element)\n\n    const { verticalSpacing, timelineStart, timelineEnd, timelineStep } = this.timelineMath()\n    let placementIndex = 0\n\n    const { playheadLine } = this.buildPlayhead()\n    const newKeyframeItems = []\n\n    Object.entries(item.keyframes).forEach(([prop, list]) => {\n      let propName = prop\n      const placing = placementIndex * verticalSpacing + verticalSpacing\n\n      if (prop === 'y') return // Interpret `x` & `y` at the same time\n      if (prop === 'x') {\n        propName = 'position'\n      }\n\n      // Draw Timelines\n      new this.paper.PointText({\n        point: [0, placing],\n        content: propName,\n        fillColor: 'black',\n        fontSize: 14,\n      })\n      const timelineHover = new this.paper.Path.Line({\n        name: 'timelineHover',\n        from: [timelineStart + 5, placing - 5],\n        to: [timelineEnd, placing - 5],\n        strokeColor: 'rgba(180, 180, 180, 1)',\n        strokeWidth: 40,\n      })\n      const timeline = new this.paper.Path.Line({\n        from: [timelineStart + 5, placing - 5],\n        to: [timelineEnd, placing - 5],\n        strokeColor: 'lightgrey',\n        strokeWidth: 4,\n      })\n\n      const newKeyframeRect = new this.paper.Path.Rectangle({\n        name: 'newKeyframeRect',\n        point: [0, placing - 10],\n        size: [10, 10],\n        radius: 3,\n        fillColor: 'rgba(31, 155, 255, 0.5)',\n        rotation: 45,\n        visible: false,\n      })\n      const newKeyframePlus = new this.paper.PointText({\n        point: [0, placing - 8],\n        content: '+',\n        fillColor: 'rgba(31, 155, 255, 0.5)',\n        fontSize: 14,\n        visible: false,\n      })\n\n      newKeyframeItems.push([timelineHover, newKeyframeRect, newKeyframePlus])\n\n      // TODO: Put these all in a group, including the playheadsegment, and apply one event\n      const newKeyframeHoverEffect = (event) => {\n        newKeyframeRect.visible = true\n        newKeyframePlus.visible = true\n        newKeyframeRect.position.x = event.point.x\n        newKeyframePlus.position.x = event.point.x + 10\n      }\n      const newKeyframeHide = () => {\n        newKeyframeRect.visible = false\n        newKeyframePlus.visible = false\n      }\n      const newKeyClick = (event) => {\n        const frame = Math.round((event.point.x - timelineStart) / timelineStep)\n        item.addKey(prop, frame)\n        // console.log(frame)\n        this.rebuild()\n      }\n\n      timelineHover.onMouseMove = newKeyframeHoverEffect\n      timelineHover.onMouseLeave = newKeyframeHide\n      timeline.onMouseMove = newKeyframeHoverEffect\n      timeline.onMouseLeave = newKeyframeHide\n\n      newKeyframeRect.onMouseMove = (event) => {\n        if (timelineHover.hitTest(event.point, { stroke: true, segments: false })) {\n          newKeyframeHoverEffect(event)\n        } else {\n          newKeyframeHide()\n        }\n      }\n\n      timelineHover.onClick = newKeyClick\n      timeline.onClick = newKeyClick\n      newKeyframeRect.onClick = newKeyClick\n\n      // Draw Keyframes\n      list.forEach((keyframe, keyframeIndex) => {\n        const keyframeRect = new this.paper.Path.Rectangle({\n          name: `${item.key}.${prop}.${keyframeIndex}`,\n          point: [timelineStart + keyframe.frame * timelineStep - 5, placing - 10],\n          size: [10, 10],\n          radius: 3,\n          fillColor: 'rgb(30, 155, 255)',\n          rotation: 45,\n          strokeColor: 'white',\n          strokeWidth: 0,\n          shadowColor: 'rgba(0, 0, 0, 0)',\n          shadowBlur: 5,\n        })\n\n        keyframeRect.on('mousedown', this.handleKeyframeClick)\n        keyframeRect.onMouseEnter = () => {\n          this.element.style.cursor = 'pointer'\n          newKeyframeHide()\n        }\n        keyframeRect.onMouseLeave = () => {\n          this.element.style.cursor = 'default'\n        }\n      })\n\n      placementIndex += 1\n    })\n\n    playheadLine.onMouseMove = (event) => {\n      newKeyframeItems.forEach(([\n        timelineHover,\n        newKeyframeRect,\n        newKeyframePlus,\n      ]) => {\n        if (timelineHover.hitTest(event.point)) {\n          /* eslint-disable no-param-reassign */\n          newKeyframeRect.visible = true\n          newKeyframePlus.visible = true\n          newKeyframeRect.position.x = event.point.x\n          newKeyframePlus.position.x = event.point.x + 10\n        } else {\n          newKeyframeRect.visible = false\n          newKeyframePlus.visible = false\n        }\n      })\n    }\n    playheadLine.bringToFront()\n  }\n\n  rebuild() {\n    this.paper.project.clear()\n    this.paper.project.remove()\n    this.buildKeyframeEditorCanvas()\n  }\n\n  buildPlayhead() {\n    const { size, now } = this.props\n    const { timelineStart, timelineStep } = this.timelineMath()\n    const playheadLine = new this.paper.Path.Line({\n      from: [timelineStart + now * timelineStep, 10],\n      to: [timelineStart + now * timelineStep, size.height - 10],\n      strokeColor: 'white',\n      strokeWidth: 1,\n    })\n    const playheadTriangle = new this.paper.Path.RegularPolygon({\n      center: [timelineStart + now * timelineStep, 10],\n      sides: 3,\n      radius: 6,\n      rotation: 180,\n      fillColor: 'white',\n    })\n    return { playheadLine, playheadTriangle }\n  }\n\n  timelineMath() {\n    const { size, frames } = this.props\n    const verticalSpacing = 40\n    const timelineStart = 80\n    const timelineEnd = size.width - verticalSpacing\n    const timelineWidth = timelineEnd - timelineStart\n    const timelineStep = timelineWidth / frames\n    return {\n      verticalSpacing,\n      timelineStart,\n      timelineEnd,\n      timelineWidth,\n      timelineStep,\n    }\n  }\n\n  render() {\n    const { size, item } = this.props\n\n    if (size === undefined || item === undefined) {\n      return (\n        <h3 style={{ padding: '10px', color: 'grey' }}>\n          Select an Item to view its Keyframes.\n        </h3>\n      )\n    }\n\n    return (\n      <div style={{ padding: '10px' }}>\n        <Canvas\n          id=\"keyframe-editor\"\n          width={size.width}\n          height={size.height}\n          hasSize={this.keyframeEditorHasSize}\n        />\n      </div>\n    )\n  }\n}\n\nexport default KeyframeEditor\n","import React, { Component } from 'react'\nimport { autorun } from 'mobx'\nimport { observer } from 'mobx-react'\n\nimport Viewer from './Viewer'\nimport HandleEditor from './HandleEditor'\nimport KeyframeEditor from './KeyframeEditor'\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\nimport { titleCase } from '../util/string'\n\n@observer\nclass AnimateMode extends Component {\n  state = {\n    heWidth: undefined,\n    keSize: undefined,\n    selectedItemKey: undefined,\n  }\n\n  autorunDisposer\n\n  componentDidMount() {\n    const { canvas } = this.props.store\n    const container = document.getElementById('view-container')\n    setTimeout(() => {\n      const width = Math.round(container.clientWidth) - 20\n      const height = Math.round((9 / 16) * width)\n      canvas.setSize(width, height)\n    }, 1)\n\n    const container2 = document.getElementById('handle-container')\n    setTimeout(() => {\n      const width = Math.round(container2.clientWidth) - 20\n      const height = Math.round(container2.clientHeight) - 20\n      const smallestLength = Math.min(width, height)\n      this.setState({ heWidth: smallestLength })\n    }, 1)\n\n    const container3 = document.getElementById('keyframe-container')\n    setTimeout(() => {\n      const width = Math.round(container3.clientWidth) - 20\n      const height = Math.round(container3.clientHeight) - 20\n      this.setState({ keSize: { width, height } })\n    }, 1)\n\n    this.autorunDisposer = autorun(() => {\n      if (canvas.selected) {\n        this.setState({ selectedItemKey: canvas.selected.key })\n      } else {\n        this.setState({ selectedItemKey: undefined })\n      }\n    })\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const { tools } = this.props.store\n    if (prevState.selectedItemKey !== this.state.selectedItemKey) {\n      tools.selectKeyframe(undefined)\n    }\n  }\n\n  componentWillUnmount() {\n    const { canvas, project, tools } = this.props.store\n    canvas.selectOff()\n    project.clear()\n    tools.selectKeyframe(undefined)\n    this.autorunDisposer()\n  }\n\n  onSetup = () => {\n    const { canvas } = this.props.store\n    canvas.build()\n    setTimeout(() => {\n      canvas.setTool(undefined)\n      canvas.setTool('SELECT')\n    }, 20)\n  }\n\n  changeHandlePosition = (handleType, { influence, distance }) => {\n    const { tools, canvas } = this.props.store\n    if (!tools.selectedKeyframe) return\n\n    const handleSuffix = titleCase(handleType)\n    const [kItem, kProp, kIndexStr] = tools.selectedKeyframe.split('.')\n    let kIndex = parseInt(kIndexStr)\n    if (handleType === 'IN') {\n      kIndex += 1\n    }\n\n    const targetHandle = canvas.animatables[kItem].keyframes[kProp][kIndex][`handle${handleSuffix}`]\n    let auxilaryHandle\n    if (kProp === 'x') {\n      auxilaryHandle = canvas.animatables[kItem].keyframes.y[kIndex][`handle${handleSuffix}`]\n    }\n\n    targetHandle.influence += influence\n    targetHandle.distance += distance\n\n    if (auxilaryHandle) {\n      auxilaryHandle.influence += influence\n      auxilaryHandle.distance += distance\n    }\n  }\n\n  render() {\n    const { canvas, animation, tools } = this.props.store\n    const { heWidth, keSize } = this.state\n\n    let keyframeBefore\n    let keyframeAfter\n    if (tools.selectedKeyframe) {\n      const [kItem, kProp, kIndexStr] = tools.selectedKeyframe.split('.')\n      const kIndex = parseInt(kIndexStr)\n      const keyframesOfType = canvas.animatables[kItem].keyframes[kProp]\n      keyframeBefore = keyframesOfType[kIndex]\n      if (kIndex + 1 < keyframesOfType.length) {\n        keyframeAfter = keyframesOfType[kIndex + 1]\n      }\n    }\n\n    return (\n      <Grid\n        gridTemplateRows=\"auto 340px\"\n        gridTemplateColumns=\"auto 400px\"\n      >\n        <GridItem id=\"view-container\" padding=\"10px\" gridArea=\"1 / 1 / 1 / 2\">\n          <Viewer canvas={canvas} animation={animation} onSetup={this.onSetup} />\n        </GridItem>\n        <GridItem id=\"handle-container\" gridArea=\"1 / 2 / 1 / 3\" backgroundColor=\"rgb(210, 210, 210)\">\n          <HandleEditor\n            width={heWidth}\n            keyframeKey={tools.selectedKeyframe}\n            keyframeBefore={keyframeBefore}\n            keyframeAfter={keyframeAfter}\n            onMove={this.changeHandlePosition}\n          />\n        </GridItem>\n        <GridItem id=\"keyframe-container\" gridArea=\"2 / 1 / 2 / 3\" backgroundColor=\"rgb(180, 180, 180)\">\n          <KeyframeEditor\n            size={keSize}\n            item={canvas.selected}\n            keyframeKey={tools.selectedKeyframe}\n            keyframe={keyframeBefore}\n            onSelect={tools.selectKeyframe}\n            frames={animation.frames}\n            now={animation.now}\n          />\n        </GridItem>\n      </Grid>\n    )\n  }\n}\n\nexport default AnimateMode\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\n@observer\nclass PlayController extends Component {\n  componentDidMount() {\n    document.addEventListener('keydown', this.handleKeyDown, false)\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeyDown, false)\n  }\n\n  handleKeyDown = (event) => {\n    const {\n      play,\n      pause,\n      goToNext,\n      goToPrev,\n      goToFirst,\n      goToLast,\n      playing,\n    } = this.props.animation\n    const { key, shiftKey } = event\n\n    if (key === 'ArrowLeft' && shiftKey) {\n      goToFirst()\n    } else if (key === 'ArrowLeft') {\n      goToPrev()\n    } else if (key === 'ArrowRight' && shiftKey) {\n      goToLast()\n    } else if (key === 'ArrowRight') {\n      goToNext()\n    } else if (key === ' ') {\n      event.stopPropagation()\n      event.preventDefault()\n      if (playing === true) {\n        pause()\n      } else {\n        play()\n      }\n    }\n  }\n\n  render() {\n    const {\n      play,\n      pause,\n      goToNext,\n      goToPrev,\n      goToFirst,\n      goToLast,\n      playing,\n    } = this.props.animation\n\n    return (\n      <Grid gridTemplateColumns=\"30% 1fr 1fr 1fr 1fr 1fr 30%\" height=\"60px\" alignItems=\"center\" justifyItems=\"center\" borderTop=\"1px solid rgb(230, 230, 230)\">\n        <GridItem gridColumnStart=\"2\">\n          <button type=\"button\" style={{ margin: 0 }} onClick={goToFirst}>&#8676;</button>\n        </GridItem>\n        <GridItem gridColumnStart=\"3\">\n          <button type=\"button\" style={{ margin: 0 }} onClick={goToPrev}>&#9667;</button>\n        </GridItem>\n        <GridItem gridColumnStart=\"4\">\n          { playing === false ?\n            <button type=\"button\" style={{ margin: 0 }} onClick={play}>&#9658;</button> :\n            <button type=\"button\" style={{ margin: 0 }} onClick={pause}>&#10073; &#10073;</button>\n          }\n        </GridItem>\n        <GridItem gridColumnStart=\"5\">\n          <button type=\"button\" style={{ margin: 0 }} onClick={goToNext}>\n            <div style={{ transform: 'rotate(180deg)' }}>&#9667;</div>\n          </button>\n        </GridItem>\n        <GridItem gridColumnStart=\"6\">\n          <button type=\"button\" style={{ margin: 0 }} onClick={goToLast}>&#8677;</button>\n        </GridItem>\n      </Grid>\n    )\n  }\n}\n\nexport default PlayController\n","import React from 'react'\n\nconst getWidth = () => (\n  window.innerWidth\n    || document.documentElement.clientWidth\n    || document.body.clientWidth\n)\n\nconst getHeight = () => (\n  window.innerHeight\n    || document.documentElement.clientHeight\n    || document.body.clientHeight\n)\n\nconst withWindowSize = Component => (\n  class extends React.Component {\n    state = {\n      width: getWidth(),\n      height: getHeight(),\n    }\n\n    componentDidMount() {\n      window.addEventListener('resize', this.updateDimensions)\n    }\n\n    componentWillUnmount() {\n      window.removeEventListener('resize', this.updateDimensions)\n    }\n\n    updateDimensions = () => {\n      const width = getWidth()\n      const height = getHeight()\n      this.setState({ width, height })\n    }\n\n    render() {\n      const { width, height } = this.state\n      return <Component width={width} height={height} {...this.props} />\n    }\n  }\n)\n\nexport default withWindowSize\nexport {\n  getWidth,\n  getHeight,\n}\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Viewer from './Viewer'\nimport PlayController from './PlayController'\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\nimport { getWidth } from '../components/withWindowSize'\n\n@observer\nclass ViewMode extends Component {\n  componentDidMount() {\n    const { canvas } = this.props.store\n    const width = getWidth() - 20\n    const height = Math.round((9 / 16) * width)\n    canvas.setSize(width, height)\n  }\n\n  componentWillUnmount() {\n    const { project } = this.props.store\n    project.clear()\n  }\n\n  onSetup = () => {\n    const { canvas } = this.props.store\n    canvas.build()\n  }\n\n  render() {\n    const { canvas, animation } = this.props.store\n    return (\n      <Grid\n        gridTemplateRows=\"auto 60px\"\n        alignItems=\"center\"\n      >\n        <GridItem padding=\"10px\">\n          <Viewer canvas={canvas} animation={animation} onSetup={this.onSetup} />\n        </GridItem>\n        <PlayController animation={animation} />\n      </Grid>\n    )\n  }\n}\n\nexport default ViewMode\n","var map = {\n\t\"./bare.min.css\": \"v4a6\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"zGb5\";"],"sourceRoot":""}