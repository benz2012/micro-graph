{"version":3,"sources":["webpack:///./src/js/prototypes/Canvas.js","webpack:///./src/js/prototypes/items/Rectangle.js","webpack:///./src/js/prototypes/ModeStore.js","webpack:///./src/js/util/observeAnimatableTree.js","webpack:///./src/js/prototypes/ToolsStore.js","webpack:///./src/js/store.js","webpack:///./src/js/util/storage.js","webpack:///./src/js/index.jsx","webpack:///./src/js/containers/App.jsx","webpack:///./src/js/components/Playbar.jsx","webpack:///./src/js/containers/Viewer.jsx","webpack:///./src/js/util/download.js","webpack:///./src/js/prototypes/Project.js","webpack:///./src/js/prototypes/items/Circle.js","webpack:///./src/js/containers/Gallery.jsx","webpack:///./src/js/components/GridItem.jsx","webpack:///./src/js/prototypes/Handle.js","webpack:///./src/js/util/string.js","webpack:///./src/js/prototypes/items/index.js","webpack:///./src/js/prototypes/Animation.js","webpack:///./src/js/components/Grid.jsx","webpack:///./src/css/index.js","webpack:///./src/js/containers/ToolController.jsx","webpack:///./src/js/components/IntegerInput.jsx","webpack:///./src/js/components/Modal.jsx","webpack:///./src/js/containers/PropertyEditor.jsx","webpack:///./src/js/containers/ProjectSettings.jsx","webpack:///./src/js/containers/ClearProject.jsx","webpack:///./src/js/containers/BuildMode.jsx","webpack:///./src/js/util/bezierCurve.js","webpack:///./src/js/prototypes/Keyframe.js","webpack:///./src/js/components/Canvas.jsx","webpack:///./src/js/containers/ExportMode.jsx","webpack:///./src/css/bare.min.css","webpack:///./src/js/prototypes/AnimatableItem.js","webpack:///./src/js/containers/ModeController.jsx","webpack:///./src/js/prototypes/HandleEditor.js","webpack:///./src/js/containers/HandleEditor.jsx","webpack:///./src/js/containers/KeyframeEditor.jsx","webpack:///./src/js/containers/AnimateMode.jsx","webpack:///./src/js/containers/PlayController.jsx","webpack:///./src/js/components/withWindowSize.jsx","webpack:///./src/js/containers/ViewMode.jsx","webpack:///./node_modules/file-loader/dist/cjs.js"],"names":["Canvas","rootStore","attatchAndSetup","id","element","document","getElementById","paper","setup","view","autoUpdate","background","Path","Rectangle","topLeft","bottomRight","width","height","fillColor","color","draw","animation","firstFrame","addListenersAndSelect","animatable","item","on","handleItemMouseDown","select","event","stopPropagation","currentTarget","handleViewMouseDown","deselect","forEachAnimatable","callback","Object","values","animatables","forEach","build","create","frame","frameToDraw","now","update","selectOn","selectOff","off","this","initialize","prevWidth","prevHeight","undefined","_color","tool","selected","setSize","entries","reduce","output","key","toJSON","setSizeAction","action","setTimeout","value","observable","remove","clone","nextTool","entering","toolId","prevTool","exiting","mode","settings","clear","name","AnimatableItem","radius","itemProps","position","x","y","absX","absolute","absY","absWidth","absHeight","point","size","Math","max","_width","recreate","_height","_radius","WIDTH","HEIGHT","RADIUS","Mode","current","m","observeAnimatableTree","observableObj","constructor","OBSERVABLES","map","keys","keyframes","keyFrType","Tools","selectedKeyframe","keyframe","RootStore","reset","project","canvas","tools","PaperScope","Project","Animation","ModeStore","ToolsStore","pathArray","window","location","pathname","split","storageEnabled","localStorage","setItem","e","length","projectObj","getItem","load","autorun","projectAsJSON","save","delay","reaction","store","appNode","ReactDOM","render","App","observer","Component","props","minHeight","gridTemplateRows","hot","module","Playbar","fullWidth","totalFrames","inPoint","outPoint","ABSOLUTE_FIRST","playbarWidth","per","marker","head","parseInt","tail","activeHead","activeTail","style","display","playbarStyle","backgroundColor","marginTop","margin","Viewer","canvasHasSize","onSetup","Fragment","hasSize","frames","lastFrame","FIRST","downloadJSON","data","basename","download","filename","type","file","Blob","navigator","msSaveOrOpenBlob","elm","createElement","url","URL","createObjectURL","href","body","appendChild","click","removeChild","revokeObjectURL","setIn","setOut","inputJSON","fileName","input","JSON","parse","setName","replace","inputItems","loadFromFile","targetFile","target","files","reader","FileReader","onload","result","readAsText","stringify","object","publish","console","log","inputBuilt","Circle","center","Gallery","state","clips","clip","json","buildAnimatables","play","itemKey","itemObj","itemClass","properties","items","add","inputKeyframes","accum","keyframeProp","keyframeList","Keyframe","fromJSON","initialClips","input1","obj","simpleHash","playable","setState","prevProps","prevState","container","round","clientWidth","padding","marginBottom","GridItem","children","Handle","influence","distance","_influence","_distance","MAX","newX","newY","titleCase","str","splitStr","toLowerCase","i","charAt","toUpperCase","substring","join","hash","charCodeAt","nextFrame","later","prevFrame","earlier","fps","playing","sync","requestId","f","goToFrame","animateAtRate","pause","cancelAnimationFrame","func","interval","then","Date","loop","requestAnimationFrame","delta","Grid","cssContext","require","ToolController","choose","preventDefault","setTool","addCircle","existing","circle","addRectangle","rect","onClick","primary","transform","IntegerInput","localValue","onChange","onBlur","setValue","possibleInt","Number","isInteger","handleKeyDown","shiftKey","incrementBy","decrementBy","changeBy","operation","amount","next","a","b","marginRight","textAlign","onKeyDown","Modal","open","handleClose","clickawayEl","useRef","onClickaway","contains","ref","content","PropertyEditor","propertySetter","property","existingKeyframe","find","addKey","scale","rotation","classControls","zIndex","left","top","overflow","border","ProjectSettings","setLength","setColor","closeModal","step","flexDirection","ClearProject","justifyContent","BuildMode","ready","inputItemsExist","autorunDisposer","Boolean","prevInputItemsExist","gridTemplateColumns","gridArea","alignSelf","makeRoot","real","imag","evaluate","A","B","C","D","q0","B1","C2","Q","dQ","getCubicRoots","X","b1","c2","evalInfo","q","dq","t","r","abs","s","sign","sqrt","x0","den","EPSILON","roots","push","quadInfo","qdrtc","X1","Y1","X2","Y2","Y","concat","bezierCurve","x2","x3","y2","y3","Error","xA","xB","xC","filter","toFixed","is","yA","yB","yC","cubic","c","d","handleIn","handleOut","sort","createCurve","k1","k2","interpolate","curve","timeRatio","valueRatio","testForAvailability","ExportMode","loadThenBuild","set","saveThenDownload","justifyItems","htmlFor","exports","dimension","fraction","valueForFrame","includes","indexOf","where","before","after","hue","floor","random","saturation","brightness","class","prop","rotate","ignorePairings","valueToKey","k","paired","valueToPair","kP","keyframesPaired","updateKeyframes","keyframesY","setCanvas","sharedProps","onCreate","setUntrackedValues","xKeyframes","yKeyframes","xValue","yValue","activeLayer","_x","_y","_scale","scaleBy","_rotation","rotateBy","_fillColor","SCALE","ROTATION","FILL_COLOR","ModeController","navigate","textContent","borderBottom","alignItems","HandleEditor","trueWidth","keyframeBefore","keyframeAfter","onMove","attatchTo","handleBefore","absoluteHandlePosition","handleAfter","topRight","bottomLeft","spacing","STEP","gridline","SymbolDefinition","Line","from","to","strokeColor","strokeWidth","offset","place","Point","setVisualCurveHandles","stringStyle","handleBeforeString","handleAfterString","handleMovable","Color","handleStationary","onMouseEnter","cursor","onMouseLeave","onMouseDrag","travelled","subtract","xChange","yChange","xSign","ySign","newPosition","lastSegment","onMouseUp","firstSegment","handlePosition","handleEditor","handleEditorHasSize","buildHandleEditorCanvas","HandleEditorInstance","init","React","keyframeKey","destroy","KeyframeEditor","previouslyClickedKeyframe","keyframeEditorHasSize","buildKeyframeEditorCanvas","handleKeyframeClick","onSelect","shadowColor","alpha","handleKeyUp","removeKey","rebuild","timelineMath","verticalSpacing","timelineStart","timelineEnd","timelineStep","placementIndex","playheadLine","buildPlayhead","newKeyframeItems","list","propName","placing","PointText","fontSize","timelineHover","timeline","newKeyframeRect","visible","newKeyframePlus","newKeyframeHoverEffect","newKeyframeHide","newKeyClick","onMouseMove","hitTest","stroke","segments","keyframeIndex","keyframeRect","shadowBlur","bringToFront","addEventListener","removeEventListener","playheadTriangle","RegularPolygon","sides","timelineWidth","AnimateMode","heWidth","keSize","selectedItemKey","changeHandlePosition","handleType","handleSuffix","kItem","kProp","kIndexStr","kIndex","auxilaryHandle","targetHandle","container2","clientHeight","smallestLength","min","container3","selectKeyframe","keyframesOfType","PlayController","goToNext","goToPrev","goToFirst","goToLast","borderTop","gridColumnStart","getWidth","innerWidth","documentElement","ViewMode","webpackContext","req","webpackContextResolve","__webpack_require__","o","code","webpackContextKeys","resolve"],"mappings":"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","file":"app.12f55624.js","sourcesContent":["import { observable, action } from 'mobx'\n\nclass Canvas {\n  @observable width\n  @observable height\n  @observable _color\n  @observable background\n  @observable animatables\n  @observable tool\n  @observable selected\n\n  constructor(rootStore) {\n    this.rootStore = rootStore\n    this.paper = rootStore.paper\n    this.initialize()\n  }\n\n  initialize() {\n    let prevWidth\n    let prevHeight\n    if (this.width !== undefined) {\n      prevWidth = this.width\n      prevHeight = this.height\n    }\n\n    this.width = undefined\n    this.height = undefined\n    this._color = '#000000'\n    this.animatables = {}\n    this.tool = undefined\n    this.selected = undefined\n\n    if (prevWidth !== undefined) {\n      this.setSize(prevWidth, prevHeight)\n    }\n  }\n\n  toJSON() {\n    return ({\n      color: this.color,\n      animatables: Object.entries(this.animatables).reduce((output, [key, animatable]) => {\n        output[key] = animatable.toJSON() // eslint-disable-line\n        return output\n      }, {}),\n    })\n  }\n\n  setSize(width, height) {\n    // allows the canvas element one tick to recognize size changes\n    const setSizeAction = action(() => {\n      this.height = height\n      this.width = width\n    })\n    setTimeout(setSizeAction, 1)\n  }\n\n  attatchAndSetup = (id) => {\n    const element = document.getElementById(id)\n    this.paper.setup(element)\n    this.paper.view.autoUpdate = false\n    this.background = new this.paper.Path.Rectangle({\n      topLeft: [0, 0],\n      bottomRight: [this.paper.view.element.width, this.paper.view.element.height],\n      fillColor: this.color,\n    })\n    this.draw(this.rootStore.animation.firstFrame)\n  }\n\n  get color() { return this._color }\n  set color(value) {\n    this._color = value\n    this.background.fillColor = value\n  }\n\n  @action add = (animatable) => {\n    animatable.create(this)\n    this.animatables = {\n      ...this.animatables,\n      [animatable.key]: animatable,\n    }\n\n    if (this.tool === 'SELECT') {\n      this.addListenersAndSelect(animatable)\n    }\n\n    this.draw()\n  }\n\n  @action remove = (animatable) => {\n    animatable.item.off('mousedown', this.handleItemMouseDown)\n    animatable.item.remove()\n\n    const clone = { ...this.animatables }\n    delete clone[animatable.key]\n    this.animatables = clone\n    this.draw()\n  }\n\n  @action setTool = (nextTool) => {\n    const prevTool = this.tool\n\n    const entering = toolId => (prevTool !== toolId && nextTool === toolId)\n    const exiting = toolId => (prevTool === toolId && nextTool !== toolId)\n\n    if (entering('SELECT')) { this.selectOn() }\n    if (exiting('SELECT')) { this.selectOff() }\n\n    if (entering('SETTINGS')) { this.rootStore.mode.settings = true }\n    if (exiting('SETTINGS')) { this.rootStore.mode.settings = false }\n\n    if (entering('CLEAR')) { this.rootStore.mode.clear = true }\n    if (exiting('CLEAR')) { this.rootStore.mode.clear = false }\n\n    // Finally, set the tool in-memory\n    this.tool = nextTool\n  }\n\n  @action select = (item) => {\n    this.deselect()\n    item.selected = true // eslint-disable-line no-param-reassign\n    this.selected = this.animatables[item.name]\n    this.paper.view.update()\n  }\n\n  @action deselect = () => {\n    if (this.selected) {\n      this.selected.item.selected = false\n      this.selected = undefined\n    }\n    this.paper.view.update()\n  }\n\n  addListenersAndSelect = (animatable) => {\n    animatable.item.on('mousedown', this.handleItemMouseDown)\n    this.select(animatable.item)\n  }\n\n  handleItemMouseDown = (event) => {\n    event.stopPropagation()\n    this.select(event.currentTarget)\n  }\n\n  handleViewMouseDown = (event) => {\n    event.stopPropagation()\n    this.deselect()\n  }\n\n  forEachAnimatable = callback => (\n    Object.values(this.animatables).forEach(callback)\n  )\n\n  build = () => {\n    this.forEachAnimatable((animatable) => { animatable.create(this) })\n    this.draw()\n  }\n\n  draw = (frame) => {\n    const frameToDraw = frame || this.rootStore.animation.now\n    this.forEachAnimatable((animatable) => { animatable.draw(frameToDraw) })\n    if (this.paper.view) this.paper.view.update()\n  }\n\n  selectOn = () => {\n    this.forEachAnimatable((animatable) => {\n      animatable.item.on('mousedown', this.handleItemMouseDown)\n    })\n    this.paper.view.on('mousedown', this.handleViewMouseDown)\n  }\n\n  selectOff = () => {\n    this.forEachAnimatable((animatable) => {\n      animatable.item.off('mousedown', this.handleItemMouseDown)\n    })\n    this.paper.view.off('mousedown', this.handleViewMouseDown)\n    this.deselect()\n  }\n}\n\nexport default Canvas\n","import { observable } from 'mobx'\n\nimport AnimatableItem from '../AnimatableItem'\n\nclass Rectangle extends AnimatableItem {\n  // Canvas Size Relative Values (0-100)\n  static get WIDTH() { return 10 }\n  static get HEIGHT() { return 10 }\n  static get RADIUS() { return 0 }\n\n  @observable _width = Rectangle.WIDTH\n  @observable _height = Rectangle.HEIGHT\n  @observable _radius = Rectangle.RADIUS\n\n  toJSON() {\n    return ({\n      ...super.toJSON(),\n      width: this.width,\n      height: this.height,\n      radius: this.radius,\n    })\n  }\n\n  get width() { return this._width }\n  get height() { return this._height }\n  get radius() { return this._radius }\n\n  set width(value) {\n    // TODO: update this value using item.bounds and scale\n    this._width = value\n    this.recreate()\n  }\n\n  set height(value) {\n    // TODO: update this value using item.bounds and scale\n    this._height = value\n    this.recreate()\n  }\n\n  set radius(value) {\n    // TODO: update this value using item.bounds and scale\n    this._radius = value\n    this.recreate()\n  }\n\n  onCreate(itemProps) {\n    const { x, y } = this.position\n    const absX = this.absolute(x)\n    const absY = this.absolute(y, 'height')\n    const absWidth = this.absolute(this.width)\n    const absHeight = this.absolute(this.height)\n\n    new this.paper.Path.Rectangle({\n      ...itemProps,\n      point: [absX - (absWidth / 2), absY - (absHeight / 2)],\n      size: [absWidth, absHeight],\n      radius: (this.radius / 100) * (Math.max(absWidth, absHeight) / 2),\n    })\n  }\n}\n\nexport default Rectangle\n","import { observable, action } from 'mobx'\n\nclass Mode {\n  @observable current\n  @observable settings\n  @observable clear\n\n  constructor() {\n    this.initialize()\n  }\n\n  initialize() {\n    this.current = 'BUILD'\n    this.settings = false\n    this.clear = false\n  }\n\n  @action set = (m) => {\n    this.current = m\n  }\n}\n\nexport default Mode\n","const observeAnimatableTree = (observableObj) => {\n  const observableKeys = observableObj.constructor.OBSERVABLES\n  return observableKeys.map((key) => {\n    if (key === 'keyframes') {\n      return Object.keys(observableObj.keyframes).map(keyFrType => (\n        observableObj.keyframes[keyFrType].map(observeAnimatableTree)\n      ))\n    }\n\n    const value = observableObj[key]\n    if (value.constructor.OBSERVABLES) {\n      return observeAnimatableTree(value)\n    }\n\n    return value\n  })\n}\n\nexport default observeAnimatableTree\n","import { observable, action } from 'mobx'\n\nclass Tools {\n  @observable selectedKeyframe\n\n  constructor() {\n    this.initialize()\n  }\n\n  initialize() {\n    this.selectedKeyframe = undefined\n  }\n\n  @action selectKeyframe = (keyframe) => {\n    this.selectedKeyframe = keyframe\n  }\n}\n\nexport default Tools\n","import { observable, reaction, autorun } from 'mobx'\nimport paper from 'paper'\n\nimport Project from './prototypes/Project'\nimport Canvas from './prototypes/Canvas'\nimport Animation from './prototypes/Animation'\nimport ModeStore from './prototypes/ModeStore'\nimport ToolsStore from './prototypes/ToolsStore'\n\nimport observeAnimatableTree from './util/observeAnimatableTree'\nimport { storageEnabled } from './util/storage'\n\nclass RootStore {\n  @observable project\n  @observable canvas\n  @observable animation\n  @observable mode\n  @observable tools\n\n  constructor() {\n    this.paper = new paper.PaperScope()\n\n    this.project = new Project(this)\n    this.canvas = new Canvas(this)\n    this.animation = new Animation()\n    this.mode = new ModeStore()\n    this.tools = new ToolsStore()\n\n    // Auto Save & Auto Load\n    const { pathname } = window.location\n    const pathArray = pathname.split('/')\n\n    if (\n      storageEnabled() &&\n      (pathArray.length > 1 && pathArray[1] !== 'gallery')\n    ) {\n      const projectObj = localStorage.getItem('micrograph.project')\n      if (projectObj) {\n        setTimeout(() => {\n          this.project.load(projectObj)\n        }, 100)\n      }\n\n      autorun(() => {\n        const projectAsJSON = this.project.save()\n        localStorage.setItem('micrograph.project', projectAsJSON)\n      }, { delay: 300 })\n    }\n\n    // Reacts to all changes made to animatable item properties and redraws the canvas\n    reaction(\n      () => ([\n        this.animation.now,\n        this.canvas.color,\n        Object.values(this.canvas.animatables).map(observeAnimatableTree),\n      ]),\n      () => this.canvas.draw()\n    )\n  }\n\n  reset = () => {\n    this.project.initialize()\n    this.canvas.initialize()\n    this.animation.initialize()\n    this.mode.initialize()\n    this.tools.initialize()\n  }\n}\n\nexport default RootStore\n","const storageEnabled = () => {\n  try {\n    localStorage.setItem('_test', 'test')\n  } catch (e) {\n    return false\n  }\n  return true\n}\n\nconst storageSet = (key, value) => {\n  localStorage.setItem(key, JSON.stringify(value))\n}\n\nconst storageGet = (key) => {\n  const value = localStorage.getItem(key)\n  return value && JSON.parse(value)\n}\n\nexport {\n  storageEnabled,\n  storageSet,\n  storageGet,\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\n\n// Root Application Container\nimport App from './containers/App'\nimport RootStore from './store'\n\n// Styles\nimport '../css'\n\nconst store = new RootStore()\nconst appNode = document.getElementById('app')\n\nReactDOM.render(\n  <App store={store} />,\n  appNode\n)\n","import React, { Component } from 'react'\nimport { hot } from 'react-hot-loader'\nimport { observer } from 'mobx-react'\n\nimport ModeController from './ModeController'\nimport BuildMode from './BuildMode'\nimport AnimateMode from './AnimateMode'\nimport ViewMode from './ViewMode'\nimport ExportMode from './ExportMode'\nimport Gallery from './Gallery'\nimport Grid from '../components/Grid'\n\n@observer\nclass App extends Component {\n  componentDidMount() {\n    // const { store } = this.props\n    // store.canvas.setTool('SETTINGS')\n  }\n\n  render() {\n    const { store } = this.props\n    const { pathname } = window.location\n\n    const pathArray = pathname.split('/')\n    if (pathArray.length > 1 && pathArray[1] === 'gallery') return <Gallery />\n\n    return (\n      <Grid\n        minHeight=\"100vh\"\n        gridTemplateRows=\"60px 1fr\"\n      >\n        <ModeController mode={store.mode} />\n        {store.mode.current === 'BUILD' &&\n          <BuildMode store={store} />\n        }\n        {store.mode.current === 'ANIMATE' &&\n          <AnimateMode store={store} />\n        }\n        {store.mode.current === 'VIEW' &&\n          <ViewMode store={store} />\n        }\n        {store.mode.current === 'EXPORT' &&\n          <ExportMode store={store} />\n        }\n      </Grid>\n    )\n  }\n}\n\nexport default hot(module)(App)\n","import React from 'react'\n\nconst playbarStyle = { height: '10px', margin: '10px 0px' }\n\nconst Playbar = ({\n  fullWidth,\n  totalFrames,\n  inPoint,\n  outPoint,\n  now,\n  ABSOLUTE_FIRST,\n}) => {\n  const playbarWidth = fullWidth || 0\n\n  const per = playbarWidth / totalFrames\n  const marker = totalFrames > 1 ? per : 0\n  const head = parseInt((inPoint - ABSOLUTE_FIRST) * per)\n  const tail = parseInt((totalFrames - outPoint) * per)\n\n  let activeHead = parseInt((now * per) - head)\n  if (totalFrames === 1) {\n    activeHead = per\n  } else if (now === inPoint) {\n    activeHead = 0\n  } else if (now === outPoint) {\n    activeHead = playbarWidth - head - tail - marker\n  }\n  const activeTail = now === outPoint ? 0 : playbarWidth - head - tail - activeHead - marker\n\n  return (\n    <div style={{ display: 'flex' }}>\n      <div style={{\n        ...playbarStyle,\n        width: head,\n        backgroundColor: 'rgb(150, 160, 170)' }}\n      />\n      <div style={{\n        ...playbarStyle,\n        width: activeHead,\n        backgroundColor: 'rgb(220, 225, 240)' }}\n      />\n      <div style={{\n        ...playbarStyle,\n        width: marker,\n        height: '20px',\n        marginTop: '5px',\n        backgroundColor: 'rgb(30, 155, 255)' }}\n      />\n      <div style={{\n        ...playbarStyle,\n        width: activeTail,\n        backgroundColor: 'rgb(220, 225, 240)' }}\n      />\n      <div style={{\n        ...playbarStyle,\n        width: tail,\n        backgroundColor: 'rgb(150, 160, 170)' }}\n      />\n    </div>\n  )\n}\n\nexport default Playbar\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Animation from '../prototypes/Animation'\nimport Canvas from '../components/Canvas'\nimport Playbar from '../components/Playbar'\n\n@observer\nclass Viewer extends Component {\n  canvasHasSize = () => {\n    const { canvas, onSetup } = this.props\n    canvas.attatchAndSetup('paper-canvas')\n    onSetup()\n  }\n\n  render() {\n    const { canvas, animation } = this.props\n    return (\n      <React.Fragment>\n        <Canvas\n          id=\"paper-canvas\"\n          width={canvas.width}\n          height={canvas.height}\n          hasSize={this.canvasHasSize}\n        />\n        <Playbar\n          fullWidth={canvas.width}\n          totalFrames={animation.frames}\n          inPoint={animation.firstFrame}\n          outPoint={animation.lastFrame}\n          now={animation.now}\n          ABSOLUTE_FIRST={Animation.FIRST}\n        />\n      </React.Fragment>\n    )\n  }\n}\n\nexport default Viewer\n","const download = (data, filename, type) => {\n  const file = new Blob([data], { type })\n  if (window.navigator.msSaveOrOpenBlob) {\n    window.navigator.msSaveOrOpenBlob(file, filename)\n  } else {\n    const elm = document.createElement('a')\n    const url = window.URL.createObjectURL(file)\n\n    elm.href = url\n    elm.download = filename\n\n    document.body.appendChild(elm)\n    elm.click()\n\n    setTimeout(() => {\n      document.body.removeChild(elm)\n      window.URL.revokeObjectURL(url)\n    })\n  }\n}\n\nconst downloadJSON = (data, basename) => (\n  download(data, `${basename}.json`, 'text/json')\n)\n\nexport {\n  download,\n  downloadJSON,\n}\n","import { observable, action } from 'mobx'\n\nimport Animation from './Animation'\nimport { downloadJSON } from '../util/download'\n\nclass Project {\n  @observable name\n  @observable inputItems\n  @observable inputBuilt\n\n  constructor(rootStore) {\n    this.rootStore = rootStore\n    this.paper = rootStore.paper\n    this.initialize()\n  }\n\n  initialize() {\n    if (this.paper.project) {\n      this.paper.project.clear()\n      this.paper.project.remove()\n    }\n    this.name = 'My Animation'\n    this.inputItems = undefined\n    this.inputBuilt = false\n  }\n\n  toJSON() {\n    return ({\n      name: this.name,\n    })\n  }\n\n  @action setName(name) {\n    this.name = name\n  }\n\n  clear = () => {\n    this.paper.project.clear()\n    this.paper.project.remove()\n\n    const { canvas, animation } = this.rootStore\n    canvas.setSize(undefined, undefined)\n    animation.setIn(Animation.FIRST)\n    animation.setOut(animation.frames)\n  }\n\n  load = (inputJSON, fileName, callback) => {\n    const { canvas, animation } = this.rootStore\n    const input = JSON.parse(inputJSON)\n\n    const name = fileName || input.project.name\n    this.setName(name.replace(/\\.[^/.]+$/, ''))\n\n    Object.keys(input.animation).forEach((key) => {\n      animation[key] = input.animation[key]\n    })\n\n    Object.keys(input.canvas).forEach((key) => {\n      if (key === 'animatables') {\n        this.inputItems = input.canvas.animatables\n      } else {\n        canvas[key] = input.canvas[key]\n      }\n    })\n\n    if (callback) callback()\n  }\n\n  loadFromFile = (event, callback) => {\n    const { files } = event.target\n    const targetFile = files[0]\n    const reader = new FileReader()\n    reader.onload = () => this.load(reader.result, targetFile.name, callback)\n\n    this.rootStore.reset()\n    reader.readAsText(targetFile)\n  }\n\n  save = () => {\n    /* eslint no-param-reassign: 0 */\n    const { canvas, animation } = this.rootStore\n    const projectAsJSON = JSON.stringify({\n      project: this.toJSON(),\n      animation: animation.toJSON(),\n      canvas: canvas.toJSON(),\n    })\n    return projectAsJSON\n  }\n\n  download = (object) => {\n    downloadJSON(object, this.name)\n  }\n\n  publish = () => {\n    console.log('publishing project')\n  }\n\n  // render() {\n  //   // render canvas animation to frames\n  // }\n}\n\nexport default Project\n","import { observable } from 'mobx'\n\nimport AnimatableItem from '../AnimatableItem'\n\nclass Circle extends AnimatableItem {\n  // Canvas Size Relative Values (0-100)\n  static get RADIUS() { return 10 }\n\n  @observable _radius = Circle.RADIUS\n\n  toJSON() {\n    return ({\n      ...super.toJSON(),\n      radius: this.radius,\n    })\n  }\n\n  get radius() { return this._radius }\n  set radius(value) {\n    // TODO: update this value using item.bounds and scale\n    this._radius = value\n    this.recreate()\n  }\n\n  onCreate(itemProps) {\n    const { x, y } = this.position\n    new this.paper.Path.Circle({\n      ...itemProps,\n      center: [this.absolute(x), this.absolute(y, 'height')],\n      radius: this.absolute(this.radius) / 2,\n    })\n  }\n}\n\nexport default Circle\n","import React, { Component } from 'react'\nimport { reaction } from 'mobx'\nimport { observer } from 'mobx-react'\nimport paper from 'paper'\n\nimport CanvasEl from '../components/Canvas'\n\nimport Project from '../prototypes/Project'\nimport Canvas from '../prototypes/Canvas'\nimport Animation from '../prototypes/Animation'\nimport Keyframe from '../prototypes/Keyframe'\nimport items from '../prototypes/items'\n\nimport { simpleHash } from '../util/string'\n\nimport input1 from '../../json/gallery_input_1.json'\n\nconst playable = () => {\n  const obj = {}\n  obj.paper = new paper.PaperScope()\n  obj.project = new Project(obj)\n  obj.canvas = new Canvas(obj)\n  obj.animation = new Animation()\n  return obj\n}\n\n@observer\nclass Gallery extends Component {\n  state = {\n    clips: [],\n  }\n\n  componentDidMount() {\n    // TODO: fetch state from database\n    const response = [input1].map(obj => JSON.stringify(obj))\n    const initialClips = response.map(json => ({\n      key: `${simpleHash(json)}`,\n      json,\n      clip: playable(),\n    }))\n    this.setState({ clips: initialClips })\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevState.clips.length === 0 && this.state.clips.length !== 0) {\n      const container = document.getElementById('playback-container')\n      setTimeout(() => {\n        const width = Math.round(container.clientWidth) - 20\n        const height = Math.round((9 / 16) * width)\n        this.state.clips.forEach(({ clip }) => {\n          clip.canvas.setSize(width, height)\n        })\n      })\n\n      this.state.clips.forEach(({ clip }) => {\n        reaction(\n          () => ([\n            clip.animation.now,\n          ]),\n          () => clip.canvas.draw()\n        )\n      })\n    }\n  }\n\n  canvasHasSize = (key, clip, json) => () => {\n    clip.canvas.attatchAndSetup(`paper-canvas-${key}`)\n    clip.canvas.build()\n    clip.project.load(json)\n    this.buildAnimatables(clip)\n    clip.animation.play()\n  }\n\n  buildAnimatables = (clip) => {\n    Object.entries(clip.project.inputItems).forEach(([itemKey, itemObj]) => {\n      const { class: itemClass, keyframes, ...properties } = itemObj\n\n      const animatable = new items[itemClass](itemKey)\n      clip.canvas.add(animatable)\n\n      const inputKeyframes = Object.entries(keyframes)\n        .reduce((accum, [keyframeProp, keyframeList]) => {\n          /* eslint no-param-reassign: 0 */\n          accum[keyframeProp] = keyframeList.map(Keyframe.fromJSON)\n          return accum\n        }, {})\n      animatable.keyframes = {\n        ...this.keyframes,\n        ...inputKeyframes,\n      }\n\n      Object.entries(properties).forEach(([key, value]) => {\n        animatable[key] = value\n      })\n    })\n\n    clip.canvas.deselect()\n    clip.canvas.draw()\n  }\n\n  render() {\n    const { clips } = this.state\n\n    return (\n      <div>\n        <div style={{ width: '100%', padding: '10px' }}>\n          <h1 style={{ marginBottom: '0px' }}>Welcome to the Gallery</h1>\n          <small>Last {clips.length} Published Animations</small>\n        </div>\n\n        <div style={{ width: '100%', padding: '10px' }}>\n          <h3><em>This page doesn't work yet, I still need to build it. Please don't try to <strong>publish</strong> anything yet</em></h3>\n        </div>\n\n        <div id=\"playback-container\" style={{ width: '100%', padding: '0px 10px' }}>\n          {clips.map(({ clip, key, json }) => (\n            <div key={key} style={{ padding: '10px 0px' }}>\n              <CanvasEl\n                id={`paper-canvas-${key}`}\n                width={clip.canvas.width}\n                height={clip.canvas.height}\n                hasSize={this.canvasHasSize(key, clip, json)}\n              />\n            </div>\n          ))}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Gallery\n","import React from 'react'\n\nconst GridItem = ({ id, children, ...style }) => (\n  <div id={id} style={style}>\n    {children}\n  </div>\n)\n\nexport default GridItem\n","import { observable } from 'mobx'\n\nclass Handle {\n  static get MAX() { return 100 }\n  static get STEP() { return 10 }\n  static get OBSERVABLES() {\n    return ['influence', 'distance']\n  }\n\n  @observable _influence\n  @observable _distance\n\n  constructor(type) {\n    this.type = type\n    this.influence = 50\n    this.distance = 0\n  }\n\n  toJSON() {\n    return ({\n      type: this.type,\n      influence: this.influence,\n      distance: this.distance,\n    })\n  }\n\n  get influence() { return this._influence }\n  get distance() { return this._distance }\n  get position() {\n    let x = this.influence\n    let y = this.distance\n    if (this.type === 'IN') {\n      x = Handle.MAX - this.influence\n      y = Handle.MAX - this.distance\n    }\n    x /= Handle.MAX\n    y /= Handle.MAX\n    return { x, y }\n  }\n\n  set influence(value) {\n    this._influence = value\n  }\n\n  set distance(value) {\n    this._distance = value\n  }\n\n  set position({ x, y }) {\n    const newX = x * Handle.MAX\n    const newY = x * Handle.MAX\n    if (this.type === 'IN') {\n      this.influence = Handle.MAX - newX\n      this.distance = Handle.MAX - newY\n    } else {\n      this.influence = newX\n      this.distance = newY\n    }\n  }\n}\n\nexport default Handle\n","const titleCase = (str) => {\n  /* Convert `any string` into `Any String`, including replacing underscores\n    with spaces */\n  const splitStr = str.toLowerCase().split(/[\\s_]+/)\n  for (let i = 0; i < splitStr.length; i += 1) {\n    splitStr[i] = splitStr[i].charAt(0).toUpperCase() + splitStr[i].substring(1)\n  }\n  return splitStr.join(' ')\n}\n\nconst simpleHash = (str) => {\n  /* eslint no-bitwise: 0 */\n  let hash = 0\n  if (str.length === 0) return hash\n\n  for (let i = 0; i < str.length; i += 1) {\n    const char = str.charCodeAt(i)\n    hash = ((hash << 5) - hash) + char\n    hash &= hash\n  }\n\n  return hash\n}\n\nexport {\n  titleCase,\n  simpleHash,\n}\n","import Circle from './Circle'\nimport Rectangle from './Rectangle'\n\nconst items = {\n  Circle,\n  Rectangle,\n}\n\nexport default items\n","import { observable, action } from 'mobx'\n\nclass Animation {\n  static get FIRST() { return 1 }\n  static get PLAYBACK_MODES() { return ['LOOP', 'ONCE'] }\n\n  @observable frames\n  @observable firstFrame\n  @observable lastFrame\n  @observable fps\n  @observable now\n  @observable playing\n  @observable sync\n  @observable requestId\n  @observable mode\n\n  constructor() {\n    this.initialize()\n  }\n\n  initialize() {\n    this.frames = 100\n    this.firstFrame = Animation.FIRST\n    this.lastFrame = 100\n    this.fps = 30\n    this.now = this.firstFrame\n    this.playing = false\n    this.sync = 0\n    this.requestId = null\n    this.mode = 'LOOP'\n  }\n\n  toJSON() {\n    return ({\n      frames: this.frames,\n      firstFrame: this.firstFrame,\n      lastFrame: this.lastFrame,\n      fps: this.fps,\n      mode: this.mode,\n    })\n  }\n\n  @action setLength(length) {\n    this.frames = length\n    if (length < this.lastFrame) {\n      this.lastFrame = length\n    }\n  }\n\n  @action setIn = (f) => {\n    if (f < Animation.FIRST || f > this.frames) return\n    this.firstFrame = f\n    if (this.now < f) {\n      this.goToFrame(f)\n    }\n  }\n\n  @action setOut = (f) => {\n    if (f < Animation.FIRST || f > this.frames) return\n    this.lastFrame = f\n    if (this.now > f) {\n      this.goToFrame(f)\n    }\n  }\n\n  nextFrame = () => {\n    const later = this.now + 1\n    if (later > this.lastFrame) {\n      if (this.mode === 'LOOP') return this.firstFrame\n      return null\n    }\n    return later\n  }\n\n  prevFrame = () => {\n    const earlier = this.now - 1\n    if (earlier < this.firstFrame) {\n      if (this.mode === 'LOOP') return this.lastFrame\n      return null\n    }\n    return earlier\n  }\n\n  @action play = () => {\n    if (this.nextFrame() === null) return\n    this.playing = true\n    this.animateAtRate(() => {\n      const nextFrame = this.nextFrame()\n      if (nextFrame === null) return this.pause()\n      this.now = nextFrame\n    })\n  }\n\n  @action pause = () => {\n    this.playing = false\n    if (this.requestId) cancelAnimationFrame(this.requestId)\n  }\n\n  @action goToFrame = (frame) => {\n    this.now = frame\n  }\n\n  @action goToFirst = () => {\n    this.goToFrame(this.firstFrame)\n  }\n\n  @action goToLast = () => {\n    this.goToFrame(this.lastFrame)\n  }\n\n  @action goToNext = () => {\n    const nextFrame = this.nextFrame()\n    if (nextFrame === null) return\n    this.goToFrame(nextFrame)\n  }\n\n  @action goToPrev = () => {\n    const prevFrame = this.prevFrame()\n    if (prevFrame === null) return\n    this.goToFrame(prevFrame)\n  }\n\n  @action animateAtRate = (func) => {\n    const interval = 1000 / this.fps\n    let then = Date.now()\n\n    const loop = () => {\n      if (this.playing === false) return\n      this.requestId = requestAnimationFrame(loop)\n      const now = Date.now()\n      const delta = now - then\n      if (delta >= interval) {\n        then = now - (delta % interval)\n        this.sync = Math.round(delta - interval - (delta % interval))\n        func()\n      }\n    }\n    loop()\n  }\n}\n\nexport default Animation\n","import React from 'react'\n\nconst Grid = ({ children, ...style }) => (\n  <div style={{ display: 'grid', ...style }}>\n    {children}\n  </div>\n)\n\nexport default Grid\n","const cssContext = require.context(\n  '!!file-loader?name=[name].[ext]!.',\n  true,\n  /\\.(css)$/\n)\n\ncssContext.keys().forEach(cssContext)\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Circle from '../prototypes/items/Circle'\nimport Rectangle from '../prototypes/items/Rectangle'\n\n@observer\nclass ToolController extends Component {\n  choose = (event) => {\n    event.preventDefault()\n    this.props.setTool(event.currentTarget.id)\n  }\n\n  addCircle = () => {\n    const { existing } = this.props\n    const circle = new Circle(`circle-${Object.keys(existing).length}`)\n    this.props.add(circle)\n  }\n\n  addRectangle = () => {\n    const { existing } = this.props\n    const rect = new Rectangle(`rect-${Object.keys(existing).length}`)\n    this.props.add(rect)\n  }\n\n  render() {\n    const { tool } = this.props\n\n    return (\n      <div style={{ display: 'flex', padding: '10px 10px 0px 10px' }}>\n        <button\n          type=\"button\"\n          id=\"SETTINGS\"\n          onClick={this.choose}\n          {...(tool === 'SETTINGS' ? { primary: 'true' } : {})}\n        >\n          <div>&#9776;</div>\n        </button>\n        <button\n          type=\"button\"\n          id=\"CLEAR\"\n          onClick={this.choose}\n        >\n          <div>&#10007;</div>\n        </button>\n        <button\n          type=\"button\"\n          id=\"SELECT\"\n          onClick={this.choose}\n          {...(tool === 'SELECT' ? { primary: 'true' } : {})}\n        >\n          <div style={{ transform: 'rotate(-135deg)' }}>&#10148;</div>\n        </button>\n        {/* <button\n          type=\"button\"\n          id=\"DRAW\"\n          onClick={this.choose}\n          {...(tool === 'DRAW' ? { primary: 'true' } : {})}\n        >\n          ✎\n        </button> */}\n\n        <button type=\"button\" onClick={this.addCircle}>+ Circle</button>\n        <button type=\"button\" onClick={this.addRectangle}>+ Rectangle</button>\n      </div>\n    )\n  }\n}\n\nexport default ToolController\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\n@observer\nclass IntegerInput extends Component {\n  state = {\n    localValue: 0,\n  }\n\n  componentDidMount() {\n    const { value } = this.props\n    if (value !== this.state.localValue) {\n      this.setState({ localValue: value })\n    }\n  }\n\n  onChange = (event) => {\n    this.setState({ localValue: event.target.value })\n  }\n\n  onBlur = () => {\n    const { value, setValue } = this.props\n    const { localValue } = this.state\n\n    const possibleInt = parseInt(localValue)\n    let result = value\n    if (Number.isInteger(possibleInt)) {\n      result = possibleInt\n    }\n\n    setValue(result)\n    this.setState({ localValue: result })\n  }\n\n  handleKeyDown = (event) => {\n    const { key, shiftKey } = event\n    if (key === 'ArrowUp' && shiftKey) {\n      this.incrementBy(10)\n    } else if (key === 'ArrowUp') {\n      this.incrementBy(1)\n    } else if (key === 'ArrowDown' && shiftKey) {\n      this.decrementBy(10)\n    } else if (key === 'ArrowDown') {\n      this.decrementBy(1)\n    }\n  }\n\n  changeBy = operation => (amount) => {\n    const { value, setValue } = this.props\n    const next = operation(value, amount)\n    setValue(next)\n    this.setState({ localValue: next })\n  }\n\n  // eslint-disable-next-line\n  incrementBy = this.changeBy((a, b) => a + b)\n  decrementBy = this.changeBy((a, b) => a - b)\n\n  render() {\n    const { localValue } = this.state\n    return (\n      <input\n        type=\"text\"\n        style={{ width: '60px', marginRight: '20px', textAlign: 'center' }}\n        value={localValue}\n        onChange={this.onChange}\n        onKeyDown={this.handleKeyDown}\n        onBlur={this.onBlur}\n      />\n    )\n  }\n}\n\nexport default IntegerInput\n","import React, { useRef } from 'react'\n\nconst style = {\n  container: {\n    position: 'fixed',\n    zIndex: 100,\n    left: 0,\n    top: 0,\n    width: '100%',\n    height: '100%',\n    overflow: 'auto',\n    backgroundColor: 'rgba(0, 0, 0, 0.4)',\n  },\n  body: {\n    backgroundColor: '#fefefe',\n    margin: '15% auto',\n    border: '1px solid #888',\n    width: '80%',\n  },\n  content: {\n    padding: '16px',\n  },\n}\n\nconst Modal = ({ children, open, handleClose }) => {\n  const clickawayEl = useRef(null)\n\n  const onClickaway = (event) => {\n    if (clickawayEl.current.contains(event.target)) return\n    handleClose()\n  }\n\n  return (\n    open === false ? null : (\n      <div style={style.container} onClick={onClickaway}>\n        <div ref={clickawayEl} style={style.body}>\n          <div style={style.content}>{children}</div>\n        </div>\n      </div>\n    )\n  )\n}\n\nexport default Modal\n","// encapsulates ValueEditor, implements editing the paper properties of an AnimatibleItem\n\nimport React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport IntegerInput from '../components/IntegerInput'\n\n@observer\nclass PropertyEditor extends Component {\n  propertySetter = property => (value) => {\n    const { item, now } = this.props\n\n    if (item.keyframes[property] && item.keyframes[property].length) {\n      const existingKeyframe = item.keyframes[property].find(keyframe => keyframe.frame === now)\n      if (existingKeyframe) {\n        existingKeyframe.value = value\n      } else {\n        item.addKey(`${property}`, now, value)\n      }\n    } else {\n      item[property] = value\n    }\n  }\n\n  classControls() {\n    const { item } = this.props\n    const itemClass = item.constructor.name\n\n    if (itemClass === 'Circle') {\n      return (\n        <React.Fragment>\n          <label>Radius</label>\n          <div style={{ display: 'flex' }}>\n            <IntegerInput value={item.radius} setValue={this.propertySetter('radius')} />\n          </div>\n        </React.Fragment>\n      )\n    }\n\n    if (itemClass === 'Rectangle') {\n      return (\n        <React.Fragment>\n          <label>Size</label>\n          <div style={{ display: 'flex' }}>\n            <IntegerInput value={item.width} setValue={this.propertySetter('width')} />\n            <IntegerInput value={item.height} setValue={this.propertySetter('height')} />\n          </div>\n        </React.Fragment>\n      )\n    }\n  }\n\n  render() {\n    const { item } = this.props\n\n    if (item === undefined) {\n      return (\n        <h3 style={{ padding: '10px', color: 'darkgray' }}>\n          Select an Item on the Canvas.\n        </h3>\n      )\n    }\n\n    return (\n      <div style={{ padding: '10px' }}>\n        <h4>{item.key}</h4>\n        <label>Position</label>\n        <div style={{ display: 'flex' }}>\n          <IntegerInput value={item.x} setValue={this.propertySetter('x')} />\n          <IntegerInput value={item.y} setValue={this.propertySetter('y')} />\n        </div>\n\n        <label>Scale</label>\n        <div style={{ display: 'flex' }}>\n          <IntegerInput value={item.scale} setValue={this.propertySetter('scale')} />\n        </div>\n\n        <label>Rotation</label>\n        <div style={{ display: 'flex' }}>\n          <IntegerInput value={item.rotation} setValue={this.propertySetter('rotation')} />\n        </div>\n\n        {this.classControls()}\n      </div>\n    )\n  }\n}\n\nexport default PropertyEditor\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Modal from '../components/Modal'\n\n@observer\nclass ProjectSettings extends Component {\n  setName = (event) => {\n    const { store } = this.props\n    store.project.setName(event.target.value)\n  }\n\n  setLength = (event) => {\n    const { store } = this.props\n    const length = parseInt(event.target.value)\n    store.animation.setLength(length)\n  }\n\n  setColor = (event) => {\n    const { store } = this.props\n    store.canvas.color = event.target.value\n  }\n\n  closeModal = () => this.props.store.canvas.setTool('SELECT')\n\n  render() {\n    const { store } = this.props\n\n    return (\n      <Modal open={store.mode.settings} handleClose={this.closeModal}>\n        <h3>Project Settings</h3>\n\n        <label>Project Name</label>\n        <input type=\"text\" value={store.project.name} onChange={this.setName} />\n\n        <label>Animation Length</label>\n        <input type=\"number\" step=\"1\" value={store.animation.frames} onChange={this.setLength} />\n\n        <label>Canvas Background</label>\n        <select value={store.canvas.color} onChange={this.setColor}>\n          <option value=\"#000000\">Black</option>\n          <option value=\"#ffffff\">White</option>\n        </select>\n\n        <div style={{ display: 'flex', flexDirection: 'row-reverse' }}>\n          <button type=\"button\" onClick={this.closeModal}>Close</button>\n        </div>\n      </Modal>\n    )\n  }\n}\n\nexport default ProjectSettings\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Modal from '../components/Modal'\n\n@observer\nclass ClearProject extends Component {\n  closeModal = () => this.props.store.canvas.setTool('SELECT')\n\n  render() {\n    const { store } = this.props\n    const { mode, project, reset } = store\n\n    return (\n      <Modal open={mode.clear} handleClose={this.closeModal}>\n        <h3>Remove Project?</h3>\n\n        <p>\n          You are about to remove&nbsp;\n          <strong>{project.name}</strong>\n          &nbsp;from your workspace, and start from scratch.\n          Are you sure you want to do this?\n        </p>\n\n        <div style={{ display: 'flex', justifyContent: 'flex-end' }}>\n          <button type=\"button\" onClick={this.closeModal}>Cancel</button>\n          <button type=\"button\" onClick={reset}>Remove</button>\n        </div>\n      </Modal>\n    )\n  }\n}\n\nexport default ClearProject\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\nimport { autorun } from 'mobx'\n\nimport Viewer from './Viewer'\nimport ToolController from './ToolController'\nimport PropertyEditor from './PropertyEditor'\nimport ProjectSettings from './ProjectSettings'\nimport ClearProject from './ClearProject'\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\nimport items from '../prototypes/items'\nimport Keyframe from '../prototypes/Keyframe'\n\n@observer\nclass BuildMode extends Component {\n  state = {\n    ready: false,\n    inputItemsExist: false,\n  }\n\n  autorunDisposer\n\n  componentDidMount() {\n    const { canvas, project } = this.props.store\n    const container = document.getElementById('build-container')\n    setTimeout(() => {\n      const width = Math.round(container.clientWidth) - 20\n      const height = Math.round((9 / 16) * width)\n      canvas.setSize(width, height)\n    }, 1)\n\n    if (canvas.tool === 'SELECT') {\n      setTimeout(() => {\n        canvas.setTool(undefined)\n        canvas.setTool('SELECT')\n      }, 20)\n    }\n\n    this.autorunDisposer = autorun(() => {\n      this.setState({ inputItemsExist: Boolean(project.inputItems) })\n    })\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const prevInputItemsExist = prevState.inputItemsExist\n    const { canvas, project } = this.props.store\n    const { ready, inputItemsExist } = this.state\n    if (\n      !project.inputBuilt &&\n      (\n        (ready && !prevInputItemsExist && inputItemsExist) ||\n        (inputItemsExist && !prevState.ready && ready)\n      )\n    ) {\n      Object.entries(project.inputItems).forEach(([itemKey, itemObj]) => {\n        const { class: itemClass, keyframes, ...properties } = itemObj\n\n        const animatable = new items[itemClass](itemKey)\n        canvas.add(animatable)\n\n        const inputKeyframes = Object.entries(keyframes)\n          .reduce((accum, [keyframeProp, keyframeList]) => {\n            /* eslint no-param-reassign: 0 */\n            accum[keyframeProp] = keyframeList.map(Keyframe.fromJSON)\n            return accum\n          }, {})\n        animatable.keyframes = {\n          ...this.keyframes,\n          ...inputKeyframes,\n        }\n\n        Object.entries(properties).forEach(([key, value]) => {\n          animatable[key] = value\n        })\n      })\n\n      project.inputBuilt = true\n    }\n  }\n\n  componentWillUnmount() {\n    const { project, canvas } = this.props.store\n    canvas.selectOff()\n    project.clear()\n    this.autorunDisposer()\n  }\n\n  onSetup = () => {\n    const { canvas } = this.props.store\n    canvas.build()\n    this.setState({ ready: true })\n  }\n\n  add = (item) => {\n    const { canvas } = this.props.store\n    canvas.add(item)\n  }\n\n  render() {\n    const { canvas, animation } = this.props.store\n    const { ready } = this.state\n    return (\n      <React.Fragment>\n        <ProjectSettings store={this.props.store} />\n        <ClearProject store={this.props.store} />\n        <Grid\n          gridTemplateRows=\"auto 60px\"\n          gridTemplateColumns=\"auto 340px\"\n        >\n          <GridItem gridArea=\"1 / 1 / 1 / 2\" id=\"build-container\" padding=\"10px\" alignSelf=\"center\">\n            <Viewer canvas={canvas} animation={animation} onSetup={this.onSetup} />\n          </GridItem>\n          <GridItem gridArea=\"1 / 2 / 1 / 3\" backgroundColor=\"rgb(210, 210, 210)\">\n            <PropertyEditor item={canvas.selected} now={animation.now} />\n          </GridItem>\n          <GridItem gridArea=\"2 / 1 / 2 / 3\" backgroundColor=\"rgb(180, 180, 180)\">\n            { ready && (\n              <ToolController\n                existing={canvas.animatables}\n                add={this.add}\n                tool={canvas.tool}\n                setTool={canvas.setTool}\n              />\n            )}\n          </GridItem>\n        </Grid>\n      </React.Fragment>\n    )\n  }\n}\n\nexport default BuildMode\n","const makeRoot = (real, imag) => ({ real, imag })\n\nconst evaluate = (x, A, B, C, D) => {\n  const q0 = A * x\n  const B1 = q0 + B\n  const C2 = B1 * x + C\n  return {\n    Q: C2 * x + D,\n    dQ: (q0 + B1) * x + C2,\n    B1,\n    C2,\n  }\n}\n\nconst qdrtc = (A, B, C) => {\n  const b = -B / 2\n  const q = b * b - A * C\n  let X1 = 0\n  let Y1 = 0\n  let X2 = 0\n  let Y2 = 0\n\n  if (q < 0) {\n    const X = b / A\n    const Y = Math.sqrt(-q) / A\n    X1 = X\n    Y1 = Y\n    X2 = X\n    Y2 = -Y\n  } else {\n    Y1 = 0\n    Y2 = 0\n    const r = b + Math.sign(b) * Math.sqrt(q)\n    if (r === 0) {\n      X1 = C / A\n      X2 = -C / A\n    } else {\n      X1 = C / r\n      X2 = r / A\n    }\n  }\n  return [\n    makeRoot(X1, Y1),\n    makeRoot(X2, Y2),\n  ]\n}\n\nconst getCubicRoots = (A, B, C, D) => {\n  let X\n  let a\n  let b1\n  let c2\n  if (A === 0) {\n    X = undefined\n    a = B\n    b1 = C\n    c2 = D\n  } else if (D === 0) {\n    X = 0\n    a = A\n    b1 = B\n    c2 = C\n  } else {\n    a = A\n    X = -(B / A) / 3\n    let evalInfo = evaluate(X, A, B, C, D)\n    let q = evalInfo.Q\n    let dq = evalInfo.dQ\n    b1 = evalInfo.B1\n    c2 = evalInfo.C2\n\n    let t = q / A\n    let r = Math.abs(t) ** (1 / 3)\n    const s = Math.sign(t)\n    t = -dq / A\n    if (t > 0) {\n      r = 1.324717957244746 * Math.max(r, Math.sqrt(t))\n    }\n    let x0 = X - s * r\n    if (x0 !== X) {\n      const den = 1 + (100 * Number.EPSILON)\n      do {\n        X = x0\n        evalInfo = evaluate(X, A, B, C, D)\n        q = evalInfo.Q\n        dq = evalInfo.dQ\n        b1 = evalInfo.B1\n        c2 = evalInfo.C2\n        x0 = (dq === 0 ? X : X - (q / dq) / den)\n      } while (s * x0 > s * X)\n      if (Math.abs(A) * X * X > Math.abs(D / X)) {\n        c2 = -D / X\n        b1 = (c2 - C) / X\n      }\n    }\n  }\n  const roots = []\n  if (X !== undefined) {\n    roots.push(makeRoot(X, 0))\n  }\n  const quadInfo = qdrtc(a, b1, c2)\n  return roots.concat(quadInfo)\n}\n\nconst cubic = (x, a, b, c, d) => (\n  (a * (x ** 3)) + (b * (x ** 2)) + (c * x) + d\n)\n\nconst bezierCurve = ({ x2, x3, y2, y3 }) => {\n  /* x2, and x3 are the X values from the 2nd and 3rd points for a bezier\n      definition. For this use case, they must be between 0 - 1.\n  */\n  if (x2 > 1 || x2 < 0 || x3 > 1 || x3 < 0) {\n    throw Error('This bezier curve requires control values between 0 & 1')\n  }\n\n  // These constants were reduced from the Cubic Bézier curve definition, with\n  // values of (0, 0) and (1, 1) used for p1 & p4 respectively\n  const xA = 3 * x2 - 3 * x3 + 1\n  const xB = -1 * 6 * x2 + 3 * x3\n  const xC = 3 * x2\n\n  const yA = 3 * y2 - 3 * y3 + 1\n  const yB = -1 * 6 * y2 + 3 * y3\n  const yC = 3 * y2\n  const yD = 0\n\n  const t = (x) => {\n    const xD = -x\n    const roots = getCubicRoots(xA, xB, xC, xD)\n    roots.filter(r => (\n      r.imag === 0 &&\n      r.real.toFixed(10) >= 0 &&\n      r.real.toFixed(10) <= 1 &&\n      !Object.is(r.real, -0)\n    ))\n    // console.log(JSON.stringify(roots))\n    return roots[0].real\n  }\n\n  const y = (x) => {\n    const time = t(x)\n    return cubic(time, yA, yB, yC, yD)\n  }\n\n  return ({ t, y })\n}\n\nexport default bezierCurve\n","import { observable } from 'mobx'\n\nimport Handle from './Handle'\nimport bezierCurve from '../util/bezierCurve'\n\nclass Keyframe {\n  static get OBSERVABLES() {\n    return ['frame', 'value', 'handleIn', 'handleOut']\n  }\n\n  @observable frame\n  @observable value\n  @observable handleIn\n  @observable handleOut\n\n  constructor(frame, value) {\n    this.frame = frame\n    this.value = value\n    this.handleIn = new Handle('IN')\n    this.handleOut = new Handle('OUT')\n  }\n\n  toJSON() {\n    return ({\n      frame: this.frame,\n      value: this.value,\n      handleIn: this.handleIn.toJSON(),\n      handleOut: this.handleOut.toJSON(),\n    })\n  }\n\n  static fromJSON(input) {\n    const { frame, value, handleIn, handleOut } = input\n    const keyframe = new Keyframe(frame, value)\n    keyframe.handleIn.influence = handleIn.influence\n    keyframe.handleIn.distance = handleIn.distance\n    keyframe.handleOut.influence = handleOut.influence\n    keyframe.handleOut.distance = handleOut.distance\n    return keyframe\n  }\n\n  static sort = (a, b) => (a.frame - b.frame)\n\n  static createCurve = (k1, k2) => (\n    bezierCurve({\n      x2: k1.handleOut.position.x,\n      y2: k1.handleOut.position.y,\n      x3: k2.handleIn.position.x,\n      y3: k2.handleIn.position.y,\n    })\n  )\n\n  static interpolate = (k1, k2, frame) => {\n    const curve = Keyframe.createCurve(k1, k2)\n    const timeRatio = (frame - k1.frame) / (k2.frame - k1.frame)\n    // BUG: Bezier Interpolation is broken for certain ranges\n    const valueRatio = curve.y(timeRatio)\n    const interpolated = ((k2.value - k1.value) * valueRatio) + k1.value\n    return interpolated\n  }\n}\n\nexport default Keyframe\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\n@observer\nclass Canvas extends Component {\n  componentDidMount() {\n    this.testForAvailability()\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.width === undefined) {\n      this.testForAvailability()\n    }\n  }\n\n  testForAvailability() {\n    const { width, hasSize } = this.props\n    if (width !== undefined) {\n      hasSize()\n    }\n  }\n\n  render() {\n    const { id, width, height } = this.props\n    if (width === undefined) return null\n    return (\n      <canvas\n        style={{ display: 'block' }}\n        id={id}\n        width={width}\n        height={height}\n      />\n    )\n  }\n}\n\nexport default Canvas\n","/* encapsulates Mode, implements:\n\n  | Viewer     | ExportEditor   |\n  |            |                |\n   ------------|                |\n  | Format     |                |\n  | Controller |                |\n\n*/\n\nimport React, { Component } from 'react'\n\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\nclass ExportMode extends Component {\n  loadThenBuild = (event) => {\n    const { project, mode } = this.props.store\n    return project.loadFromFile(event, () => mode.set('BUILD'))\n  }\n\n  saveThenDownload = () => {\n    const { project } = this.props.store\n    project.download(project.save())\n  }\n\n  render() {\n    const { project } = this.props.store\n\n    return (\n      <Grid\n        gridTemplateRows=\"1fr 1fr 1fr\"\n        gridTemplateColumns=\"auto\"\n        // alignItems=\"center\"\n        justifyItems=\"center\"\n      >\n        {/* <GridItem padding=\"10px\">\n          <h3 style={{ padding: '10px', color: 'darkgray' }}>\n            Feature under construction.\n          </h3>\n        </GridItem> */}\n        <GridItem alignSelf=\"end\">\n          <button type=\"button\" onClick={this.saveThenDownload}>&#x21e9; Save Project to File</button>\n        </GridItem>\n        <GridItem alignSelf=\"center\">\n          <label htmlFor=\"file-button\" style={{ display: 'block', width: '300px' }}>&#x21aa; Load Project from File</label>\n          <input type=\"file\" id=\"file-button\" onChange={this.loadThenBuild} style={{ width: '300px' }} />\n        </GridItem>\n        <GridItem>\n          <button type=\"button\" onClick={project.publish}>&#x2912; Publish Project to Gallery</button>\n        </GridItem>\n      </Grid>\n    )\n  }\n}\n\nexport default ExportMode\n","module.exports = __webpack_public_path__ + \"bare.min.css\";","import { observable, action } from 'mobx'\n\nimport Keyframe from './Keyframe'\n\nclass AnimatableItem {\n  // Canvas Size Relative Values (0-100)\n  static get X() { return 50 }\n  static get Y() { return 50 }\n\n  // Absolute Values\n  static get SCALE() { return 100 }\n  static get ROTATION() { return 0 }\n  static get FILL_COLOR() {\n    return {\n      hue: Math.floor(Math.random() * 361),\n      saturation: 0.4,\n      brightness: 1,\n    }\n  }\n\n  static get OBSERVABLES() {\n    return ['x', 'y', 'scale', 'rotation', 'fillColor', 'keyframes']\n  }\n\n  constructor(key) {\n    this.key = key\n    this.paper = undefined\n  }\n\n  @observable canvas\n  @observable _x = AnimatableItem.X\n  @observable _y = AnimatableItem.Y\n  @observable _scale = AnimatableItem.SCALE\n  @observable _rotation = AnimatableItem.ROTATION\n  @observable _fillColor = AnimatableItem.FILL_COLOR\n  @observable keyframes = {\n    x: observable([]),\n    y: observable([]),\n    scale: observable([]),\n    rotation: observable([]),\n  }\n\n  toJSON() {\n    return ({\n      class: this.constructor.name,\n      x: this.x,\n      y: this.y,\n      scale: this.scale,\n      rotation: this.rotation,\n      fillColor: this.fillColor,\n      keyframes: Object.entries(this.keyframes).reduce(\n        (output, [prop, keyframeList]) => {\n          /* eslint no-param-reassign: 0 */\n          output[prop] = keyframeList.map(keyframe => keyframe.toJSON())\n          return output\n        }, {}\n      ),\n    })\n  }\n\n  get item() { return this.paper.project.activeLayer.children[this.key] }\n  get x() { return this._x }\n  get y() { return this._y }\n  get position() { return { x: this.x, y: this.y } }\n  get scale() { return this._scale }\n  get rotation() { return this._rotation }\n  get fillColor() { return this._fillColor }\n\n  set x(value) {\n    this.item.position.x = this.absolute(value)\n    this._x = value\n  }\n\n  set y(value) {\n    this.item.position.y = this.absolute(value, 'height')\n    this._y = value\n  }\n\n  set position({ x, y }) {\n    this.x = x\n    this.y = y\n  }\n\n  set scale(value) {\n    if (this.scale === 0 && value !== 0) {\n      this.item.remove()\n      this.create(this.canvas)\n      this.item.scale(this.fraction(value))\n    } else {\n      const scaleBy = value / this.scale\n      this.item.scale(scaleBy)\n    }\n    this._scale = value\n  }\n\n  set rotation(value) {\n    const rotateBy = value - this.rotation\n    this.item.rotate(rotateBy)\n    this._rotation = value\n  }\n\n  set fillColor(value) {\n    this.item.fillColor = value\n    this._fillColor = value\n  }\n\n  @action setCanvas(canvas) {\n    this.canvas = canvas\n    this.paper = canvas.paper\n  }\n\n  @action setUntrackedValues() {\n    this.item.scale(this.fraction(this.scale))\n    this.item.rotate(this.rotation)\n  }\n\n  @action updateKeyframes(property, keyframes) {\n    this.keyframes = {\n      ...this.keyframes,\n      [property]: keyframes,\n    }\n  }\n\n  addKey(property, frame, value = undefined, ignorePairings = false) {\n    const valueToKey = value || this[property]\n    const k = new Keyframe(frame, valueToKey)\n    const keyframes = [...this.keyframes[property], k]\n    keyframes.sort(Keyframe.sort)\n\n    if (!ignorePairings && ['x', 'y'].includes(property)) {\n      let paired\n      if (property === 'x') { paired = 'y' }\n      if (property === 'y') { paired = 'x' }\n\n      const valueToPair = this[paired]\n      const kP = new Keyframe(frame, valueToPair)\n      const keyframesPaired = [...this.keyframes[paired], kP]\n      keyframesPaired.sort(Keyframe.sort)\n\n      this.keyframes = {\n        ...this.keyframes,\n        [property]: keyframes,\n        [paired]: keyframesPaired,\n      }\n    } else {\n      this.updateKeyframes(property, keyframes)\n    }\n\n    return k\n  }\n\n  removeKey(property, frame) {\n    let keyframes = [...this.keyframes[property]]\n    keyframes = keyframes.filter(k => k.frame !== frame)\n\n    if (property === 'x') {\n      let keyframesY = [...this.keyframes.y]\n      keyframesY = keyframesY.filter(k => k.frame !== frame)\n      this.keyframes = {\n        ...this.keyframes,\n        x: keyframes,\n        y: keyframesY,\n      }\n    } else {\n      this.updateKeyframes(property, keyframes)\n    }\n  }\n\n  absolute = (value, dimension = 'width') => (\n    value / 100 * this.canvas[dimension]\n  )\n\n  fraction = value => (\n    value / 100\n  )\n\n  create(canvas) {\n    if (this.canvas === undefined) this.setCanvas(canvas)\n\n    const sharedProps = {\n      name: this.key,\n      fillColor: this.fillColor,\n    }\n\n    if (typeof this.onCreate === 'function') {\n      this.onCreate(sharedProps)\n    }\n\n    if (this.item !== undefined) this.setUntrackedValues()\n  }\n\n  recreate() {\n    this.item.remove()\n    this.create(this.canvas)\n    this.canvas.addListenersAndSelect(this)\n  }\n\n  draw(frame) {\n    if (this.item === undefined) return\n\n    Object.entries(this.keyframes).forEach(([property, keyframes]) => {\n      // Ignore `y` property\n      if (property === 'y') return\n      if (property === 'x') {\n        // Interpret `x` & `y` at the same time\n        const xKeyframes = keyframes\n        const yKeyframes = this.keyframes.y\n        if (xKeyframes.length === 0 && yKeyframes.length === 0) return\n        const xValue = this.valueForFrame(frame, xKeyframes)\n        const yValue = this.valueForFrame(frame, yKeyframes)\n        this.position = { x: xValue, y: yValue }\n      } else {\n        // Interpret all other properties individually\n        if (keyframes.length === 0) return\n        const value = this.valueForFrame(frame, keyframes)\n        this[property] = value\n      }\n    })\n  }\n\n  valueForFrame = (frame, keyframes) => {\n    const frames = keyframes.map(key => key.frame)\n\n    // is frame a keyframe\n    if (frames.includes(frame)) {\n      const where = frames.indexOf(frame)\n      return keyframes[where].value\n    }\n\n    // where is frame with respect to keyframes\n    frames.push(frame)\n    frames.sort((a, b) => a - b)\n    const where = frames.indexOf(frame)\n\n    // is frame before or after last key\n    if (where === 0) return keyframes[0].value\n    if (where === frames.length - 1) return keyframes[keyframes.length - 1].value\n\n    // frame is between two keys\n    const before = keyframes[where - 1]\n    const after = keyframes[where]\n    return Keyframe.interpolate(before, after, frame)\n  }\n}\n\nexport default AnimatableItem\n","import React, { Component } from 'react'\n\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\nclass ModeController extends Component {\n  navigate = (event) => {\n    event.preventDefault()\n    const { mode } = this.props\n    mode.set(event.target.textContent.toUpperCase())\n  }\n\n  render() {\n    const { current } = this.props.mode\n    return (\n      <Grid gridTemplateColumns=\"1fr 1fr 1fr 1fr\" borderBottom=\"1px solid rgb(230, 230, 230)\">\n        <GridItem display=\"grid\" alignItems=\"center\" justifyItems=\"center\">\n          <button\n            type=\"button\"\n            style={{ margin: '0px' }}\n            onClick={this.navigate}\n            {...(current === 'BUILD' ? { primary: 'true' } : {})}\n          >\n            Build\n          </button>\n        </GridItem>\n        <GridItem display=\"grid\" alignItems=\"center\" justifyItems=\"center\">\n          <button\n            type=\"button\"\n            style={{ margin: '0px' }}\n            onClick={this.navigate}\n            {...(current === 'ANIMATE' ? { primary: 'true' } : {})}\n          >\n            Animate\n          </button>\n        </GridItem>\n        <GridItem display=\"grid\" alignItems=\"center\" justifyItems=\"center\">\n          <button\n            type=\"button\"\n            style={{ margin: '0px' }}\n            onClick={this.navigate}\n            {...(current === 'VIEW' ? { primary: 'true' } : {})}\n          >\n            View\n          </button>\n        </GridItem>\n        <GridItem display=\"grid\" alignItems=\"center\" justifyItems=\"center\">\n          <button\n            type=\"button\"\n            style={{ margin: '0px' }}\n            onClick={this.navigate}\n            {...(current === 'EXPORT' ? { primary: 'true' } : {})}\n          >\n            Export\n          </button>\n        </GridItem>\n      </Grid>\n    )\n  }\n}\n\nexport default ModeController\n","import paper from 'paper'\n\nimport Handle from './Handle'\n\nclass HandleEditor {\n  constructor(trueWidth, keyframeBefore, keyframeAfter, onMove) {\n    this.trueWidth = trueWidth\n    this.keyframeBefore = keyframeBefore\n    this.keyframeAfter = keyframeAfter\n    this.onMove = onMove\n    this.paper = new paper.PaperScope()\n\n    this.element = undefined\n  }\n\n  attatchTo = (id) => {\n    const element = document.getElementById(id)\n    this.element = element\n    this.paper.setup(element)\n  }\n\n  destroy() {\n    if (this.paper.project) {\n      this.paper.project.clear()\n      this.paper.project.remove()\n    }\n  }\n\n  init() {\n    // Assumes Width & Height are identical\n    this.padding = 10\n    this.width = this.trueWidth - (this.padding * 2)\n    const { width, padding } = this\n\n    const topLeft = [padding, padding]\n    const topRight = [width + padding, padding]\n    const bottomLeft = [padding, width + padding]\n    // const bottomRight = [width, width + padding]\n    const spacing = width / Handle.STEP\n    const center = this.trueWidth / 2\n\n    // Background\n    new this.paper.Path.Rectangle({\n      topLeft: [0, 0],\n      bottomRight: [this.trueWidth, this.trueWidth],\n      fillColor: 'rgb(210, 210, 210)',\n    })\n\n    // Gridlines\n    const gridline = new this.paper.SymbolDefinition(\n      new this.paper.Path.Line({\n        from: [0, 0],\n        to: [0, this.trueWidth],\n        // strokeColor: '#324252',\n        strokeColor: 'rgb(180, 180, 180)',\n        strokeWidth: 2,\n      })\n    )\n    for (let i = 0; i <= Handle.STEP; i += 1) {\n      const offset = padding + 0 + (spacing * i)\n      gridline.place(new this.paper.Point(offset, center))\n      const offAxis = gridline.place(new this.paper.Point(center, offset))\n      offAxis.rotate(90)\n    }\n\n    // Value Interpolation Curve\n    this.curve = new this.paper.Path.Line({\n      // strokeColor: '#2176ff',\n      strokeColor: 'rgb(30, 155, 255)',\n      strokeWidth: 2,\n      from: new this.paper.Point(bottomLeft),\n      to: new this.paper.Point(topRight),\n    })\n    this.setVisualCurveHandles()\n\n    // Handle Strings\n    const stringStyle = {\n      // strokeColor: '#2176ff',\n      strokeColor: 'rgb(30, 155, 255)',\n      strokeWidth: 2,\n    }\n    const handleBeforeString = new this.paper.Path.Line({\n      ...stringStyle,\n      from: bottomLeft,\n      to: this.handleBefore(),\n    })\n    const handleAfterString = new this.paper.Path.Line({\n      ...stringStyle,\n      from: this.handleAfter(),\n      to: topRight,\n    })\n\n    // Handle Grips\n    const handleMovable = new this.paper.SymbolDefinition(\n      new this.paper.Path.Circle({\n        point: topLeft,\n        radius: 6,\n        // strokeColor: '#2176ff',\n        strokeColor: 'rgb(30, 155, 255)',\n        strokeWidth: 2,\n        fillColor: new this.paper.Color(1, 0.01),\n      })\n    )\n    const handleStationary = new this.paper.SymbolDefinition(\n      new this.paper.Path.Rectangle({\n        point: [100, 100],\n        size: [10, 10],\n        // fillColor: '#2176ff',\n        fillColor: 'rgb(30, 155, 255)',\n      })\n    )\n    handleStationary.place(bottomLeft)\n    handleStationary.place(topRight)\n    const handleBefore = handleMovable.place(this.handleBefore())\n    const handleAfter = handleMovable.place(this.handleAfter())\n\n    // Handle Events\n    handleBefore.onMouseEnter = () => {\n      this.element.style.cursor = 'pointer'\n    }\n    handleBefore.onMouseLeave = () => {\n      this.element.style.cursor = 'default'\n    }\n    handleBefore.onMouseDrag = (event) => {\n      this.element.style.cursor = 'pointer'\n      const travelled = event.point.subtract(handleBefore.position)\n\n      const xChange = Math.abs(travelled.x) >= (spacing / 2)\n      const yChange = Math.abs(travelled.y) >= (spacing / 2)\n      if (xChange || yChange) {\n        const xSign = Math.sign(travelled.x)\n        const ySign = Math.sign(travelled.y)\n        const newPosition = handleBefore.position.add({\n          x: xSign * spacing * xChange,\n          y: ySign * spacing * yChange,\n        })\n\n        handleBefore.position = newPosition\n        handleBeforeString.lastSegment.point = newPosition\n        this.onMove('OUT', {\n          influence: xSign * Handle.STEP * xChange,\n          distance: -1 * ySign * Handle.STEP * yChange,\n        })\n        this.setVisualCurveHandles()\n      }\n    }\n    handleBefore.onMouseUp = () => {\n      this.element.style.cursor = 'default'\n    }\n\n    handleAfter.onMouseEnter = () => {\n      this.element.style.cursor = 'pointer'\n    }\n    handleAfter.onMouseLeave = () => {\n      this.element.style.cursor = 'default'\n    }\n    handleAfter.onMouseDrag = (event) => {\n      this.element.style.cursor = 'pointer'\n      const travelled = event.point.subtract(handleAfter.position)\n\n      const xChange = Math.abs(travelled.x) >= (spacing / 2)\n      const yChange = Math.abs(travelled.y) >= (spacing / 2)\n      if (xChange || yChange) {\n        const xSign = Math.sign(travelled.x)\n        const ySign = Math.sign(travelled.y)\n        const newPosition = handleAfter.position.add({\n          x: xSign * spacing * xChange,\n          y: ySign * spacing * yChange,\n        })\n\n        handleAfter.position = newPosition\n        handleAfterString.firstSegment.point = newPosition\n        this.onMove('IN', {\n          influence: -1 * xSign * Handle.STEP * xChange,\n          distance: ySign * Handle.STEP * yChange,\n        })\n        this.setVisualCurveHandles()\n      }\n    }\n    handleAfter.onMouseUp = () => {\n      this.element.style.cursor = 'default'\n    }\n  }\n\n\n  handleBefore = () => (\n    this.absoluteHandlePosition(this.keyframeBefore.handleOut.position)\n  )\n\n  handleAfter = () => (\n    this.absoluteHandlePosition(this.keyframeAfter.handleIn.position)\n  )\n\n  absoluteHandlePosition(handlePosition) {\n    return ([\n      handlePosition.x * this.width + this.padding,\n      // Compensates for 4th quadrant cartesian system\n      this.width - (handlePosition.y * this.width) + this.padding,\n    ])\n  }\n\n  setVisualCurveHandles() {\n    if (this.curve) {\n      this.curve.firstSegment.handleOut = new this.paper.Point(\n        this.keyframeBefore.handleOut.influence * this.width / Handle.MAX,\n        -1 * this.keyframeBefore.handleOut.distance * this.width / Handle.MAX\n      )\n      this.curve.lastSegment.handleIn = new this.paper.Point(\n        -1 * this.keyframeAfter.handleIn.influence * this.width / Handle.MAX,\n        this.keyframeAfter.handleIn.distance * this.width / Handle.MAX\n      )\n    }\n  }\n}\n\nexport default HandleEditor\n","import React from 'react'\nimport { observer } from 'mobx-react'\n\nimport Canvas from '../components/Canvas'\n\nimport HandleEditorInstance from '../prototypes/HandleEditor'\n\n@observer\nclass HandleEditor extends React.Component {\n  state = {}\n\n  handleEditor\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.keyframeKey !== undefined && prevProps.keyframeKey !== this.props.keyframeKey) {\n      if (this.handleEditor) this.handleEditor.destroy()\n      this.buildHandleEditorCanvas()\n    }\n  }\n\n  handleEditorHasSize = () => {\n    this.buildHandleEditorCanvas()\n  }\n\n  buildHandleEditorCanvas = () => {\n    const { width, keyframeBefore, keyframeAfter, onMove } = this.props\n\n    if (keyframeBefore && keyframeAfter) {\n      this.handleEditor = new HandleEditorInstance(width, keyframeBefore, keyframeAfter, onMove)\n      this.handleEditor.attatchTo('handle-editor')\n      this.handleEditor.init()\n    }\n  }\n\n  render() {\n    const { width, keyframeKey, keyframeBefore, keyframeAfter } = this.props\n\n    if (keyframeKey === undefined) {\n      return (\n        <h3 style={{ padding: '10px', color: 'darkgray' }}>\n          Select a Keyframe on the Timeline.\n        </h3>\n      )\n    }\n\n    if (keyframeBefore && !keyframeAfter) {\n      return (\n        <h3 style={{ padding: '10px', color: 'darkgray' }}>\n          <i>Selected tail Keyframe has no handle relationships.</i>\n        </h3>\n      )\n    }\n\n    return (\n      <div style={{ padding: '10px' }}>\n        <Canvas\n          id=\"handle-editor\"\n          width={width}\n          height={width}\n          hasSize={this.handleEditorHasSize}\n        />\n      </div>\n    )\n  }\n}\n\nexport default HandleEditor\n","import React from 'react'\nimport { observer } from 'mobx-react'\nimport paper from 'paper'\n\nimport Canvas from '../components/Canvas'\n\n@observer\nclass KeyframeEditor extends React.Component {\n  state = {\n    previouslyClickedKeyframe: undefined,\n  }\n\n  paper = new paper.PaperScope()\n  element\n\n  componentDidMount() {\n    document.addEventListener('keyup', this.handleKeyUp)\n  }\n\n  componentDidUpdate(prevProps) {\n    if (\n      prevProps.item !== undefined &&\n      this.props.item !== undefined &&\n      prevProps.item.key !== this.props.item.key\n    ) {\n      this.rebuild()\n    }\n\n    if (prevProps.now !== this.props.now) {\n      this.buildPlayhead()\n    }\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keyup', this.handleKeyUp)\n  }\n\n  keyframeEditorHasSize = () => {\n    this.buildKeyframeEditorCanvas()\n  }\n\n  handleKeyframeClick = (event) => {\n    event.stopPropagation()\n    const { currentTarget } = event\n\n    const { onSelect } = this.props\n    const { previouslyClickedKeyframe } = this.state\n\n    if (previouslyClickedKeyframe) {\n      previouslyClickedKeyframe.strokeWidth = 0\n      previouslyClickedKeyframe.shadowColor.alpha = 0\n    }\n    currentTarget.strokeWidth = 1\n    currentTarget.shadowColor.alpha = 0.3\n    onSelect(currentTarget.name)\n    this.setState({ previouslyClickedKeyframe: currentTarget })\n  }\n\n  handleKeyUp = (event) => {\n    const { key } = event\n    const { item, keyframeKey, keyframe, onSelect } = this.props\n    if (key === 'Backspace' || key === 'Delete') {\n      event.preventDefault()\n\n      const keyframeProp = keyframeKey.split('.')[1]\n      onSelect(undefined)\n      item.removeKey(keyframeProp, keyframe.frame)\n      this.rebuild()\n    }\n  }\n\n  buildKeyframeEditorCanvas = () => {\n    const { item } = this.props\n    this.element = document.getElementById('keyframe-editor')\n    this.paper.setup(this.element)\n\n    const { verticalSpacing, timelineStart, timelineEnd, timelineStep } = this.timelineMath()\n    let placementIndex = 0\n\n    const { playheadLine } = this.buildPlayhead()\n    const newKeyframeItems = []\n\n    Object.entries(item.keyframes).forEach(([prop, list]) => {\n      let propName = prop\n      const placing = placementIndex * verticalSpacing + verticalSpacing\n\n      if (prop === 'y') return // Interpret `x` & `y` at the same time\n      if (prop === 'x') {\n        propName = 'position'\n      }\n\n      // Draw Timelines\n      new this.paper.PointText({\n        point: [0, placing],\n        content: propName,\n        fillColor: 'black',\n        fontSize: 14,\n      })\n      const timelineHover = new this.paper.Path.Line({\n        name: 'timelineHover',\n        from: [timelineStart + 5, placing - 5],\n        to: [timelineEnd, placing - 5],\n        strokeColor: 'rgba(180, 180, 180, 1)',\n        strokeWidth: 40,\n      })\n      const timeline = new this.paper.Path.Line({\n        from: [timelineStart + 5, placing - 5],\n        to: [timelineEnd, placing - 5],\n        strokeColor: 'lightgrey',\n        strokeWidth: 4,\n      })\n\n      const newKeyframeRect = new this.paper.Path.Rectangle({\n        name: 'newKeyframeRect',\n        point: [0, placing - 10],\n        size: [10, 10],\n        radius: 3,\n        fillColor: 'rgba(31, 155, 255, 0.5)',\n        rotation: 45,\n        visible: false,\n      })\n      const newKeyframePlus = new this.paper.PointText({\n        point: [0, placing - 8],\n        content: '+',\n        fillColor: 'rgba(31, 155, 255, 0.5)',\n        fontSize: 14,\n        visible: false,\n      })\n\n      newKeyframeItems.push([timelineHover, newKeyframeRect, newKeyframePlus])\n\n      // TODO: Put these all in a group, including the playheadsegment, and apply one event\n      const newKeyframeHoverEffect = (event) => {\n        newKeyframeRect.visible = true\n        newKeyframePlus.visible = true\n        newKeyframeRect.position.x = event.point.x\n        newKeyframePlus.position.x = event.point.x + 10\n      }\n      const newKeyframeHide = () => {\n        newKeyframeRect.visible = false\n        newKeyframePlus.visible = false\n      }\n      const newKeyClick = (event) => {\n        const frame = Math.round((event.point.x - timelineStart) / timelineStep)\n        item.addKey(prop, frame)\n        // console.log(frame)\n        this.rebuild()\n      }\n\n      timelineHover.onMouseMove = newKeyframeHoverEffect\n      timelineHover.onMouseLeave = newKeyframeHide\n      timeline.onMouseMove = newKeyframeHoverEffect\n      timeline.onMouseLeave = newKeyframeHide\n\n      newKeyframeRect.onMouseMove = (event) => {\n        if (timelineHover.hitTest(event.point, { stroke: true, segments: false })) {\n          newKeyframeHoverEffect(event)\n        } else {\n          newKeyframeHide()\n        }\n      }\n\n      timelineHover.onClick = newKeyClick\n      timeline.onClick = newKeyClick\n      newKeyframeRect.onClick = newKeyClick\n\n      // Draw Keyframes\n      list.forEach((keyframe, keyframeIndex) => {\n        const keyframeRect = new this.paper.Path.Rectangle({\n          name: `${item.key}.${prop}.${keyframeIndex}`,\n          point: [timelineStart + keyframe.frame * timelineStep - 5, placing - 10],\n          size: [10, 10],\n          radius: 3,\n          fillColor: 'rgb(30, 155, 255)',\n          rotation: 45,\n          strokeColor: 'white',\n          strokeWidth: 0,\n          shadowColor: 'rgba(0, 0, 0, 0)',\n          shadowBlur: 5,\n        })\n\n        keyframeRect.on('mousedown', this.handleKeyframeClick)\n        keyframeRect.onMouseEnter = () => {\n          this.element.style.cursor = 'pointer'\n          newKeyframeHide()\n        }\n        keyframeRect.onMouseLeave = () => {\n          this.element.style.cursor = 'default'\n        }\n      })\n\n      placementIndex += 1\n    })\n\n    playheadLine.onMouseMove = (event) => {\n      newKeyframeItems.forEach(([\n        timelineHover,\n        newKeyframeRect,\n        newKeyframePlus,\n      ]) => {\n        if (timelineHover.hitTest(event.point)) {\n          /* eslint-disable no-param-reassign */\n          newKeyframeRect.visible = true\n          newKeyframePlus.visible = true\n          newKeyframeRect.position.x = event.point.x\n          newKeyframePlus.position.x = event.point.x + 10\n        } else {\n          newKeyframeRect.visible = false\n          newKeyframePlus.visible = false\n        }\n      })\n    }\n    playheadLine.bringToFront()\n  }\n\n  rebuild() {\n    this.paper.project.clear()\n    this.paper.project.remove()\n    this.buildKeyframeEditorCanvas()\n  }\n\n  buildPlayhead() {\n    const { size, now } = this.props\n    const { timelineStart, timelineStep } = this.timelineMath()\n    const playheadLine = new this.paper.Path.Line({\n      from: [timelineStart + now * timelineStep, 10],\n      to: [timelineStart + now * timelineStep, size.height - 10],\n      strokeColor: 'white',\n      strokeWidth: 1,\n    })\n    const playheadTriangle = new this.paper.Path.RegularPolygon({\n      center: [timelineStart + now * timelineStep, 10],\n      sides: 3,\n      radius: 6,\n      rotation: 180,\n      fillColor: 'white',\n    })\n    return { playheadLine, playheadTriangle }\n  }\n\n  timelineMath() {\n    const { size, frames } = this.props\n    const verticalSpacing = 40\n    const timelineStart = 80\n    const timelineEnd = size.width - verticalSpacing\n    const timelineWidth = timelineEnd - timelineStart\n    const timelineStep = timelineWidth / frames\n    return {\n      verticalSpacing,\n      timelineStart,\n      timelineEnd,\n      timelineWidth,\n      timelineStep,\n    }\n  }\n\n  render() {\n    const { size, item } = this.props\n\n    if (size === undefined || item === undefined) {\n      return (\n        <h3 style={{ padding: '10px', color: 'grey' }}>\n          Select an Item to view its Keyframes.\n        </h3>\n      )\n    }\n\n    return (\n      <div style={{ padding: '10px' }}>\n        <Canvas\n          id=\"keyframe-editor\"\n          width={size.width}\n          height={size.height}\n          hasSize={this.keyframeEditorHasSize}\n        />\n      </div>\n    )\n  }\n}\n\nexport default KeyframeEditor\n","import React, { Component } from 'react'\nimport { autorun } from 'mobx'\nimport { observer } from 'mobx-react'\n\nimport Viewer from './Viewer'\nimport HandleEditor from './HandleEditor'\nimport KeyframeEditor from './KeyframeEditor'\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\nimport { titleCase } from '../util/string'\n\n@observer\nclass AnimateMode extends Component {\n  state = {\n    heWidth: undefined,\n    keSize: undefined,\n    selectedItemKey: undefined,\n  }\n\n  autorunDisposer\n\n  componentDidMount() {\n    const { canvas } = this.props.store\n    const container = document.getElementById('view-container')\n    setTimeout(() => {\n      const width = Math.round(container.clientWidth) - 20\n      const height = Math.round((9 / 16) * width)\n      canvas.setSize(width, height)\n    }, 1)\n\n    const container2 = document.getElementById('handle-container')\n    setTimeout(() => {\n      const width = Math.round(container2.clientWidth) - 20\n      const height = Math.round(container2.clientHeight) - 20\n      const smallestLength = Math.min(width, height)\n      this.setState({ heWidth: smallestLength })\n    }, 1)\n\n    const container3 = document.getElementById('keyframe-container')\n    setTimeout(() => {\n      const width = Math.round(container3.clientWidth) - 20\n      const height = Math.round(container3.clientHeight) - 20\n      this.setState({ keSize: { width, height } })\n    }, 1)\n\n    this.autorunDisposer = autorun(() => {\n      if (canvas.selected) {\n        this.setState({ selectedItemKey: canvas.selected.key })\n      } else {\n        this.setState({ selectedItemKey: undefined })\n      }\n    })\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const { tools } = this.props.store\n    if (prevState.selectedItemKey !== this.state.selectedItemKey) {\n      tools.selectKeyframe(undefined)\n    }\n  }\n\n  componentWillUnmount() {\n    const { canvas, project, tools } = this.props.store\n    canvas.selectOff()\n    project.clear()\n    tools.selectKeyframe(undefined)\n    this.autorunDisposer()\n  }\n\n  onSetup = () => {\n    const { canvas } = this.props.store\n    canvas.build()\n    setTimeout(() => {\n      canvas.setTool(undefined)\n      canvas.setTool('SELECT')\n    }, 20)\n  }\n\n  changeHandlePosition = (handleType, { influence, distance }) => {\n    const { tools, canvas } = this.props.store\n    if (!tools.selectedKeyframe) return\n\n    const handleSuffix = titleCase(handleType)\n    const [kItem, kProp, kIndexStr] = tools.selectedKeyframe.split('.')\n    let kIndex = parseInt(kIndexStr)\n    if (handleType === 'IN') {\n      kIndex += 1\n    }\n\n    const targetHandle = canvas.animatables[kItem].keyframes[kProp][kIndex][`handle${handleSuffix}`]\n    let auxilaryHandle\n    if (kProp === 'x') {\n      auxilaryHandle = canvas.animatables[kItem].keyframes.y[kIndex][`handle${handleSuffix}`]\n    }\n\n    targetHandle.influence += influence\n    targetHandle.distance += distance\n\n    if (auxilaryHandle) {\n      auxilaryHandle.influence += influence\n      auxilaryHandle.distance += distance\n    }\n  }\n\n  render() {\n    const { canvas, animation, tools } = this.props.store\n    const { heWidth, keSize } = this.state\n\n    let keyframeBefore\n    let keyframeAfter\n    if (tools.selectedKeyframe) {\n      const [kItem, kProp, kIndexStr] = tools.selectedKeyframe.split('.')\n      const kIndex = parseInt(kIndexStr)\n      const keyframesOfType = canvas.animatables[kItem].keyframes[kProp]\n      keyframeBefore = keyframesOfType[kIndex]\n      if (kIndex + 1 < keyframesOfType.length) {\n        keyframeAfter = keyframesOfType[kIndex + 1]\n      }\n    }\n\n    return (\n      <Grid\n        gridTemplateRows=\"auto 340px\"\n        gridTemplateColumns=\"auto 400px\"\n      >\n        <GridItem id=\"view-container\" padding=\"10px\" gridArea=\"1 / 1 / 1 / 2\">\n          <Viewer canvas={canvas} animation={animation} onSetup={this.onSetup} />\n        </GridItem>\n        <GridItem id=\"handle-container\" gridArea=\"1 / 2 / 1 / 3\" backgroundColor=\"rgb(210, 210, 210)\">\n          <HandleEditor\n            width={heWidth}\n            keyframeKey={tools.selectedKeyframe}\n            keyframeBefore={keyframeBefore}\n            keyframeAfter={keyframeAfter}\n            onMove={this.changeHandlePosition}\n          />\n        </GridItem>\n        <GridItem id=\"keyframe-container\" gridArea=\"2 / 1 / 2 / 3\" backgroundColor=\"rgb(180, 180, 180)\">\n          <KeyframeEditor\n            size={keSize}\n            item={canvas.selected}\n            keyframeKey={tools.selectedKeyframe}\n            keyframe={keyframeBefore}\n            onSelect={tools.selectKeyframe}\n            frames={animation.frames}\n            now={animation.now}\n          />\n        </GridItem>\n      </Grid>\n    )\n  }\n}\n\nexport default AnimateMode\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\n\n@observer\nclass PlayController extends Component {\n  componentDidMount() {\n    document.addEventListener('keydown', this.handleKeyDown, false)\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeyDown, false)\n  }\n\n  handleKeyDown = (event) => {\n    const {\n      play,\n      pause,\n      goToNext,\n      goToPrev,\n      goToFirst,\n      goToLast,\n      playing,\n    } = this.props.animation\n    const { key, shiftKey } = event\n\n    if (key === 'ArrowLeft' && shiftKey) {\n      goToFirst()\n    } else if (key === 'ArrowLeft') {\n      goToPrev()\n    } else if (key === 'ArrowRight' && shiftKey) {\n      goToLast()\n    } else if (key === 'ArrowRight') {\n      goToNext()\n    } else if (key === ' ') {\n      event.stopPropagation()\n      event.preventDefault()\n      if (playing === true) {\n        pause()\n      } else {\n        play()\n      }\n    }\n  }\n\n  render() {\n    const {\n      play,\n      pause,\n      goToNext,\n      goToPrev,\n      goToFirst,\n      goToLast,\n      playing,\n    } = this.props.animation\n\n    return (\n      <Grid gridTemplateColumns=\"30% 1fr 1fr 1fr 1fr 1fr 30%\" height=\"60px\" alignItems=\"center\" justifyItems=\"center\" borderTop=\"1px solid rgb(230, 230, 230)\">\n        <GridItem gridColumnStart=\"2\">\n          <button type=\"button\" style={{ margin: 0 }} onClick={goToFirst}>&#8676;</button>\n        </GridItem>\n        <GridItem gridColumnStart=\"3\">\n          <button type=\"button\" style={{ margin: 0 }} onClick={goToPrev}>&#9667;</button>\n        </GridItem>\n        <GridItem gridColumnStart=\"4\">\n          { playing === false ?\n            <button type=\"button\" style={{ margin: 0 }} onClick={play}>&#9658;</button> :\n            <button type=\"button\" style={{ margin: 0 }} onClick={pause}>&#10073; &#10073;</button>\n          }\n        </GridItem>\n        <GridItem gridColumnStart=\"5\">\n          <button type=\"button\" style={{ margin: 0 }} onClick={goToNext}>\n            <div style={{ transform: 'rotate(180deg)' }}>&#9667;</div>\n          </button>\n        </GridItem>\n        <GridItem gridColumnStart=\"6\">\n          <button type=\"button\" style={{ margin: 0 }} onClick={goToLast}>&#8677;</button>\n        </GridItem>\n      </Grid>\n    )\n  }\n}\n\nexport default PlayController\n","import React from 'react'\n\nconst getWidth = () => (\n  window.innerWidth\n    || document.documentElement.clientWidth\n    || document.body.clientWidth\n)\n\nconst getHeight = () => (\n  window.innerHeight\n    || document.documentElement.clientHeight\n    || document.body.clientHeight\n)\n\nconst withWindowSize = Component => (\n  class extends React.Component {\n    state = {\n      width: getWidth(),\n      height: getHeight(),\n    }\n\n    componentDidMount() {\n      window.addEventListener('resize', this.updateDimensions)\n    }\n\n    componentWillUnmount() {\n      window.removeEventListener('resize', this.updateDimensions)\n    }\n\n    updateDimensions = () => {\n      const width = getWidth()\n      const height = getHeight()\n      this.setState({ width, height })\n    }\n\n    render() {\n      const { width, height } = this.state\n      return <Component width={width} height={height} {...this.props} />\n    }\n  }\n)\n\nexport default withWindowSize\nexport {\n  getWidth,\n  getHeight,\n}\n","import React, { Component } from 'react'\nimport { observer } from 'mobx-react'\n\nimport Viewer from './Viewer'\nimport PlayController from './PlayController'\nimport Grid from '../components/Grid'\nimport GridItem from '../components/GridItem'\nimport { getWidth } from '../components/withWindowSize'\n\n@observer\nclass ViewMode extends Component {\n  componentDidMount() {\n    const { canvas } = this.props.store\n    const width = getWidth() - 20\n    const height = Math.round((9 / 16) * width)\n    canvas.setSize(width, height)\n  }\n\n  componentWillUnmount() {\n    const { project } = this.props.store\n    project.clear()\n  }\n\n  onSetup = () => {\n    const { canvas } = this.props.store\n    canvas.build()\n  }\n\n  render() {\n    const { canvas, animation } = this.props.store\n    return (\n      <Grid\n        gridTemplateRows=\"auto 60px\"\n        alignItems=\"center\"\n      >\n        <GridItem padding=\"10px\">\n          <Viewer canvas={canvas} animation={animation} onSetup={this.onSetup} />\n        </GridItem>\n        <PlayController animation={animation} />\n      </Grid>\n    )\n  }\n}\n\nexport default ViewMode\n","var map = {\n\t\"./bare.min.css\": \"v4a6\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"zGb5\";"],"sourceRoot":""}